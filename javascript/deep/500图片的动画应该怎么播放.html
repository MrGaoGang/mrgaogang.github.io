<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>高先生的博客</title>
    <meta name="description" content="旨在分享对技术的了解">
    <link rel="icon" href="/icons/icon.png">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?9cfd884fe46fc31072811d47a486a552";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    
    <link rel="preload" href="/assets/css/0.styles.254c9e3f.css" as="style"><link rel="preload" href="/assets/js/app.debbd07d.js" as="script"><link rel="preload" href="/assets/js/6.76c5b44c.js" as="script"><link rel="preload" href="/assets/js/3.3c5aab3c.js" as="script"><link rel="preload" href="/assets/js/15.5142b34e.js" as="script"><link rel="prefetch" href="/assets/js/1.1cb886f8.js"><link rel="prefetch" href="/assets/js/10.85dac082.js"><link rel="prefetch" href="/assets/js/100.ae83ac0e.js"><link rel="prefetch" href="/assets/js/101.c83323bb.js"><link rel="prefetch" href="/assets/js/102.edd82140.js"><link rel="prefetch" href="/assets/js/103.873e8e22.js"><link rel="prefetch" href="/assets/js/104.b1201589.js"><link rel="prefetch" href="/assets/js/105.927213bb.js"><link rel="prefetch" href="/assets/js/106.172a250c.js"><link rel="prefetch" href="/assets/js/107.87f0c953.js"><link rel="prefetch" href="/assets/js/108.dc3015e6.js"><link rel="prefetch" href="/assets/js/109.6ee2926d.js"><link rel="prefetch" href="/assets/js/11.2d46d090.js"><link rel="prefetch" href="/assets/js/110.4e6ca15a.js"><link rel="prefetch" href="/assets/js/111.a70eca0f.js"><link rel="prefetch" href="/assets/js/112.810fdc3d.js"><link rel="prefetch" href="/assets/js/113.a8370a68.js"><link rel="prefetch" href="/assets/js/114.7b21cd5b.js"><link rel="prefetch" href="/assets/js/115.8884b726.js"><link rel="prefetch" href="/assets/js/116.1c9fab10.js"><link rel="prefetch" href="/assets/js/117.111a01e7.js"><link rel="prefetch" href="/assets/js/118.5d0bc31b.js"><link rel="prefetch" href="/assets/js/119.50cf2648.js"><link rel="prefetch" href="/assets/js/12.de6177e9.js"><link rel="prefetch" href="/assets/js/120.c7d640b4.js"><link rel="prefetch" href="/assets/js/121.5ca88db2.js"><link rel="prefetch" href="/assets/js/122.6b927b98.js"><link rel="prefetch" href="/assets/js/123.0af01769.js"><link rel="prefetch" href="/assets/js/124.bccde4dc.js"><link rel="prefetch" href="/assets/js/125.f28690ea.js"><link rel="prefetch" href="/assets/js/126.006aa3b7.js"><link rel="prefetch" href="/assets/js/127.269d9f10.js"><link rel="prefetch" href="/assets/js/128.1350a739.js"><link rel="prefetch" href="/assets/js/129.7aade9e6.js"><link rel="prefetch" href="/assets/js/13.5d674b4b.js"><link rel="prefetch" href="/assets/js/130.bcca3a16.js"><link rel="prefetch" href="/assets/js/131.5085943b.js"><link rel="prefetch" href="/assets/js/132.96e119aa.js"><link rel="prefetch" href="/assets/js/133.0a699978.js"><link rel="prefetch" href="/assets/js/134.60eee026.js"><link rel="prefetch" href="/assets/js/135.138f60ef.js"><link rel="prefetch" href="/assets/js/136.175ec891.js"><link rel="prefetch" href="/assets/js/137.acd6637b.js"><link rel="prefetch" href="/assets/js/138.a99a2d36.js"><link rel="prefetch" href="/assets/js/139.c4dcd5bb.js"><link rel="prefetch" href="/assets/js/14.6f58b806.js"><link rel="prefetch" href="/assets/js/140.f9394c06.js"><link rel="prefetch" href="/assets/js/141.f74117a5.js"><link rel="prefetch" href="/assets/js/142.c86e2d8e.js"><link rel="prefetch" href="/assets/js/143.b4688d28.js"><link rel="prefetch" href="/assets/js/144.8ec091fb.js"><link rel="prefetch" href="/assets/js/145.c40071b1.js"><link rel="prefetch" href="/assets/js/146.023ecd85.js"><link rel="prefetch" href="/assets/js/147.d2810ad2.js"><link rel="prefetch" href="/assets/js/148.3a415e3f.js"><link rel="prefetch" href="/assets/js/149.9865b5d5.js"><link rel="prefetch" href="/assets/js/150.3bdee4bf.js"><link rel="prefetch" href="/assets/js/151.f65c6a6e.js"><link rel="prefetch" href="/assets/js/152.a41f7f50.js"><link rel="prefetch" href="/assets/js/153.5d63f2de.js"><link rel="prefetch" href="/assets/js/154.0435ec54.js"><link rel="prefetch" href="/assets/js/155.7bd31a07.js"><link rel="prefetch" href="/assets/js/156.9a29cb9c.js"><link rel="prefetch" href="/assets/js/157.6e5f105a.js"><link rel="prefetch" href="/assets/js/158.f06fcac9.js"><link rel="prefetch" href="/assets/js/159.70a5cc6b.js"><link rel="prefetch" href="/assets/js/16.dfccb553.js"><link rel="prefetch" href="/assets/js/160.18f99424.js"><link rel="prefetch" href="/assets/js/161.1652870f.js"><link rel="prefetch" href="/assets/js/162.7d96e67a.js"><link rel="prefetch" href="/assets/js/163.bb77c04c.js"><link rel="prefetch" href="/assets/js/164.66a498c3.js"><link rel="prefetch" href="/assets/js/165.ad5ffa1e.js"><link rel="prefetch" href="/assets/js/166.035d5d51.js"><link rel="prefetch" href="/assets/js/167.eb0ef48a.js"><link rel="prefetch" href="/assets/js/168.39d11f92.js"><link rel="prefetch" href="/assets/js/169.82a16d3b.js"><link rel="prefetch" href="/assets/js/17.bc5395a4.js"><link rel="prefetch" href="/assets/js/170.87c62090.js"><link rel="prefetch" href="/assets/js/171.5365d2e2.js"><link rel="prefetch" href="/assets/js/172.480235ec.js"><link rel="prefetch" href="/assets/js/173.862441e7.js"><link rel="prefetch" href="/assets/js/174.dab904b0.js"><link rel="prefetch" href="/assets/js/175.a960b6d3.js"><link rel="prefetch" href="/assets/js/176.630dca76.js"><link rel="prefetch" href="/assets/js/177.c97f608f.js"><link rel="prefetch" href="/assets/js/178.8eb8dd84.js"><link rel="prefetch" href="/assets/js/179.e63a9245.js"><link rel="prefetch" href="/assets/js/18.f964bf4f.js"><link rel="prefetch" href="/assets/js/180.2b915eac.js"><link rel="prefetch" href="/assets/js/181.05869c59.js"><link rel="prefetch" href="/assets/js/182.5190db03.js"><link rel="prefetch" href="/assets/js/183.e415f799.js"><link rel="prefetch" href="/assets/js/184.0b9c3388.js"><link rel="prefetch" href="/assets/js/185.9e716abc.js"><link rel="prefetch" href="/assets/js/186.eedfa636.js"><link rel="prefetch" href="/assets/js/187.6524db07.js"><link rel="prefetch" href="/assets/js/188.73bebdd0.js"><link rel="prefetch" href="/assets/js/189.b2b04b6f.js"><link rel="prefetch" href="/assets/js/19.3ec09a7a.js"><link rel="prefetch" href="/assets/js/2.82f2edc6.js"><link rel="prefetch" href="/assets/js/20.0b752d07.js"><link rel="prefetch" href="/assets/js/21.6f2f5f53.js"><link rel="prefetch" href="/assets/js/22.d0506713.js"><link rel="prefetch" href="/assets/js/23.d3d5d257.js"><link rel="prefetch" href="/assets/js/24.e47e19b1.js"><link rel="prefetch" href="/assets/js/25.ac716246.js"><link rel="prefetch" href="/assets/js/26.744dd23d.js"><link rel="prefetch" href="/assets/js/27.c97db5d0.js"><link rel="prefetch" href="/assets/js/28.d3c6b2b3.js"><link rel="prefetch" href="/assets/js/29.dca3cc6d.js"><link rel="prefetch" href="/assets/js/30.ed08e0d7.js"><link rel="prefetch" href="/assets/js/31.6ed9c458.js"><link rel="prefetch" href="/assets/js/32.ad1fdfc7.js"><link rel="prefetch" href="/assets/js/33.ab9950b7.js"><link rel="prefetch" href="/assets/js/34.6a52a047.js"><link rel="prefetch" href="/assets/js/35.241da2f7.js"><link rel="prefetch" href="/assets/js/36.6f17f62d.js"><link rel="prefetch" href="/assets/js/37.7d65c419.js"><link rel="prefetch" href="/assets/js/38.b1016f6a.js"><link rel="prefetch" href="/assets/js/39.c85991c7.js"><link rel="prefetch" href="/assets/js/40.ed7eaec9.js"><link rel="prefetch" href="/assets/js/41.ee83df44.js"><link rel="prefetch" href="/assets/js/42.76660ea4.js"><link rel="prefetch" href="/assets/js/43.89f36f5e.js"><link rel="prefetch" href="/assets/js/44.14d5c86b.js"><link rel="prefetch" href="/assets/js/45.0077e9b8.js"><link rel="prefetch" href="/assets/js/46.7f082523.js"><link rel="prefetch" href="/assets/js/47.b7d575ff.js"><link rel="prefetch" href="/assets/js/48.ddfb4247.js"><link rel="prefetch" href="/assets/js/49.ea59639a.js"><link rel="prefetch" href="/assets/js/5.dd2e60a2.js"><link rel="prefetch" href="/assets/js/50.1c01bac1.js"><link rel="prefetch" href="/assets/js/51.8b64b1f2.js"><link rel="prefetch" href="/assets/js/52.18a7fb72.js"><link rel="prefetch" href="/assets/js/53.1686a6a5.js"><link rel="prefetch" href="/assets/js/54.c61f443b.js"><link rel="prefetch" href="/assets/js/55.6ad20a4b.js"><link rel="prefetch" href="/assets/js/56.7e81f66e.js"><link rel="prefetch" href="/assets/js/57.495cefda.js"><link rel="prefetch" href="/assets/js/58.48e87cd3.js"><link rel="prefetch" href="/assets/js/59.a3a592b3.js"><link rel="prefetch" href="/assets/js/60.ebb3ad5c.js"><link rel="prefetch" href="/assets/js/61.1c50eb05.js"><link rel="prefetch" href="/assets/js/62.419dff5c.js"><link rel="prefetch" href="/assets/js/63.e5b8be7c.js"><link rel="prefetch" href="/assets/js/64.ae7a6773.js"><link rel="prefetch" href="/assets/js/65.f24af92f.js"><link rel="prefetch" href="/assets/js/66.b5d59fa2.js"><link rel="prefetch" href="/assets/js/67.6536a20d.js"><link rel="prefetch" href="/assets/js/68.8545a5b2.js"><link rel="prefetch" href="/assets/js/69.774aa35b.js"><link rel="prefetch" href="/assets/js/7.9e93aaca.js"><link rel="prefetch" href="/assets/js/70.89e34d2d.js"><link rel="prefetch" href="/assets/js/71.f0cfef4a.js"><link rel="prefetch" href="/assets/js/72.c6bc0845.js"><link rel="prefetch" href="/assets/js/73.1d404d37.js"><link rel="prefetch" href="/assets/js/74.e20d9ac7.js"><link rel="prefetch" href="/assets/js/75.11d9f5c0.js"><link rel="prefetch" href="/assets/js/76.53d56bbe.js"><link rel="prefetch" href="/assets/js/77.b6d93d63.js"><link rel="prefetch" href="/assets/js/78.69a1f894.js"><link rel="prefetch" href="/assets/js/79.64feb262.js"><link rel="prefetch" href="/assets/js/8.b0fd1b2b.js"><link rel="prefetch" href="/assets/js/80.a1a5e803.js"><link rel="prefetch" href="/assets/js/81.97f54aa4.js"><link rel="prefetch" href="/assets/js/82.8fd36f77.js"><link rel="prefetch" href="/assets/js/83.1d2c63c4.js"><link rel="prefetch" href="/assets/js/84.875ba1db.js"><link rel="prefetch" href="/assets/js/85.57bdcef5.js"><link rel="prefetch" href="/assets/js/86.441df7b7.js"><link rel="prefetch" href="/assets/js/87.1b8c5a3b.js"><link rel="prefetch" href="/assets/js/88.a9ae9025.js"><link rel="prefetch" href="/assets/js/89.fa1b7dd5.js"><link rel="prefetch" href="/assets/js/9.69db9d44.js"><link rel="prefetch" href="/assets/js/90.8c7ba602.js"><link rel="prefetch" href="/assets/js/91.73570f16.js"><link rel="prefetch" href="/assets/js/92.9fa42c75.js"><link rel="prefetch" href="/assets/js/93.42481a5d.js"><link rel="prefetch" href="/assets/js/94.f78127a5.js"><link rel="prefetch" href="/assets/js/95.abe6dfda.js"><link rel="prefetch" href="/assets/js/96.37358a0e.js"><link rel="prefetch" href="/assets/js/97.2a4b3f0a.js"><link rel="prefetch" href="/assets/js/98.d2d2ec49.js"><link rel="prefetch" href="/assets/js/99.6553e09e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.254c9e3f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/header.png" alt="高先生的博客" class="logo"> <span class="site-name can-hide">高先生的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="https://mrgaogang.github.io/parse-jsx-to-css-plugins/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue/React to CSS/Less/Sass
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://gaogangsever.cn/ui-builder-root/index.html#" target="_blank" rel="noopener noreferrer" class="nav-link external">
  页面构建器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/javascript/index.html" class="nav-link">前端</a></div><div class="nav-item"><a href="/vue/index.html" class="nav-link">Vue</a></div><div class="nav-item"><a href="/react/index.html" class="nav-link">React/RN</a></div><div class="nav-item"><a href="/ai/index.html" class="nav-link">AI/Node</a></div><div class="nav-item"><a href="/android/index.html" class="nav-link">Android</a></div><div class="nav-item"><a href="/ios/index.html" class="nav-link">iOS</a></div><div class="nav-item"><a href="/other/index.html" class="nav-link">杂谈</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">低代码Mendix</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mendix/index.html" class="nav-link">1. Mendix介绍</a></li><li class="dropdown-item"><!----> <a href="/mendix/widgets/index.html" class="nav-link">2. 组件开发</a></li><li class="dropdown-item"><!----> <a href="/mendix/study.html" class="nav-link">3. Mendix学习</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">开源</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/article/oview/index.html" class="nav-link">图表库oView</a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/luckly_recyclerview" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lucky_recyclerview
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/luckly_popup_window" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lucky_popup_window
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/lucky_tools/blob/master/packages/mendix-cli/README.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue开发Mendix组件脚手架
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/cocos-webpack-web" target="_blank" rel="noopener noreferrer" class="nav-link external">
  cocos web端开发
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/ui-designer" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ui 构建器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/KotlinGank" target="_blank" rel="noopener noreferrer" class="nav-link external">
  kotlin App
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/tensorflow_object_detection" target="_blank" rel="noopener noreferrer" class="nav-link external">
  tensorflow object detection
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/react-native-file-hash-plugin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react-native-file-hash-plugin
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/parse-jsx-to-css" target="_blank" rel="noopener noreferrer" class="nav-link external">
  parse-jsx-to-css
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/MrGaoGang/mrgaogang.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="https://mrgaogang.github.io/parse-jsx-to-css-plugins/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue/React to CSS/Less/Sass
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://gaogangsever.cn/ui-builder-root/index.html#" target="_blank" rel="noopener noreferrer" class="nav-link external">
  页面构建器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/javascript/index.html" class="nav-link">前端</a></div><div class="nav-item"><a href="/vue/index.html" class="nav-link">Vue</a></div><div class="nav-item"><a href="/react/index.html" class="nav-link">React/RN</a></div><div class="nav-item"><a href="/ai/index.html" class="nav-link">AI/Node</a></div><div class="nav-item"><a href="/android/index.html" class="nav-link">Android</a></div><div class="nav-item"><a href="/ios/index.html" class="nav-link">iOS</a></div><div class="nav-item"><a href="/other/index.html" class="nav-link">杂谈</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">低代码Mendix</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mendix/index.html" class="nav-link">1. Mendix介绍</a></li><li class="dropdown-item"><!----> <a href="/mendix/widgets/index.html" class="nav-link">2. 组件开发</a></li><li class="dropdown-item"><!----> <a href="/mendix/study.html" class="nav-link">3. Mendix学习</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">开源</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/article/oview/index.html" class="nav-link">图表库oView</a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/luckly_recyclerview" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lucky_recyclerview
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/luckly_popup_window" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lucky_popup_window
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/lucky_tools/blob/master/packages/mendix-cli/README.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue开发Mendix组件脚手架
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/cocos-webpack-web" target="_blank" rel="noopener noreferrer" class="nav-link external">
  cocos web端开发
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/ui-designer" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ui 构建器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/KotlinGank" target="_blank" rel="noopener noreferrer" class="nav-link external">
  kotlin App
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/tensorflow_object_detection" target="_blank" rel="noopener noreferrer" class="nav-link external">
  tensorflow object detection
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/react-native-file-hash-plugin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react-native-file-hash-plugin
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/parse-jsx-to-css" target="_blank" rel="noopener noreferrer" class="nav-link external">
  parse-jsx-to-css
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/MrGaoGang/mrgaogang.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/javascript/deep/500%E5%9B%BE%E7%89%87%E7%9A%84%E5%8A%A8%E7%94%BB%E5%BA%94%E8%AF%A5%E6%80%8E%E4%B9%88%E6%92%AD%E6%94%BE.html#常见的播放动画方式" class="sidebar-link">常见的播放动画方式</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/javascript/deep/500%E5%9B%BE%E7%89%87%E7%9A%84%E5%8A%A8%E7%94%BB%E5%BA%94%E8%AF%A5%E6%80%8E%E4%B9%88%E6%92%AD%E6%94%BE.html#我们的方案" class="sidebar-link">我们的方案</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/javascript/deep/500%E5%9B%BE%E7%89%87%E7%9A%84%E5%8A%A8%E7%94%BB%E5%BA%94%E8%AF%A5%E6%80%8E%E4%B9%88%E6%92%AD%E6%94%BE.html#动画播放思路" class="sidebar-link">动画播放思路</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/javascript/deep/500%E5%9B%BE%E7%89%87%E7%9A%84%E5%8A%A8%E7%94%BB%E5%BA%94%E8%AF%A5%E6%80%8E%E4%B9%88%E6%92%AD%E6%94%BE.html#_1、获取-apng-图片" class="sidebar-link">1、获取 apng 图片</a></li><li class="sidebar-sub-header"><a href="/javascript/deep/500%E5%9B%BE%E7%89%87%E7%9A%84%E5%8A%A8%E7%94%BB%E5%BA%94%E8%AF%A5%E6%80%8E%E4%B9%88%E6%92%AD%E6%94%BE.html#_2、-apng-帧的解析" class="sidebar-link">2、 apng 帧的解析</a></li><li class="sidebar-sub-header"><a href="/javascript/deep/500%E5%9B%BE%E7%89%87%E7%9A%84%E5%8A%A8%E7%94%BB%E5%BA%94%E8%AF%A5%E6%80%8E%E4%B9%88%E6%92%AD%E6%94%BE.html#_3、使用-canvas-requestanimationframe-播放动画" class="sidebar-link">3、使用 canvas+requestAnimationFrame 播放动画</a></li></ul></li><li><a href="/javascript/deep/500%E5%9B%BE%E7%89%87%E7%9A%84%E5%8A%A8%E7%94%BB%E5%BA%94%E8%AF%A5%E6%80%8E%E4%B9%88%E6%92%AD%E6%94%BE.html#参考" class="sidebar-link">参考</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="ads-main"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAG4UlEQVR4Xu2Zf4xdRRXHv+eu7f5hEyD6h9qVBFMSgrEJIkINAilogymRSHe3QcAU/aub3Tv3vUgDhF+iRIXunHvrGtPYajTR2IJSm1J+tAFaS0GpQLCGKiENKRBCCIEQ2mjuHHLIfbp9fXfu3PcewrpvkmaT3jPnx2fOnDkzjzDPB83z+DEAMMiAeU5gsAXmeQIMiuBgCwy2wDwnMNgCdRMgjuNRIvoIM/+27twPo3ytDCiC31IE8m1m3hwS1OTk5HAURZdHUXSOiHwKwCcBtP6qilcAvKx/iejlPM+fzPP8oZmZmddD9PciEwygLfiWzTXM/MtODkxMTHxswYIFlxHRShG5DMDCuo6KyP1E9DCAXcz817rzQ+SDAJQE/55+EVmVpuk9LWPr1q076dixYxNEtBbA4hAnAmRyAD9xzs1kWfbPAPlgkSAASZJsEZHRMq1EtOLIkSO7R0ZGGiJyPYBTgj2oJ/iGiMwcPXr0ro0bN75Zb2pn6SAAOjWO47uJ6AqPUV2loQCndK8/KiIHiOiA1oOiLiyJomipiCwFsKhCj867iZl3BtjzigQDUC3GGE31b3Rp9DYAjzDzI775k5OTI0NDQzERTYmIt24Q0fettTd16c9702oBKCD8AcDlNYxqwLdVBd6uzxjzeSKaEZHzKmxtY+Y6/hynrjaAAsK9AL5eBYGItlprx6rkfN+NMZsAXFuhYw8zX9iNna4AFBD+CECPt46jH8G3FBtjbgVwS0WAe5n5groQugaghpIk2S4iK8uMishYmqZb6zrVSd4Y8ysAV/t0iYhN07RRx15PANRQHMc7iOhrdSBoXxFF0WhxtGpFfwbAfmb+eZkeY8xFALQpqhpabzRjgkbPAIrtcB+AS6sgxHG8lIjuBPDVTrJEtNtae4kHggJQEFUjuE0PAtBsNs/M8/xMZr7b49z9AFb4IBDRDwF8psL7w8x8Wsk2MABsVfQAXhKRi9M0PVQlGwTAGKMp+jkAq5j59x4ID5StbpUjbd/XMfOP2+cUC3EwUNcWZh6vkq0EYIy5DsCPCkW5doPW2m0eCA8C+EqV4arvzrlLsizb3S5njPkbgM9WzdfvIhKnaZr5ZL0A1q5du2jhwoXPzb7UENG/NBOstdvLFCdJsktTMMTJMhki+qa19jcdAITWAZ36PDOf3jWAsspLRMf0FsjMOzyZoKu3vAcICTNzjwB0+lnM/HQpaJ+DzWbz43mev1Yi805RE0ovJMaYOqvVbqYMwGMAloWCJaLTrbXPdwVAJyVJ8gMRuaFEwdvFe4AWv47DGKN3gW7a1I4rF8fxC0TU8ZRod0BEHk7T1JuFlUVQ68Dw8PAeETmrJMa3CggPeSDsAfDl0FUDcIiZz+gkb4x5G8BHA3T92zm3PMuyP3VdA1oTfS9Chcwb2tlNT0+fULVbOowxewGcH+C4Vu+OLbQxRlthbYkrBxFdb63VvsM7KjNgFoTNRLTGo+31AkJpuxrH8T4i+pLPI9/9wRgT2mfsYObSO8ps+8EAkiRZ4pzbS0Sf8ASgBXPMd/c3xlQVsSs7Pbk3Go0rnHOlnegsn/SpbHnoI2owADVgjJkE4G0sALxarKLu+7LC+DiAcz0gT+jljTGhdeQaZv51Veq3vtcCUEDQ6+b6CgOvOOfGfAXIGPMEgC969Ewx84bCZsh7AIioYa0NuSv8x2xtADozSZI1IlL1o8gR59x4lmWa8mWZ8BcAX/BA0ON3OOAxRIO/w1p7Y+jKd50BrYnGGH0c1YrsO5JejKJofHp6WlO+DMKTAM6u6/hxhYxok7X2O93o6CoDWoampqYujqJIfxka8Rg/TETj1to/eyDot3O6CUBE7kjTtPbK95wBLQXNZvPsPM9/VpHK2r0pBF3tjiNJkv0BL8D/3btEW/M8/16WZXo77Hr0lAGzrcZxfBURfQtA2YuO9uPjvuMpSZJ9IuLtEwBoJ6hHbc8/iqj/fQPQghHH8coCxKoOy/KPPM9Xb9iw4SnPdvB2jCKyOk3T33W95G0T+w5gVn04P4oizQh9/zu19f8i8pxzTiHoK1NZYXwUQOkTt3Pu2izLftEPCO8bgNnO6VOWc26Z/iOi84hI7a621j7rgeC9ShPRhLX2p71C+J8A6ORkAYWstaVvfAHvCd9l5rt6gfCBAQh1OgDCzcx8e6i+drkPPQB12APh4NDQ0Nj69ev//n8NYHR0dGjx4sW72n4U6Tn49+UY7HYlquYZY04mop1Fs9SX4OcUAHW20Wh82jm3s9e0nw17TtSA9iO1lz0/J4tg1fbo5fucy4Begu00dwCg30Tnmr5BBsy1Feu3v4MM6DfRuaZvkAFzbcX67e+8z4B3AU7+oV/ZJX7ZAAAAAElFTkSuQmCC" class="btn-control"> <img src="https://camo.githubusercontent.com/01448f33e0bc34a83317f39bb3a1df723e109d4194e0259b7345775fe99968d5/68747470733a2f2f70312d6a75656a696e2e62797465696d672e636f6d2f746f732d636e2d692d6b3375316662706663702f33306666633738643332313434323632623536633633653230323261656163307e74706c762d6b3375316662706663702d7a6f6f6d2d312e696d616765" class="my-wechat-m" style="display:;"> <div class="item-ads" style="display:;"><div class="ads-name">耗时4天写的日程小程序</div> <img src="/assets/img/mini-app.9d4e9bb7.png" class="item-ads-url item-ads-url-full"></div><div class="item-ads" style="display:;"><div class="ads-name">华为云各类服务内部优惠</div> <img src="/assets/img/huawei.1ebdc4d9.png" class="item-ads-url"></div></div> <div class="theme-default-content content__default"><p>在 Now 直播新版抽奖内，用户进房之后可以点击任意一个地方(金木水土日月雷)进行抽奖。如下图所示:</p> <img src="/assets/img/demo.c1219401.gif" width="200px"> <p>动画的播放分为两个部分: 闪电的播放以及奖品部分的播放。</p> <p>闪电部分动画大约有 25 帧，而奖品部分由于动画华为复杂大约有 500 帧左右。对于帧数如此多的场景使用什么样的方式播放动画是需要我们进行探讨的问题。</p> <h2 id="常见的播放动画方式"><a href="#常见的播放动画方式" aria-hidden="true" class="header-anchor">#</a> 常见的播放动画方式</h2> <p>做过动画的同学应该都清楚，常见的播放动画的方式有</p> <ul><li><p><strong><code>css</code> 的 <code>animation</code>或者<code>transition</code></strong>;</p> <ul><li>优点: 使用比较简单</li> <li>缺点: 对于 500+帧的情况，动画播放需要依赖于图片是否下载成功，500+图片的下载，势必会导致动画卡顿</li></ul></li> <li><p><strong>使用精灵图+<code>background-position+@keframes</code>播放动画;</strong></p> <ul><li>优点: 将多个图片组合成一张，会减少 http 请求数量</li> <li>缺点:
<ol><li>要求每帧的大小必须一致，需要精确控制位置</li> <li>动画的控制较为复杂</li> <li>维护起来比较麻烦，如果要新加帧/删除帧涉及到代码的改动</li></ol></li></ul></li> <li><p><strong>使用 <code>gif</code> 播放动图</strong></p> <ul><li>优点: 使用简单，只需要设计同学给一张图片即可</li> <li>缺点:
<ol><li>gif 只支持 256 色调色板，因此，详细的图片和写实摄影图像会丢失颜色信息，而看起来却是经过调色的</li> <li>gif 支持有限的透明度，没有半透明效果或褪色效果</li> <li>gif 经过压缩之后播放动画没有那么流畅</li> <li>边缘有杂边</li></ol></li></ul></li> <li><p><strong>使用 <code>video</code> 标签以视频的方式播放动画</strong></p> <ul><li>优点: 使用简单，利用自带的 video 标签及 api 即可控制动画的播放，暂停等</li> <li>缺点:
<ol><li>移动端兼容性不太好，特别是 android 下，可能被各个系统拦截，然后自己去实现了播放器插件会存在兼容性问题；</li> <li>需要处理 video 自动播放、影藏控制条等兼容问题</li></ol></li></ul></li> <li><p><strong>使用 lottie-web 播放动画</strong></p> <ul><li>优点:</li></ul> <ol><li>使用 lottie 方案，json 文件大小会比 gif 文件小很多，性能也会更好;</li> <li>前端可以方便的调用动画，并对动画进行控制，减少前端动画工作量</li></ol> <ul><li>缺点</li></ul> <ol><li>lottie-web 文件本身仍然比较大，lottie.js 大小为 513k，轻量版压缩后也有 144k，经过 gzip 后，大小为 39k。</li> <li>有很少量的 AE 动画效果，lottie 无法实现，有些是因为性能问题，有些是没有做。比如：描边动画等;</li> <li>需要设计师在 AE 中导出 json 内容,动画比较复杂情况 json 比较大</li></ol></li> <li><p><strong>使用 <code>apng</code> 播放动图</strong></p> <ul><li>优点:</li></ul> <ol><li>相比 gif 可以容纳更多的色彩;且向下兼容 png 格式图片;</li> <li>支持 alpha 透明通道</li> <li>图片体积相比 gif 更小</li></ol> <ul><li>缺点</li></ul> <ol><li>兼容性问题较差
<img src="/assets/img/apng.59119ad9.png" width="300px"></li></ol></li> <li><p><strong><code>javascript</code> 利用搭配 requestAnimationFrame+canvas 绘制动画</strong></p> <ul><li>优点: 可以自己控制动画的播放;</li> <li>缺点: 需要找到一个合适的搭档，进行逐帧播放</li></ul></li></ul> <p>为了更加直观的感受到 gif/apng 的区别，有兴趣的同学可以<a href="http://littlesvr.ca/apng/gif_apng_webp3.html" target="_blank" rel="noopener noreferrer">点击这里查看效果对比<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><img src="/assets/img/apng-gif-webp.1d370f63.png" alt=""></p> <h2 id="我们的方案"><a href="#我们的方案" aria-hidden="true" class="header-anchor">#</a> 我们的方案</h2> <p>首先我们需要否决逐帧单张加载的方法, 这样会导致一共需要加载 500+张图片, 这显然不合理;</p> <p>使用 gif 播放有杂边且色彩支持比较少;所以暂时否决;</p> <p>引入<code>lottie-web</code>会导致工程体积变大，且未来如果动画要更换，如果设计到 lottie 不支持的动画则动画会播放失败; 导出的 json 也比较大。</p> <p>因此备选的方案有利用 APNG 或者 sprite 图片来解决问题. 为了方便后续的维护以及代码逻辑的简洁性, <strong>项目中选取了 APNG 来解决动画帧的问题</strong>.</p> <p>但需要注意的是, 出于兼容性和可控性的考虑, 项目<strong>并没有采用直接播放 apng 图片的方式</strong>.</p> <p>所以我们最终的方案为: <strong>apng+requestAnimationFrame+canvas</strong></p> <p>使用此方案的优点有:</p> <ol><li>apng 的加持，对每一帧的位置/宽高 没有 精灵图要求那么严格;</li> <li>apng 相比 gif 体积更小且支持透明通道;且支持更多的色彩;</li> <li>使用<code>requestAnimationFrame+canvas</code>的方式可以自己控制什么时候播放动画</li> <li><code>requestAnimationFrame+canvas</code>没有兼容性问题</li></ol> <h2 id="动画播放思路"><a href="#动画播放思路" aria-hidden="true" class="header-anchor">#</a> 动画播放思路</h2> <p>整个动画播放的思路为:</p> <ol><li>获取 <code>apng</code> 图片</li> <li>从 <code>apng</code> 中解析各个帧</li> <li>使用 <code>canvas+requestAnimationFrame</code> 播放动画</li></ol> <p><img src="/assets/img/apng_js.3567dccf.png" alt=""></p> <h3 id="_1、获取-apng-图片"><a href="#_1、获取-apng-图片" aria-hidden="true" class="header-anchor">#</a> 1、获取 apng 图片</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">fetchApngData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">:</span> number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span>ArrayBuffer<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response <span class="token keyword">as</span> ArrayBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  xhr<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  xhr<span class="token punctuation">.</span>responseType <span class="token operator">=</span> <span class="token string">'arraybuffer'</span><span class="token punctuation">;</span>
  xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span> apngs<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2、-apng-帧的解析"><a href="#_2、-apng-帧的解析" aria-hidden="true" class="header-anchor">#</a> 2、 apng 帧的解析</h3> <p>在解析帧之前，我们先简单了解一下 apng 及 png 的组成结构:</p> <p><img src="/assets/img/apng-st.02c80c38.png" alt=""></p> <p>其中 <code>PNG</code> 主要包括 <code>PNG Signature``、IHDR、IDAT、IEND</code> 和 一些辅助块:</p> <ul><li><code>PNG Signature</code> 是文件标示，用于校验文件格式是否为 <code>PNG</code> ；</li></ul> <blockquote><p>PNG Signature为8个字节: const PNGSignature = new Uint8Array([0x89, 0x50, 0x4e, 0x47, 0x0d, 0x0a, 0x1a, 0x0a]);</p></blockquote> <ul><li><code>IHDR</code> 是文件头数据块，包含图像基本信息，例如图像的宽高等信息；</li> <li><code>IDAT</code> 是图像数据块，存储具体的图像数据，一个 PNG 文件可能有一个或多个 IDAT 块；</li> <li><code>IEND</code> 是结束数据块，标示图像结束；辅助块位于 IHDR 之后 IEND 之前</li></ul> <p>APNG 在 PNG 的基础上增加了 acTL、fcTL 和 fdAT 3 种块:</p> <ul><li><code>acTL</code>：动画控制块，包含了图片的帧数和循环次数（ 0 表示无限循环）</li> <li><code>fcTL</code>：帧控制块，属于 PNG 规范中的辅助块，包含了当前帧的序列号、图像的宽高及水平垂直偏移量，帧播放时长和绘制方式（dispose_op 和 blend_op）等，每一帧只有一个 fcTL 块</li> <li><code>fdAT</code>：帧数据块，包含了帧的序列号和图像数据，仅比 IDAT 多了帧的序列号，每一帧可以有一个或多个 fcTL 块。fdAT 的序列号与 fcTL 共享，用于检测 APNG 的序列错误，可选择性的纠正。</li></ul> <p>所以解析的大致步骤为:</p> <p><img src="/assets/img/apng-flow.9636c582.png" alt=""></p> <p>下方代码参考自<a href="https://github.com/davidmz/apng-js" target="_blank" rel="noopener noreferrer">apng-js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">parseAPNG</span><span class="token punctuation">(</span><span class="token parameter">buffer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> bytes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 1. 校验PNGSignature，如果不是png则直接返回</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>PNGSignature<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">b<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> b <span class="token operator">!==</span> bytes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> errNotPNG<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// fast animation test</span>
    <span class="token keyword">let</span> isAnimated <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token comment">// 1. 使用acTL校验是否为apng格式，如果不是apng则直接返回</span>
    <span class="token function">eachChunk</span><span class="token punctuation">(</span>bytes<span class="token punctuation">,</span> <span class="token parameter">type</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span><span class="token punctuation">(</span>isAnimated <span class="token operator">=</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">'acTL'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isAnimated<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> errNotAPNG<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span>
        preDataParts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        postDataParts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span>
        headerDataBytes <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
        frame <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
        frameNumber <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
        apng <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">APNG</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 3. 分别处理不同类型的数据</span>
    <span class="token function">eachChunk</span><span class="token punctuation">(</span>bytes<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> bytes<span class="token punctuation">,</span> off<span class="token punctuation">,</span> length</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> dv <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataView</span><span class="token punctuation">(</span>bytes<span class="token punctuation">.</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> <span class="token string">'IHDR'</span><span class="token punctuation">:</span>
                headerDataBytes <span class="token operator">=</span> bytes<span class="token punctuation">.</span><span class="token function">subarray</span><span class="token punctuation">(</span>off <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">,</span> off <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">+</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>
                apng<span class="token punctuation">.</span>width <span class="token operator">=</span> dv<span class="token punctuation">.</span><span class="token function">getUint32</span><span class="token punctuation">(</span>off <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                apng<span class="token punctuation">.</span>height <span class="token operator">=</span> dv<span class="token punctuation">.</span><span class="token function">getUint32</span><span class="token punctuation">(</span>off <span class="token operator">+</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">'acTL'</span><span class="token punctuation">:</span> <span class="token comment">// 使用acTL可以获取到apng帧数</span>
                apng<span class="token punctuation">.</span>numPlays <span class="token operator">=</span> dv<span class="token punctuation">.</span><span class="token function">getUint32</span><span class="token punctuation">(</span>off <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">'fcTL'</span><span class="token punctuation">:</span> <span class="token comment">// 使用fcTL获取到所有的帧</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>frame<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    apng<span class="token punctuation">.</span>frames<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>frame<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    frameNumber<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                frame <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Frame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                frame<span class="token punctuation">.</span>width <span class="token operator">=</span> dv<span class="token punctuation">.</span><span class="token function">getUint32</span><span class="token punctuation">(</span>off <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                frame<span class="token punctuation">.</span>height <span class="token operator">=</span> dv<span class="token punctuation">.</span><span class="token function">getUint32</span><span class="token punctuation">(</span>off <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                frame<span class="token punctuation">.</span>left <span class="token operator">=</span> dv<span class="token punctuation">.</span><span class="token function">getUint32</span><span class="token punctuation">(</span>off <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">+</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                frame<span class="token punctuation">.</span>top <span class="token operator">=</span> dv<span class="token punctuation">.</span><span class="token function">getUint32</span><span class="token punctuation">(</span>off <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> delayN <span class="token operator">=</span> dv<span class="token punctuation">.</span><span class="token function">getUint16</span><span class="token punctuation">(</span>off <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> delayD <span class="token operator">=</span> dv<span class="token punctuation">.</span><span class="token function">getUint16</span><span class="token punctuation">(</span>off <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">+</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>delayD <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    delayD <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                frame<span class="token punctuation">.</span>delay <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">*</span> delayN <span class="token operator">/</span> delayD<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>frame<span class="token punctuation">.</span>delay <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    frame<span class="token punctuation">.</span>delay <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                apng<span class="token punctuation">.</span>playTime <span class="token operator">+=</span> frame<span class="token punctuation">.</span>delay<span class="token punctuation">;</span>
                frame<span class="token punctuation">.</span>disposeOp <span class="token operator">=</span> dv<span class="token punctuation">.</span><span class="token function">getUint8</span><span class="token punctuation">(</span>off <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">+</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                frame<span class="token punctuation">.</span>blendOp <span class="token operator">=</span> dv<span class="token punctuation">.</span><span class="token function">getUint8</span><span class="token punctuation">(</span>off <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">+</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                frame<span class="token punctuation">.</span>dataParts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>frameNumber <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> frame<span class="token punctuation">.</span>disposeOp <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    frame<span class="token punctuation">.</span>disposeOp <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">'fdAT'</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>frame<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    frame<span class="token punctuation">.</span>dataParts<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>bytes<span class="token punctuation">.</span><span class="token function">subarray</span><span class="token punctuation">(</span>off <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">,</span> off <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">+</span> length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">'IDAT'</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>frame<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    frame<span class="token punctuation">.</span>dataParts<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>bytes<span class="token punctuation">.</span><span class="token function">subarray</span><span class="token punctuation">(</span>off <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">,</span> off <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">+</span> length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">'IEND'</span><span class="token punctuation">:</span>
                postDataParts<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">subBuffer</span><span class="token punctuation">(</span>bytes<span class="token punctuation">,</span> off<span class="token punctuation">,</span> <span class="token number">12</span> <span class="token operator">+</span> length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">default</span><span class="token punctuation">:</span>
                preDataParts<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">subBuffer</span><span class="token punctuation">(</span>bytes<span class="token punctuation">,</span> off<span class="token punctuation">,</span> <span class="token number">12</span> <span class="token operator">+</span> length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>frame<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        apng<span class="token punctuation">.</span>frames<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>frame<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>apng<span class="token punctuation">.</span>frames<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> errNotAPNG<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> preBlob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span>preDataParts<span class="token punctuation">)</span><span class="token punctuation">,</span>
        postBlob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span>postDataParts<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 组装每一个frame为blob格式</span>
    apng<span class="token punctuation">.</span>frames<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">frame</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> bb <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        bb<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>PNGSignature<span class="token punctuation">)</span><span class="token punctuation">;</span>
        headerDataBytes<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token function">makeDWordArray</span><span class="token punctuation">(</span>frame<span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        headerDataBytes<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token function">makeDWordArray</span><span class="token punctuation">(</span>frame<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bb<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">makeChunkBytes</span><span class="token punctuation">(</span><span class="token string">'IHDR'</span><span class="token punctuation">,</span> headerDataBytes<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bb<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>preBlob<span class="token punctuation">)</span><span class="token punctuation">;</span>
        frame<span class="token punctuation">.</span>dataParts<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">p</span> <span class="token operator">=&gt;</span> bb<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">makeChunkBytes</span><span class="token punctuation">(</span><span class="token string">'IDAT'</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bb<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>postBlob<span class="token punctuation">)</span><span class="token punctuation">;</span>
        frame<span class="token punctuation">.</span>imageData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span>bb<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token string">'image/png'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">delete</span> frame<span class="token punctuation">.</span>dataParts<span class="token punctuation">;</span>
        bb <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> apng<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="_3、使用-canvas-requestanimationframe-播放动画"><a href="#_3、使用-canvas-requestanimationframe-播放动画" aria-hidden="true" class="header-anchor">#</a> 3、使用 <code>canvas+requestAnimationFrame</code> 播放动画</h3> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">const</span> <span class="token punctuation">[</span>frames<span class="token punctuation">,</span> setFrames<span class="token punctuation">]</span> <span class="token operator">=</span> useState<span class="token operator">&lt;</span>Frame<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> tick <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">ptr<span class="token punctuation">:</span> number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 检查canvas实例与内存中动画帧是否存在</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>canvasRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> current <span class="token punctuation">}</span> <span class="token operator">=</span> canvasRef<span class="token punctuation">;</span>
    <span class="token keyword">const</span> ctx <span class="token operator">=</span> current<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ctx<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> frame <span class="token operator">=</span> frames<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>frame<span class="token punctuation">.</span>imageElement<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> scaling <span class="token operator">=</span> <span class="token punctuation">(</span>current<span class="token punctuation">.</span>parentElement<span class="token operator">?</span><span class="token punctuation">.</span>clientWidth <span class="token operator">?</span><span class="token operator">?</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">230</span><span class="token punctuation">;</span> <span class="token comment">// 这个230是标准的帧图片尺寸</span>
    ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> current<span class="token punctuation">.</span>clientWidth<span class="token punctuation">,</span> current<span class="token punctuation">.</span>clientHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>
      frame<span class="token punctuation">.</span>imageElement<span class="token punctuation">,</span>
      frame<span class="token punctuation">.</span>left <span class="token operator">*</span> scaling<span class="token punctuation">,</span>
      frame<span class="token punctuation">.</span>top <span class="token operator">*</span> scaling<span class="token punctuation">,</span>
      frame<span class="token punctuation">.</span>width <span class="token operator">*</span> scaling<span class="token punctuation">,</span>
      frame<span class="token punctuation">.</span>height <span class="token operator">*</span> scaling
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>frames<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * 在首次加载与参数id发生变化时会执行, 用以将动画帧加载到内存中
   * @function
   */</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">// 获取指定位置的apng frames</span>
    <span class="token function">getOrbApngFrames</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">images</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token function">setFrames</span><span class="token punctuation">(</span>images<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        timer <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          events<span class="token punctuation">.</span>launchSubject<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          events<span class="token punctuation">.</span>breakSubject<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>id<span class="token punctuation">,</span> events<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ... 一些其他处理</span>
    <span class="token keyword">let</span> handle<span class="token punctuation">;</span>
    handle <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      handle <span class="token operator">=</span> <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">animationTick</span><span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>t <span class="token operator">-</span> lastFrameAt<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token punctuation">(</span><span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 30 fps</span>
            <span class="token function">tick</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 动画首帧绘制出来之后再让静态的宝珠图片淡出. 以防止出现宝珠消失但动画还没加载出来的情况</span>
            <span class="token comment">// ... 一切其他处理</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>ptr <span class="token operator">&lt;</span> frames<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            handle <span class="token operator">=</span> <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>animationTick<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            ptr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            events<span class="token punctuation">.</span>breakSubject<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ...</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 等激光射过来</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>handle<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">cancelAnimationFrame</span><span class="token punctuation">(</span>handle<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>frames<span class="token punctuation">.</span>length<span class="token punctuation">,</span> tick<span class="token punctuation">,</span> events<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="参考"><a href="#参考" aria-hidden="true" class="header-anchor">#</a> 参考</h2> <ul><li>本文APNG组成结构参考自<a href="https://segmentfault.com/a/1190000023516861" target="_blank" rel="noopener noreferrer">Web 端 APNG 播放实现原理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <div class="post-copyright-container"><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>
      mrgaogang.github.io
    </li> <li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://mrgaogang.github.io/javascript/deep/500%E5%9B%BE%E7%89%87%E7%9A%84%E5%8A%A8%E7%94%BB%E5%BA%94%E8%AF%A5%E6%80%8E%E4%B9%88%E6%92%AD%E6%94%BE.html" title="声明博客的许可协议">https://mrgaogang.github.io/javascript/deep/500%E5%9B%BE%E7%89%87%E7%9A%84%E5%8A%A8%E7%94%BB%E5%BA%94%E8%AF%A5%E6%80%8E%E4%B9%88%E6%92%AD%E6%94%BE.html</a></li> <li class="post-copyright-license"><strong>版权声明： </strong>
      本博客所有文章除特别声明外，均采用
      <a href="https://creativecommons.org/licenses/by-sa/4.0/" rel="external nofollow" target="_blank">CC BY-SA 4.0</a>
      许可协议。转载请注明出处！
    </li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">【未经作者允许禁止转载】 Last Updated: </span> <span class="time">4/25/2021, 6:52:52 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.debbd07d.js" defer></script><script src="/assets/js/6.76c5b44c.js" defer></script><script src="/assets/js/3.3c5aab3c.js" defer></script><script src="/assets/js/15.5142b34e.js" defer></script>
  </body>
</html>
