<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>高先生的博客</title>
    <meta name="description" content="旨在分享对技术的了解">
    <link rel="icon" href="/icons/icon.png">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?9cfd884fe46fc31072811d47a486a552";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    
    <link rel="preload" href="/assets/css/0.styles.e1a0e71d.css" as="style"><link rel="preload" href="/assets/js/app.c442d8c4.js" as="script"><link rel="preload" href="/assets/js/6.67406e8c.js" as="script"><link rel="preload" href="/assets/js/3.5ac3ae2c.js" as="script"><link rel="preload" href="/assets/js/12.a3342e3d.js" as="script"><link rel="prefetch" href="/assets/js/1.5ed799af.js"><link rel="prefetch" href="/assets/js/10.3b61ba61.js"><link rel="prefetch" href="/assets/js/100.61478e2b.js"><link rel="prefetch" href="/assets/js/101.cb81c856.js"><link rel="prefetch" href="/assets/js/102.fdb536c1.js"><link rel="prefetch" href="/assets/js/103.0e102f8e.js"><link rel="prefetch" href="/assets/js/104.1aa0e544.js"><link rel="prefetch" href="/assets/js/105.c55b4a54.js"><link rel="prefetch" href="/assets/js/106.d36c2e0f.js"><link rel="prefetch" href="/assets/js/107.f8f1477b.js"><link rel="prefetch" href="/assets/js/108.b9f240af.js"><link rel="prefetch" href="/assets/js/109.025d4571.js"><link rel="prefetch" href="/assets/js/11.7c3a14cb.js"><link rel="prefetch" href="/assets/js/110.d0c89ca9.js"><link rel="prefetch" href="/assets/js/111.eb1b7a1f.js"><link rel="prefetch" href="/assets/js/112.3c360d79.js"><link rel="prefetch" href="/assets/js/113.2cdb45dc.js"><link rel="prefetch" href="/assets/js/114.582b2606.js"><link rel="prefetch" href="/assets/js/115.8a25a364.js"><link rel="prefetch" href="/assets/js/116.e1161d74.js"><link rel="prefetch" href="/assets/js/117.80f8c4e2.js"><link rel="prefetch" href="/assets/js/118.afe3811d.js"><link rel="prefetch" href="/assets/js/119.72eaff5b.js"><link rel="prefetch" href="/assets/js/120.101ed8d3.js"><link rel="prefetch" href="/assets/js/121.9cb668d2.js"><link rel="prefetch" href="/assets/js/122.c57a0931.js"><link rel="prefetch" href="/assets/js/123.11faecc1.js"><link rel="prefetch" href="/assets/js/124.75439504.js"><link rel="prefetch" href="/assets/js/125.2c13291e.js"><link rel="prefetch" href="/assets/js/126.50c5a76a.js"><link rel="prefetch" href="/assets/js/127.f4bfca26.js"><link rel="prefetch" href="/assets/js/128.124fbb16.js"><link rel="prefetch" href="/assets/js/129.b95bbe3b.js"><link rel="prefetch" href="/assets/js/13.ac12b3fb.js"><link rel="prefetch" href="/assets/js/130.14e90116.js"><link rel="prefetch" href="/assets/js/131.6ce13e93.js"><link rel="prefetch" href="/assets/js/132.46dae05c.js"><link rel="prefetch" href="/assets/js/133.e5c4a9ba.js"><link rel="prefetch" href="/assets/js/134.d4767c2e.js"><link rel="prefetch" href="/assets/js/135.fa0c9095.js"><link rel="prefetch" href="/assets/js/136.775ae101.js"><link rel="prefetch" href="/assets/js/137.dc144ee5.js"><link rel="prefetch" href="/assets/js/138.2f5bff27.js"><link rel="prefetch" href="/assets/js/139.d3eec936.js"><link rel="prefetch" href="/assets/js/14.b89e1906.js"><link rel="prefetch" href="/assets/js/140.7b48b4be.js"><link rel="prefetch" href="/assets/js/141.7bec24c5.js"><link rel="prefetch" href="/assets/js/142.93ca64b2.js"><link rel="prefetch" href="/assets/js/143.65a72f29.js"><link rel="prefetch" href="/assets/js/144.f246a25e.js"><link rel="prefetch" href="/assets/js/145.445d4ce5.js"><link rel="prefetch" href="/assets/js/146.d7c00748.js"><link rel="prefetch" href="/assets/js/147.8be388b8.js"><link rel="prefetch" href="/assets/js/148.83efa11a.js"><link rel="prefetch" href="/assets/js/149.5068078a.js"><link rel="prefetch" href="/assets/js/15.184d81e4.js"><link rel="prefetch" href="/assets/js/150.0f6765a1.js"><link rel="prefetch" href="/assets/js/151.076426cc.js"><link rel="prefetch" href="/assets/js/152.01fcc4ab.js"><link rel="prefetch" href="/assets/js/153.d3daaafe.js"><link rel="prefetch" href="/assets/js/154.d82d91ce.js"><link rel="prefetch" href="/assets/js/155.866e792e.js"><link rel="prefetch" href="/assets/js/156.26a1cc0f.js"><link rel="prefetch" href="/assets/js/157.b7c8def7.js"><link rel="prefetch" href="/assets/js/158.d2ac2906.js"><link rel="prefetch" href="/assets/js/159.7e84fe0c.js"><link rel="prefetch" href="/assets/js/16.ef689a2d.js"><link rel="prefetch" href="/assets/js/160.34025789.js"><link rel="prefetch" href="/assets/js/161.76513f0e.js"><link rel="prefetch" href="/assets/js/162.2e5185ae.js"><link rel="prefetch" href="/assets/js/163.f8263eb6.js"><link rel="prefetch" href="/assets/js/164.71a82783.js"><link rel="prefetch" href="/assets/js/165.1936b73b.js"><link rel="prefetch" href="/assets/js/166.320e533b.js"><link rel="prefetch" href="/assets/js/167.2edc211d.js"><link rel="prefetch" href="/assets/js/168.41989534.js"><link rel="prefetch" href="/assets/js/169.cf45f749.js"><link rel="prefetch" href="/assets/js/17.30afff7f.js"><link rel="prefetch" href="/assets/js/170.ce469728.js"><link rel="prefetch" href="/assets/js/171.2367c23f.js"><link rel="prefetch" href="/assets/js/172.040ab9ad.js"><link rel="prefetch" href="/assets/js/173.57930e25.js"><link rel="prefetch" href="/assets/js/174.b8b510b7.js"><link rel="prefetch" href="/assets/js/175.00693c5d.js"><link rel="prefetch" href="/assets/js/176.f578428c.js"><link rel="prefetch" href="/assets/js/177.6561a4ad.js"><link rel="prefetch" href="/assets/js/178.b2401bbe.js"><link rel="prefetch" href="/assets/js/179.9d70c509.js"><link rel="prefetch" href="/assets/js/18.d0c4258e.js"><link rel="prefetch" href="/assets/js/180.ff19e227.js"><link rel="prefetch" href="/assets/js/181.95ebc352.js"><link rel="prefetch" href="/assets/js/19.b34ca1d6.js"><link rel="prefetch" href="/assets/js/2.fa8c63e2.js"><link rel="prefetch" href="/assets/js/20.2aa02291.js"><link rel="prefetch" href="/assets/js/21.14531429.js"><link rel="prefetch" href="/assets/js/22.4e5bc790.js"><link rel="prefetch" href="/assets/js/23.b26a6909.js"><link rel="prefetch" href="/assets/js/24.acfe6d49.js"><link rel="prefetch" href="/assets/js/25.5ff91fb8.js"><link rel="prefetch" href="/assets/js/26.ccd28ee6.js"><link rel="prefetch" href="/assets/js/27.d678a69a.js"><link rel="prefetch" href="/assets/js/28.b74d04bd.js"><link rel="prefetch" href="/assets/js/29.28712d2b.js"><link rel="prefetch" href="/assets/js/30.c07f7d17.js"><link rel="prefetch" href="/assets/js/31.a8a8a302.js"><link rel="prefetch" href="/assets/js/32.34549c94.js"><link rel="prefetch" href="/assets/js/33.d3dcd021.js"><link rel="prefetch" href="/assets/js/34.2b4e6acb.js"><link rel="prefetch" href="/assets/js/35.707b4f75.js"><link rel="prefetch" href="/assets/js/36.c2847a69.js"><link rel="prefetch" href="/assets/js/37.2800e964.js"><link rel="prefetch" href="/assets/js/38.2fd854fd.js"><link rel="prefetch" href="/assets/js/39.3de48f97.js"><link rel="prefetch" href="/assets/js/40.fa21fc35.js"><link rel="prefetch" href="/assets/js/41.1adbec8b.js"><link rel="prefetch" href="/assets/js/42.f17db41e.js"><link rel="prefetch" href="/assets/js/43.e78e4d85.js"><link rel="prefetch" href="/assets/js/44.4cdedc94.js"><link rel="prefetch" href="/assets/js/45.890ee7cf.js"><link rel="prefetch" href="/assets/js/46.bbd17649.js"><link rel="prefetch" href="/assets/js/47.f18ced2f.js"><link rel="prefetch" href="/assets/js/48.18501e27.js"><link rel="prefetch" href="/assets/js/49.df5cb6cb.js"><link rel="prefetch" href="/assets/js/5.9e8237b5.js"><link rel="prefetch" href="/assets/js/50.6bebc7c4.js"><link rel="prefetch" href="/assets/js/51.374dca80.js"><link rel="prefetch" href="/assets/js/52.48a108c8.js"><link rel="prefetch" href="/assets/js/53.f2dcb301.js"><link rel="prefetch" href="/assets/js/54.03c9909d.js"><link rel="prefetch" href="/assets/js/55.29a4bc4a.js"><link rel="prefetch" href="/assets/js/56.aa97b120.js"><link rel="prefetch" href="/assets/js/57.2ba4cdfa.js"><link rel="prefetch" href="/assets/js/58.2015c675.js"><link rel="prefetch" href="/assets/js/59.54a3170a.js"><link rel="prefetch" href="/assets/js/60.69cb234e.js"><link rel="prefetch" href="/assets/js/61.715300fc.js"><link rel="prefetch" href="/assets/js/62.44b8da3d.js"><link rel="prefetch" href="/assets/js/63.3fcadc29.js"><link rel="prefetch" href="/assets/js/64.ef2098e5.js"><link rel="prefetch" href="/assets/js/65.0a1e0cde.js"><link rel="prefetch" href="/assets/js/66.44a8932b.js"><link rel="prefetch" href="/assets/js/67.f9c9d686.js"><link rel="prefetch" href="/assets/js/68.1680e9f4.js"><link rel="prefetch" href="/assets/js/69.1a66c61e.js"><link rel="prefetch" href="/assets/js/7.bc13856f.js"><link rel="prefetch" href="/assets/js/70.1ada988a.js"><link rel="prefetch" href="/assets/js/71.ed693c26.js"><link rel="prefetch" href="/assets/js/72.734d53a5.js"><link rel="prefetch" href="/assets/js/73.d333105f.js"><link rel="prefetch" href="/assets/js/74.aeeac20d.js"><link rel="prefetch" href="/assets/js/75.cd4671e2.js"><link rel="prefetch" href="/assets/js/76.a9cab6c4.js"><link rel="prefetch" href="/assets/js/77.d2f1d4ad.js"><link rel="prefetch" href="/assets/js/78.03d24e7b.js"><link rel="prefetch" href="/assets/js/79.b1232d26.js"><link rel="prefetch" href="/assets/js/8.6d41ba71.js"><link rel="prefetch" href="/assets/js/80.b61a30f4.js"><link rel="prefetch" href="/assets/js/81.773649d7.js"><link rel="prefetch" href="/assets/js/82.d975fe9b.js"><link rel="prefetch" href="/assets/js/83.f2fd5129.js"><link rel="prefetch" href="/assets/js/84.a1162c1b.js"><link rel="prefetch" href="/assets/js/85.78f41095.js"><link rel="prefetch" href="/assets/js/86.2745bd2c.js"><link rel="prefetch" href="/assets/js/87.4f31c98f.js"><link rel="prefetch" href="/assets/js/88.0b05ee80.js"><link rel="prefetch" href="/assets/js/89.b032bf19.js"><link rel="prefetch" href="/assets/js/9.242a93c1.js"><link rel="prefetch" href="/assets/js/90.dd26bbd4.js"><link rel="prefetch" href="/assets/js/91.ee3e9f6a.js"><link rel="prefetch" href="/assets/js/92.0302b5b1.js"><link rel="prefetch" href="/assets/js/93.26ca2d36.js"><link rel="prefetch" href="/assets/js/94.76730399.js"><link rel="prefetch" href="/assets/js/95.e00795ea.js"><link rel="prefetch" href="/assets/js/96.e22b278e.js"><link rel="prefetch" href="/assets/js/97.10c350bf.js"><link rel="prefetch" href="/assets/js/98.edc40cb5.js"><link rel="prefetch" href="/assets/js/99.5bfede46.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e1a0e71d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/header.png" alt="高先生的博客" class="logo"> <span class="site-name can-hide">高先生的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="https://mrgaogang.github.io/parse-jsx-to-css-plugins/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue/React to CSS/Less/Sass
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://gaogangsever.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  页面构建器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/javascript/index.html" class="nav-link">前端</a></div><div class="nav-item"><a href="/vue/index.html" class="nav-link">Vue</a></div><div class="nav-item"><a href="/react/index.html" class="nav-link">React/RN</a></div><div class="nav-item"><a href="/ai/index.html" class="nav-link">AI/Node</a></div><div class="nav-item"><a href="/android/index.html" class="nav-link">Android</a></div><div class="nav-item"><a href="/ios/index.html" class="nav-link">iOS</a></div><div class="nav-item"><a href="/other/index.html" class="nav-link">杂谈</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">低代码Mendix</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mendix/index.html" class="nav-link">1. Mendix介绍</a></li><li class="dropdown-item"><!----> <a href="/mendix/widgets/index.html" class="nav-link">2. 组件开发</a></li><li class="dropdown-item"><!----> <a href="/mendix/study.html" class="nav-link">3. Mendix学习</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">开源</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/article/oview/index.html" class="nav-link">图表库oView</a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/luckly_recyclerview" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lucky_recyclerview
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/luckly_popup_window" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lucky_popup_window
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/lucky_tools/blob/master/packages/mendix-cli/README.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue开发Mendix组件脚手架
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/cocos-webpack-web" target="_blank" rel="noopener noreferrer" class="nav-link external">
  cocos web端开发
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/ui-designer" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ui 构建器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/KotlinGank" target="_blank" rel="noopener noreferrer" class="nav-link external">
  kotlin App
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/tensorflow_object_detection" target="_blank" rel="noopener noreferrer" class="nav-link external">
  tensorflow object detection
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/react-native-file-hash-plugin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react-native-file-hash-plugin
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/parse-jsx-to-css" target="_blank" rel="noopener noreferrer" class="nav-link external">
  parse-jsx-to-css
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/MrGaoGang/mrgaogang.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="https://mrgaogang.github.io/parse-jsx-to-css-plugins/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue/React to CSS/Less/Sass
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://gaogangsever.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  页面构建器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/javascript/index.html" class="nav-link">前端</a></div><div class="nav-item"><a href="/vue/index.html" class="nav-link">Vue</a></div><div class="nav-item"><a href="/react/index.html" class="nav-link">React/RN</a></div><div class="nav-item"><a href="/ai/index.html" class="nav-link">AI/Node</a></div><div class="nav-item"><a href="/android/index.html" class="nav-link">Android</a></div><div class="nav-item"><a href="/ios/index.html" class="nav-link">iOS</a></div><div class="nav-item"><a href="/other/index.html" class="nav-link">杂谈</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">低代码Mendix</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mendix/index.html" class="nav-link">1. Mendix介绍</a></li><li class="dropdown-item"><!----> <a href="/mendix/widgets/index.html" class="nav-link">2. 组件开发</a></li><li class="dropdown-item"><!----> <a href="/mendix/study.html" class="nav-link">3. Mendix学习</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">开源</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/article/oview/index.html" class="nav-link">图表库oView</a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/luckly_recyclerview" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lucky_recyclerview
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/luckly_popup_window" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lucky_popup_window
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/lucky_tools/blob/master/packages/mendix-cli/README.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue开发Mendix组件脚手架
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/cocos-webpack-web" target="_blank" rel="noopener noreferrer" class="nav-link external">
  cocos web端开发
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/ui-designer" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ui 构建器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/KotlinGank" target="_blank" rel="noopener noreferrer" class="nav-link external">
  kotlin App
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/tensorflow_object_detection" target="_blank" rel="noopener noreferrer" class="nav-link external">
  tensorflow object detection
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/react-native-file-hash-plugin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react-native-file-hash-plugin
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/parse-jsx-to-css" target="_blank" rel="noopener noreferrer" class="nav-link external">
  parse-jsx-to-css
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/MrGaoGang/mrgaogang.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#一、bundle-和沙盒" class="sidebar-link">一、Bundle 和沙盒</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#_1-bundle" class="sidebar-link">1. Bundle</a></li><li class="sidebar-sub-header"><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#_2-沙盒" class="sidebar-link">2. 沙盒</a></li><li class="sidebar-sub-header"><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#_3-沙盒路径访问" class="sidebar-link">3. 沙盒路径访问</a></li></ul></li><li><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#二、数据存取-plist" class="sidebar-link">二、数据存取: plist</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#_1-plist-文件的读取" class="sidebar-link">1. plist 文件的读取</a></li><li class="sidebar-sub-header"><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#_3-plist-文件写入" class="sidebar-link">3. plist 文件写入</a></li></ul></li><li><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#三、数据存取-nsuserdefaults-偏好设置" class="sidebar-link">三、数据存取: NSUserDefaults(偏好设置)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#_1-nsuserdefaults-基础使用-登录-demo" class="sidebar-link">1. NSUserDefaults 基础使用(登录 demo)</a></li><li class="sidebar-sub-header"><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#_2-使用-nsuserdefaults-制作新特性页面" class="sidebar-link">2. 使用 NSUserDefaults 制作新特性页面</a></li></ul></li><li><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#四、数据存取-归档-nskeyedarchiver" class="sidebar-link">四、数据存取: 归档-NSKeyedArchiver</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#_1-nskeyedarchiver-的基础使用" class="sidebar-link">1. NSKeyedArchiver 的基础使用</a></li><li class="sidebar-sub-header"><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#_1-nskeyedarchiver-自定义对象归档" class="sidebar-link">1. NSKeyedArchiver 自定义对象归档</a></li></ul></li><li><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#五、数据存取-数据库-sqlite3" class="sidebar-link">五、数据存取: 数据库-sqlite3</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#_1-sqlite-简单介绍" class="sidebar-link">1. sqlite 简单介绍</a></li><li class="sidebar-sub-header"><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#_2-sqlite3-基础使用-工程搭建及自定义-model" class="sidebar-link">2. sqlite3 基础使用-工程搭建及自定义 Model</a></li><li class="sidebar-sub-header"><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#_3-sqlite-操作工具类-增删改查" class="sidebar-link">3. sqlite 操作工具类(增删改查)</a></li></ul></li><li><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#六、-fmdb-的使用" class="sidebar-link">六、 FMDB 的使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#_1-fmdb-的安装" class="sidebar-link">1. FMDB 的安装</a></li><li class="sidebar-sub-header"><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#_2-model的建立" class="sidebar-link">2. Model的建立</a></li><li class="sidebar-sub-header"><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#_3-数据库的增删改查" class="sidebar-link">3. 数据库的增删改查</a></li><li class="sidebar-sub-header"><a href="/ios/data/IOS%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96.html#_4-事务的操作" class="sidebar-link">4. 事务的操作</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="ads-main"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAG4UlEQVR4Xu2Zf4xdRRXHv+eu7f5hEyD6h9qVBFMSgrEJIkINAilogymRSHe3QcAU/aub3Tv3vUgDhF+iRIXunHvrGtPYajTR2IJSm1J+tAFaS0GpQLCGKiENKRBCCIEQ2mjuHHLIfbp9fXfu3PcewrpvkmaT3jPnx2fOnDkzjzDPB83z+DEAMMiAeU5gsAXmeQIMiuBgCwy2wDwnMNgCdRMgjuNRIvoIM/+27twPo3ytDCiC31IE8m1m3hwS1OTk5HAURZdHUXSOiHwKwCcBtP6qilcAvKx/iejlPM+fzPP8oZmZmddD9PciEwygLfiWzTXM/MtODkxMTHxswYIFlxHRShG5DMDCuo6KyP1E9DCAXcz817rzQ+SDAJQE/55+EVmVpuk9LWPr1q076dixYxNEtBbA4hAnAmRyAD9xzs1kWfbPAPlgkSAASZJsEZHRMq1EtOLIkSO7R0ZGGiJyPYBTgj2oJ/iGiMwcPXr0ro0bN75Zb2pn6SAAOjWO47uJ6AqPUV2loQCndK8/KiIHiOiA1oOiLiyJomipiCwFsKhCj867iZl3BtjzigQDUC3GGE31b3Rp9DYAjzDzI775k5OTI0NDQzERTYmIt24Q0fettTd16c9702oBKCD8AcDlNYxqwLdVBd6uzxjzeSKaEZHzKmxtY+Y6/hynrjaAAsK9AL5eBYGItlprx6rkfN+NMZsAXFuhYw8zX9iNna4AFBD+CECPt46jH8G3FBtjbgVwS0WAe5n5groQugaghpIk2S4iK8uMishYmqZb6zrVSd4Y8ysAV/t0iYhN07RRx15PANRQHMc7iOhrdSBoXxFF0WhxtGpFfwbAfmb+eZkeY8xFALQpqhpabzRjgkbPAIrtcB+AS6sgxHG8lIjuBPDVTrJEtNtae4kHggJQEFUjuE0PAtBsNs/M8/xMZr7b49z9AFb4IBDRDwF8psL7w8x8Wsk2MABsVfQAXhKRi9M0PVQlGwTAGKMp+jkAq5j59x4ID5StbpUjbd/XMfOP2+cUC3EwUNcWZh6vkq0EYIy5DsCPCkW5doPW2m0eCA8C+EqV4arvzrlLsizb3S5njPkbgM9WzdfvIhKnaZr5ZL0A1q5du2jhwoXPzb7UENG/NBOstdvLFCdJsktTMMTJMhki+qa19jcdAITWAZ36PDOf3jWAsspLRMf0FsjMOzyZoKu3vAcICTNzjwB0+lnM/HQpaJ+DzWbz43mev1Yi805RE0ovJMaYOqvVbqYMwGMAloWCJaLTrbXPdwVAJyVJ8gMRuaFEwdvFe4AWv47DGKN3gW7a1I4rF8fxC0TU8ZRod0BEHk7T1JuFlUVQ68Dw8PAeETmrJMa3CggPeSDsAfDl0FUDcIiZz+gkb4x5G8BHA3T92zm3PMuyP3VdA1oTfS9Chcwb2tlNT0+fULVbOowxewGcH+C4Vu+OLbQxRlthbYkrBxFdb63VvsM7KjNgFoTNRLTGo+31AkJpuxrH8T4i+pLPI9/9wRgT2mfsYObSO8ps+8EAkiRZ4pzbS0Sf8ASgBXPMd/c3xlQVsSs7Pbk3Go0rnHOlnegsn/SpbHnoI2owADVgjJkE4G0sALxarKLu+7LC+DiAcz0gT+jljTGhdeQaZv51Veq3vtcCUEDQ6+b6CgOvOOfGfAXIGPMEgC969Ewx84bCZsh7AIioYa0NuSv8x2xtADozSZI1IlL1o8gR59x4lmWa8mWZ8BcAX/BA0ON3OOAxRIO/w1p7Y+jKd50BrYnGGH0c1YrsO5JejKJofHp6WlO+DMKTAM6u6/hxhYxok7X2O93o6CoDWoampqYujqJIfxka8Rg/TETj1to/eyDot3O6CUBE7kjTtPbK95wBLQXNZvPsPM9/VpHK2r0pBF3tjiNJkv0BL8D/3btEW/M8/16WZXo77Hr0lAGzrcZxfBURfQtA2YuO9uPjvuMpSZJ9IuLtEwBoJ6hHbc8/iqj/fQPQghHH8coCxKoOy/KPPM9Xb9iw4SnPdvB2jCKyOk3T33W95G0T+w5gVn04P4oizQh9/zu19f8i8pxzTiHoK1NZYXwUQOkTt3Pu2izLftEPCO8bgNnO6VOWc26Z/iOi84hI7a621j7rgeC9ShPRhLX2p71C+J8A6ORkAYWstaVvfAHvCd9l5rt6gfCBAQh1OgDCzcx8e6i+drkPPQB12APh4NDQ0Nj69ev//n8NYHR0dGjx4sW72n4U6Tn49+UY7HYlquYZY04mop1Fs9SX4OcUAHW20Wh82jm3s9e0nw17TtSA9iO1lz0/J4tg1fbo5fucy4Begu00dwCg30Tnmr5BBsy1Feu3v4MM6DfRuaZvkAFzbcX67e+8z4B3AU7+oV/ZJX7ZAAAAAElFTkSuQmCC" class="btn-control"> <img src="https://camo.githubusercontent.com/01448f33e0bc34a83317f39bb3a1df723e109d4194e0259b7345775fe99968d5/68747470733a2f2f70312d6a75656a696e2e62797465696d672e636f6d2f746f732d636e2d692d6b3375316662706663702f33306666633738643332313434323632623536633633653230323261656163307e74706c762d6b3375316662706663702d7a6f6f6d2d312e696d616765" class="my-wechat-m" style="display:;"> <div class="item-ads" style="display:;"><div class="ads-name">耗时4天写的日程小程序</div> <img src="/assets/img/mini-app.9d4e9bb7.png" class="item-ads-url item-ads-url-full"></div><div class="item-ads" style="display:;"><div class="ads-name">华为云各类服务内部优惠</div> <img src="/assets/img/huawei.1ebdc4d9.png" class="item-ads-url"></div></div> <div class="theme-default-content content__default"><p>有开发经验的同学应该都清楚，不管是前端，客户端有些数据都需要在本地落地的；那么这一章我们就来一起了解一下 iOS 的数据存取常用的方法。</p> <p>在对 iOS 数据 进行具体的操作之前，我们需要首先了解一下 Bundle 和沙盒的概念。</p> <h2 id="一、bundle-和沙盒"><a href="#一、bundle-和沙盒" aria-hidden="true" class="header-anchor">#</a> 一、Bundle 和沙盒</h2> <p>Bundle 和沙盒是 iOS 数据存储的具体地方；</p> <h3 id="_1-bundle"><a href="#_1-bundle" aria-hidden="true" class="header-anchor">#</a> 1. Bundle</h3> <blockquote><p>Bundle 是一个目录,其中包含了程序会使用到的资源.这些资源包含了如图像,声音,编译好的代码,nib 文件等待</p></blockquote> <p><strong>使用 pathForResource 的路径为真实环境 APP 下面的路径</strong></p> <div class="language-java extra-class"><pre class="language-java"><code> <span class="token comment">//    加载Info.plist资源,mainBundle的资源都是放到RootFolder下</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>infoPath<span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">NSBundle</span> mainBundle<span class="token punctuation">]</span> pathForResource<span class="token operator">:</span>@<span class="token string">&quot;Info&quot;</span> ofType<span class="token operator">:</span>@<span class="token string">&quot;plist&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;Info路径为: %@&quot;</span><span class="token punctuation">,</span>infoPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//    找到图片路径</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>imgPath <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">NSBundle</span> mainBundle<span class="token punctuation">]</span> pathForResource<span class="token operator">:</span>@<span class="token string">&quot;ff_IconAdd_25x25_@2x&quot;</span> ofType<span class="token operator">:</span>@<span class="token string">&quot;png&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;图片路径为: %@&quot;</span><span class="token punctuation">,</span>imgPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">UIImageView</span> <span class="token operator">*</span>img <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">UIImageView</span> alloc<span class="token punctuation">]</span> initWithFrame<span class="token operator">:</span><span class="token class-name">CGRectMake</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span>image <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">UIImage</span> imageWithContentsOfFile<span class="token operator">:</span>imgPath<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token punctuation">[</span>self<span class="token punctuation">.</span>view addSubview<span class="token operator">:</span>img<span class="token punctuation">]</span><span class="token punctuation">;</span>

</code></pre></div><p>输出为:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>Info路径为: /Users/xxx/Library/Developer/CoreSimulator/Devices/8EA1B565-17F4-47FF-8ECA-C23F3EF4594A/data/Containers/Bundle/Application/76750996-9428-448E-8662-553CA22DCB28/NSBundle的使用.app/Info.plist
图片路径为: /Users/xxxx/Library/Developer/CoreSimulator/Devices/8EA1B565-17F4-47FF-8ECA-C23F3EF4594A/data/Containers/Bundle/Application/76750996-9428-448E-8662-553CA22DCB28/NSBundle的使用.app/ff_IconAdd_25x25_@2x.png
</code></pre></div><p><strong>其他常用的方法</strong></p> <div class="language-java extra-class"><pre class="language-java"><code>
<span class="token comment">//获取XML文件</span>
<span class="token class-name">NSString</span> <span class="token operator">*</span>filePath <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">NSBundle</span> mainBundle<span class="token punctuation">]</span> pathForResouse<span class="token operator">:</span>@<span class="token string">&quot;re&quot;</span> ofType<span class="token operator">:</span>@<span class="token string">&quot;xml&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token class-name">NSData</span> <span class="token operator">*</span>data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">NSData</span> alloc<span class="token punctuation">]</span> initWithContentsOfFile<span class="token operator">:</span>filePath<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//获取app包的readme.txt文件路径</span>
<span class="token class-name">NSString</span> <span class="token operator">*</span>path <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">NSBundle</span> mainBundle<span class="token punctuation">]</span> pathForResource<span class="token operator">:</span>@<span class="token string">&quot;readme&quot;</span> ofType<span class="token operator">:</span>@<span class="token string">&quot;txt&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>


<span class="token comment">//app资源目录路径</span>
<span class="token class-name">NSString</span> <span class="token operator">*</span>resPath <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">NSBundle</span> mainBundle<span class="token punctuation">]</span> resourcePath<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//获取app包路径</span>
<span class="token class-name">NSString</span> <span class="token operator">*</span>path <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">NSBundle</span> mainBundle<span class="token punctuation">]</span> bundlePath<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//通过使用下面的方法得到程序的main bundle</span>
<span class="token class-name">NSBundle</span> <span class="token operator">*</span>otherBundle <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSBundle</span> mainBundle<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//获取资源目录下a.bundle</span>
<span class="token class-name">NSString</span> <span class="token operator">*</span>path <span class="token operator">=</span> <span class="token punctuation">[</span>resPath stringByAppendingPathComponent<span class="token operator">:</span>@<span class="token string">&quot;a.bundle&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token class-name">NSBundle</span> <span class="token operator">*</span>bundle <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSBundle</span> bundleWithPath<span class="token operator">:</span>path<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//一旦我们有了bundle，就可以访问其中的资源文件了。</span>
<span class="token class-name">NSString</span> path <span class="token operator">=</span> <span class="token punctuation">[</span>otherBundle pathForImageResource<span class="token operator">:</span>@<span class="token string">&quot;img&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token class-name">NSImage</span> <span class="token operator">*</span>img <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">NSImage</span> alloc<span class="token punctuation">]</span> initWithContentsOfFile<span class="token operator">:</span>path<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//bundle中可以包含一个库. 如果我们从库得到一个class, bundle会连接库,并查找该类:</span>
<span class="token class-name">Class</span> newClass <span class="token operator">=</span> <span class="token punctuation">[</span>otherBundle classNamed<span class="token operator">:</span>@<span class="token string">&quot;Person&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
id person <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>newClass alloc<span class="token punctuation">]</span> init<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//如果不知到class名,也可以通过查找主要类来取得</span>
<span class="token class-name">Class</span> aClass <span class="token operator">=</span> <span class="token punctuation">[</span>otherBundle principalClass<span class="token punctuation">]</span><span class="token punctuation">;</span>
id classInstance <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>aClass alloc<span class="token punctuation">]</span> init<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//可以看到, NSBundle有很多的用途.在这章中, NSBundle负责(在后台)加载nib文件. 我们也可以不通过NSWindowController来加载nib文件, 直接使用NSBundle:</span>
<span class="token class-name">BOOL</span> flag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSBundle</span> loadNibNamed<span class="token operator">:</span>@<span class="token string">&quot;ViewController&quot;</span> owner<span class="token operator">:</span>someObject<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//注意: 我们指定了一个对象someObject作为nib的File”s Owner</span>

<span class="token comment">//获取属性列表</span>
<span class="token class-name">NSDictionary</span> <span class="token operator">*</span>dict <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSDictionary</span> dictionaryWithContentsOfFile<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">NSBundle</span> mainBundle<span class="token punctuation">]</span> pathForResource<span class="token operator">:</span>@<span class="token string">&quot;ViewControllers&quot;</span> ofType<span class="token operator">:</span>@<span class="token string">&quot;plist&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
————————————————

</code></pre></div><p><strong>获取 mainBundle 包内容信息</strong></p> <div class="language-java extra-class"><pre class="language-java"><code>
<span class="token operator">/</span><span class="token number">1.</span>获取app的info<span class="token punctuation">.</span>plist详细信息

<span class="token comment">//build 版本号</span>
<span class="token class-name">NSString</span> <span class="token operator">*</span>version <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">NSBundle</span> mainBundle<span class="token punctuation">]</span> infoDictionary<span class="token punctuation">]</span> objectForKey<span class="token operator">:</span>@<span class="token string">&quot;CFBundleVersion&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//version 版本号</span>
<span class="token class-name">NSString</span> <span class="token operator">*</span>version2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">NSBundle</span> mainBundle<span class="token punctuation">]</span> objectForInfoDictionaryKey<span class="token operator">:</span>@<span class="token string">&quot;CFBundleShortVersionString&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//应用标识：Bundle identifier</span>
<span class="token class-name">NSString</span> <span class="token operator">*</span>bundleId <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">NSBundle</span> mainBundle<span class="token punctuation">]</span> infoDictionary<span class="token punctuation">]</span> objectForKey<span class="token operator">:</span>@<span class="token string">&quot;CFBundleIdentifier&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//Bundle name</span>
<span class="token class-name">NSString</span> <span class="token operator">*</span>appName <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">NSBundle</span> mainBundle<span class="token punctuation">]</span> objectForInfoDictionaryKey<span class="token operator">:</span>@<span class="token string">&quot;CFBundleName&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//应用展示的名字</span>
<span class="token class-name">NSString</span> <span class="token operator">*</span>appName <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">NSBundle</span> mainBundle<span class="token punctuation">]</span> objectForInfoDictionaryKey<span class="token operator">:</span>@<span class="token string">&quot;CFBundleDisplayName&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//2.应用程序语言本地化</span>
<span class="token comment">//app本地化宏</span>
#define <span class="token class-name">XLocalizedString</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> comment<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">NSBundle</span> mainBundle<span class="token punctuation">]</span> localizedStringForKey<span class="token operator">:</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> value<span class="token operator">:</span>@<span class="token string">&quot;&quot;</span> table<span class="token operator">:</span>nil<span class="token punctuation">]</span>


</code></pre></div><h3 id="_2-沙盒"><a href="#_2-沙盒" aria-hidden="true" class="header-anchor">#</a> 2. 沙盒</h3> <p><img src="/assets/img/sandbox.fb3b1dba.png" alt=""></p> <p>每一个 IOS 程序都是单独运行在一个沙盒内部的，以保证不会篡改或者读取其他 APP 的信息。</p> <p>其中 Data Container 包含如下三个目录:</p> <ul><li><p><code>Documents</code>: 应用程序在运行时生成的一些需要长久保存的重要数据放在此文件中;</p></li> <li><p><code>Library</code>:</p> <ul><li><code>Cache</code>:存放缓存文件，比如从网路上下载的数据或数据。一般用来保存应用需要长期使用的，数据量大，不需要备份的非重要数据。iTunes</li> <li><code>Prefrence</code>：保存应用的所有偏好设置，比如账号，设置等。由系统自动管理</li></ul></li> <li><p><code>tmp</code>: 用于保存应用在运行时产生的一些临时数据文件，手机重启，系统空间不足的，关闭应用等场景下可能会删除该文件下的文件</p></li></ul> <h3 id="_3-沙盒路径访问"><a href="#_3-沙盒路径访问" aria-hidden="true" class="header-anchor">#</a> 3. 沙盒路径访问</h3> <ul><li><p><strong>沙盒入口</strong></p> <p><code>NSLog(@&quot;%@&quot;,NSHomeDirectory());</code></p></li> <li><p><strong>沙盒 tmp 目录</strong></p> <p><code>NSLog(@&quot;%@&quot;,NSTemporaryDirectory());</code></p></li> <li><p><strong>沙盒 Documents 目录</strong></p></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 1:  拼接方式</span>
<span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;%@&quot;</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token class-name">NSHomeDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> stringByAppendingPathComponent<span class="token operator">:</span>@<span class="token string">&quot;Documents&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//    沙盒Documents目录 2: 建议使用的方式</span>
<span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;%@&quot;</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token class-name">NSSearchPathForDirectoriesInDomains</span><span class="token punctuation">(</span><span class="token class-name">NSDocumentDirectory</span><span class="token punctuation">,</span> <span class="token class-name">NSUserDomainMask</span><span class="token punctuation">,</span> YES<span class="token punctuation">)</span> firstObject<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><strong>沙盒 Library 目录</strong></li></ul> <div class="language-java extra-class"><pre class="language-java"><code>   <span class="token comment">// 1:  拼接方式</span>
   <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;%@&quot;</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token class-name">NSHomeDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> stringByAppendingPathComponent<span class="token operator">:</span>@<span class="token string">&quot;Library&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">//    沙盒Library目录 2: 建议使用的方式</span>
   <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;%@&quot;</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token class-name">NSSearchPathForDirectoriesInDomains</span><span class="token punctuation">(</span><span class="token class-name">NSLibraryDirectory</span><span class="token punctuation">,</span> <span class="token class-name">NSUserDomainMask</span><span class="token punctuation">,</span> YES<span class="token punctuation">)</span> firstObject<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><strong>沙盒 Library 下的 Caches 目录 建议使用的方式</strong></li></ul> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;%@&quot;</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token class-name">NSSearchPathForDirectoriesInDomains</span><span class="token punctuation">(</span><span class="token class-name">NSCachesDirectory</span><span class="token punctuation">,</span> <span class="token class-name">NSUserDomainMask</span><span class="token punctuation">,</span> YES<span class="token punctuation">)</span> firstObject<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><strong>沙盒 Library 下的 Preferences 目录,只能采用拼接的方式，此处使用的 Library+Preferences 的方式</strong></li></ul> <p><code>NSLog(@&quot;%@&quot;,[[NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES) firstObject] stringByAppendingPathComponent:@&quot;Preferences&quot;]);</code></p> <h2 id="二、数据存取-plist"><a href="#二、数据存取-plist" aria-hidden="true" class="header-anchor">#</a> 二、数据存取: plist</h2> <p>plist 文件本质上是一个 xml 文件,按照<code>key:value</code>的形式存储。</p> <h3 id="_1-plist-文件的读取"><a href="#_1-plist-文件的读取" aria-hidden="true" class="header-anchor">#</a> 1. plist 文件的读取</h3> <p><strong>读取系统自带的 Info.plist</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">NSDictionary</span> <span class="token operator">*</span>sysInfo <span class="token operator">=</span> <span class="token class-name">NSBundle</span><span class="token punctuation">.</span>mainBundle<span class="token punctuation">.</span>infoDictionary<span class="token punctuation">;</span>
<span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;%@&quot;</span><span class="token punctuation">,</span>sysInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;%@&quot;</span><span class="token punctuation">,</span>sysInfo<span class="token punctuation">[</span>@<span class="token string">&quot;CFBundleShortVersionString&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>自定义的 plist 文件</strong></p> <p><img src="/assets/img/create-plist.3b13f7cc.png" alt=""></p> <p><img src="/assets/img/create-user.11de539c.png" alt="">;</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token comment">//    可以使用NSBundle.mainBundle pathForResource 读取项目工程目录下的文件</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>userPath <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSBundle</span><span class="token punctuation">.</span>mainBundle pathForResource<span class="token operator">:</span>@<span class="token string">&quot;user&quot;</span> ofType<span class="token operator">:</span>@<span class="token string">&quot;plist&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">NSDictionary</span> <span class="token operator">*</span>userDic <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSDictionary</span> dictionaryWithContentsOfFile<span class="token operator">:</span>userPath<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;username= %@ , password = %@&quot;</span><span class="token punctuation">,</span>userDic<span class="token punctuation">[</span>@<span class="token string">&quot;username&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>userDic<span class="token punctuation">[</span>@<span class="token string">&quot;password&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//    解析一个复杂的plist; value为array的情况</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>cityPath <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSBundle</span><span class="token punctuation">.</span>mainBundle pathForResource<span class="token operator">:</span>@<span class="token string">&quot;cityData&quot;</span> ofType<span class="token operator">:</span>@<span class="token string">&quot;plist&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">NSDictionary</span> <span class="token operator">*</span>cityDic <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSDictionary</span> dictionaryWithContentsOfFile<span class="token operator">:</span>cityPath<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token class-name">NSArray</span> <span class="token operator">*</span>allKeys <span class="token operator">=</span> cityDic<span class="token punctuation">.</span>allKeys<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>allKeys<span class="token punctuation">.</span>count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot; key = %@ , value = %@&quot;</span><span class="token punctuation">,</span>allKeys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>cityDic<span class="token punctuation">[</span>allKeys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 读取沙盒中Documents中的数据</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>path <span class="token operator">=</span> <span class="token class-name">NSSearchPathForDirectoriesInDomains</span><span class="token punctuation">(</span><span class="token class-name">NSDocumentDirectory</span><span class="token punctuation">,</span><span class="token class-name">NSUserDomainMask</span><span class="token punctuation">,</span> YES<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>dataPath <span class="token operator">=</span> <span class="token punctuation">[</span>path stringByAppendingPathComponent<span class="token operator">:</span>@<span class="token string">&quot;data.plist&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">NSDictionary</span> <span class="token operator">*</span>dataDict <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSDictionary</span> dictionaryWithContentsOfFile<span class="token operator">:</span>path<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;%@&quot;</span><span class="token punctuation">,</span> dataDict<span class="token punctuation">)</span><span class="token punctuation">;</span>


</code></pre></div><p><strong>注意点</strong></p> <ul><li>plist 文件接收需要使用一个 NSDictionary</li> <li>plist 文件中 key 对应的 value 需要使用合适的类型接收数据；(tips: 如果为 Array 的情况需要使用 NSArray 来接收)</li> <li>plist 文件读取主要使用: <code>dictionaryWithContentsOfFile</code>方法</li></ul> <h3 id="_3-plist-文件写入"><a href="#_3-plist-文件写入" aria-hidden="true" class="header-anchor">#</a> 3. plist 文件写入</h3> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token comment">//    将cityData.plist存储到沙盒的Documents中</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>saveFilePath <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">NSSearchPathForDirectoriesInDomains</span><span class="token punctuation">(</span><span class="token class-name">NSDocumentDirectory</span><span class="token punctuation">,</span> <span class="token class-name">NSUserDomainMask</span><span class="token punctuation">,</span> YES<span class="token punctuation">)</span> firstObject<span class="token punctuation">]</span> stringByAppendingPathComponent<span class="token operator">:</span>@<span class="token string">&quot;city.plist&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>cityDic writeToFile<span class="token operator">:</span>saveFilePath atomically<span class="token operator">:</span>YES<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// 写入部分数据</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>fujianPath <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">NSSearchPathForDirectoriesInDomains</span><span class="token punctuation">(</span><span class="token class-name">NSDocumentDirectory</span><span class="token punctuation">,</span> <span class="token class-name">NSUserDomainMask</span><span class="token punctuation">,</span> YES<span class="token punctuation">)</span> firstObject<span class="token punctuation">]</span> stringByAppendingPathComponent<span class="token operator">:</span>@<span class="token string">&quot;福建.plist&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>cityDic<span class="token punctuation">[</span>@<span class="token string">&quot;福建&quot;</span><span class="token punctuation">]</span> writeToFile<span class="token operator">:</span>fujianPath atomically<span class="token operator">:</span>YES<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="三、数据存取-nsuserdefaults-偏好设置"><a href="#三、数据存取-nsuserdefaults-偏好设置" aria-hidden="true" class="header-anchor">#</a> 三、数据存取: NSUserDefaults(偏好设置)</h2> <h3 id="_1-nsuserdefaults-基础使用-登录-demo"><a href="#_1-nsuserdefaults-基础使用-登录-demo" aria-hidden="true" class="header-anchor">#</a> 1. NSUserDefaults 基础使用(登录 demo)</h3> <blockquote><p>NSUserDefaults 偏好设置存储，不需要路径，一般用于存储账号密码等信息。</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 存数据</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>saveForPreference <span class="token punctuation">{</span>

    <span class="token comment">// 获取偏好设置对象</span>
    <span class="token class-name">NSUserDefaults</span> <span class="token operator">*</span>defaults <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSUserDefaults</span> standardUserDefaults<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">//存储数据</span>
    <span class="token punctuation">[</span>defaults setObject<span class="token operator">:</span>@<span class="token string">&quot;mrgao&quot;</span> forKey<span class="token operator">:</span>@<span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>defaults setInteger<span class="token operator">:</span><span class="token number">24</span> forKey<span class="token operator">:</span>@<span class="token string">&quot;age&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// 同步调用，立刻写到文件中,不写这个方法会异步，有延迟</span>
    <span class="token punctuation">[</span>defaults synchronize<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//读数据</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>readForPreference <span class="token punctuation">{</span>

    <span class="token class-name">NSUserDefaults</span> <span class="token operator">*</span>defaults <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSUserDefaults</span> standardUserDefaults<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token class-name">NSString</span> <span class="token operator">*</span>name <span class="token operator">=</span> <span class="token punctuation">[</span>defaults objectForKey<span class="token operator">:</span>@<span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">NSInteger</span> <span class="token operator">*</span>age <span class="token operator">=</span> <span class="token punctuation">[</span>defaults integerForKey<span class="token operator">:</span>@<span class="token string">&quot;age&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;%@-------%ld&quot;</span><span class="token punctuation">,</span>name<span class="token punctuation">,</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>



</code></pre></div><p>举一个保存用户名和密码的例子:</p> <div class="language-java extra-class"><pre class="language-java"><code>
<span class="token comment">//</span>
<span class="token comment">//  ViewController.m</span>
<span class="token comment">//  NSBundle的使用</span>
#<span class="token keyword">import</span> <span class="token string">&quot;ViewController.h&quot;</span>

<span class="token annotation punctuation">@interface</span> <span class="token class-name">ViewController</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@property</span> <span class="token punctuation">(</span>weak<span class="token punctuation">,</span> nonatomic<span class="token punctuation">)</span> <span class="token class-name">IBOutlet</span> <span class="token class-name">UITextField</span> <span class="token operator">*</span>userName<span class="token punctuation">;</span>
<span class="token annotation punctuation">@property</span> <span class="token punctuation">(</span>weak<span class="token punctuation">,</span> nonatomic<span class="token punctuation">)</span> <span class="token class-name">IBOutlet</span> <span class="token class-name">UITextField</span> <span class="token operator">*</span>password<span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>savePassword<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender<span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>login<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender<span class="token punctuation">;</span>
<span class="token annotation punctuation">@property</span> <span class="token punctuation">(</span>weak<span class="token punctuation">,</span> nonatomic<span class="token punctuation">)</span> <span class="token class-name">IBOutlet</span> <span class="token class-name">UISwitch</span> <span class="token operator">*</span>remenber<span class="token punctuation">;</span>

<span class="token annotation punctuation">@end</span>

<span class="token annotation punctuation">@implementation</span> <span class="token class-name">ViewController</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>viewDidLoad <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token keyword">super</span> viewDidLoad<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">NSDictionary</span> <span class="token operator">*</span>info <span class="token operator">=</span> <span class="token punctuation">[</span>self readForPreference<span class="token punctuation">]</span><span class="token punctuation">;</span>
    self<span class="token punctuation">.</span>userName<span class="token punctuation">.</span>text <span class="token operator">=</span>info<span class="token punctuation">[</span>@<span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    self<span class="token punctuation">.</span>password<span class="token punctuation">.</span>text <span class="token operator">=</span>info<span class="token punctuation">[</span>@<span class="token string">&quot;pass&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//    字典类型，传递Bool类型的值，需要转换成 NSNumber; 获取值的时候，先要获取NSNumber，然后在获取对应的boolean的值</span>
    self<span class="token punctuation">.</span>remenber<span class="token punctuation">.</span>on <span class="token operator">=</span><span class="token punctuation">[</span>info<span class="token punctuation">[</span>@<span class="token string">&quot;isOn&quot;</span><span class="token punctuation">]</span> boolValue<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 存数据</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>saveForPreference <span class="token punctuation">{</span>

    <span class="token comment">// 获取偏好设置对象</span>
    <span class="token class-name">NSUserDefaults</span> <span class="token operator">*</span>defaults <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSUserDefaults</span> standardUserDefaults<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>username <span class="token operator">=</span> self<span class="token punctuation">.</span>userName<span class="token punctuation">.</span>text<span class="token punctuation">;</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>password <span class="token operator">=</span> self<span class="token punctuation">.</span>password<span class="token punctuation">.</span>text<span class="token punctuation">;</span>
    <span class="token comment">//存储数据</span>
    <span class="token punctuation">[</span>defaults setObject<span class="token operator">:</span>username  forKey<span class="token operator">:</span>@<span class="token string">&quot;username&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>defaults setObject<span class="token operator">:</span>password  forKey<span class="token operator">:</span>@<span class="token string">&quot;password&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//    [defaults setInteger:24 forKey:@&quot;age&quot;];</span>
    <span class="token comment">// 同步调用，立刻写到文件中,不写这个方法会异步，有延迟</span>
    <span class="token punctuation">[</span>defaults synchronize<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//读数据</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">NSDictionary</span> <span class="token operator">*</span><span class="token punctuation">)</span>readForPreference <span class="token punctuation">{</span>

    <span class="token class-name">NSUserDefaults</span> <span class="token operator">*</span>defaults <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSUserDefaults</span> standardUserDefaults<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token class-name">NSString</span> <span class="token operator">*</span>name <span class="token operator">=</span> <span class="token punctuation">[</span>defaults valueForKey<span class="token operator">:</span>@<span class="token string">&quot;username&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>pass <span class="token operator">=</span> <span class="token punctuation">[</span>defaults valueForKey<span class="token operator">:</span>@<span class="token string">&quot;password&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">Boolean</span> isOn <span class="token operator">=</span> <span class="token punctuation">[</span>defaults boolForKey<span class="token operator">:</span>@<span class="token string">&quot;isOn&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//    NSInteger *age = [defaults integerForKey:@&quot;age&quot;];</span>
    <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;%@-------%@&quot;</span><span class="token punctuation">,</span>name<span class="token punctuation">,</span>pass<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//    字典类型，传递Bool类型的值，需要转换成 NSNumber</span>
    <span class="token keyword">return</span> @<span class="token punctuation">{</span>@<span class="token string">&quot;name&quot;</span><span class="token operator">:</span>name<span class="token punctuation">,</span>@<span class="token string">&quot;pass&quot;</span><span class="token operator">:</span>pass<span class="token punctuation">,</span>@<span class="token string">&quot;isOn&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token class-name">NSNumber</span> numberWithBool<span class="token operator">:</span>isOn<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>savePassword<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender <span class="token punctuation">{</span>
    <span class="token class-name">UISwitch</span> <span class="token operator">*</span>swc <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UISwitch</span> <span class="token operator">*</span><span class="token punctuation">)</span>sender<span class="token punctuation">;</span>
    <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;%@&quot;</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>remenber<span class="token punctuation">.</span>isOn <span class="token operator">?</span> @<span class="token string">&quot;YES&quot;</span> <span class="token operator">:</span> @<span class="token string">&quot;NO&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">NSUserDefaults</span> <span class="token operator">*</span>defaults <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSUserDefaults</span> standardUserDefaults<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>defaults setBool<span class="token operator">:</span>self<span class="token punctuation">.</span>remenber<span class="token punctuation">.</span>isOn forKey<span class="token operator">:</span>@<span class="token string">&quot;isOn&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>defaults synchronize<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>login<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>self saveForPreference<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token annotation punctuation">@end</span>
</code></pre></div><p><strong>注意点</strong></p> <ul><li><p>NSDictionary 不能直接传播 Bool 类型的值，需要先将其转换成 NSNumber 然后读取的时候转换成 bool;</p></li> <li><p>NSLog 打印的时候不能直接打印 Bool 类型的值，建议使用这种方式展示: <code>NSLog(@&quot;%@&quot;, boolValue ? @&quot;YES&quot; : @&quot;NO&quot;);</code></p></li> <li><p>偏好设置存储 记得调用 <code>[defaults synchronize];</code> 存储</p></li></ul> <p><strong>那么我们使用 NSUserDefaults 保存的数据最终存放到哪里？</strong></p> <p>前面我们讲过沙盒里面有一个 Library-&gt;Preferences 是专门用来存放应用的所有偏好设置，比如账号，设置等,由系统自动管理。</p> <p>那我们一探究竟：
<img src="/assets/img/ns-default-save-path.39c94586.png" alt=""></p> <p><strong>结论: NSUserDefaults 的数据最终存放在沙盒下的 Library-&gt;Preferences 文件夹中，且类型为 plist 类型</strong></p> <h3 id="_2-使用-nsuserdefaults-制作新特性页面"><a href="#_2-使用-nsuserdefaults-制作新特性页面" aria-hidden="true" class="header-anchor">#</a> 2. 使用 NSUserDefaults 制作新特性页面</h3> <blockquote><p>所谓新特性页面，就是在一个 APP 的某一个版本下，按照的时候展示一次该特性页面；以后再次打开就不展示了。例如：王者荣耀新赛季更新的时候，开场赛季介绍动画播放，当此赛季我们再次打开的时候 就不会播放此动画了.</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>scene<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">UIScene</span> <span class="token operator">*</span><span class="token punctuation">)</span>scene willConnectToSession<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">UISceneSession</span> <span class="token operator">*</span><span class="token punctuation">)</span>session options<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">UISceneConnectionOptions</span> <span class="token operator">*</span><span class="token punctuation">)</span>connectionOptions <span class="token punctuation">{</span>
    <span class="token comment">// Override point for customization after application launch.</span>
    self<span class="token punctuation">.</span>window <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">UIWindow</span> alloc<span class="token punctuation">]</span> initWithWindowScene<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">UIWindowScene</span> <span class="token operator">*</span><span class="token punctuation">)</span>scene<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// 获取当前应用的版本</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>currentVersion <span class="token operator">=</span> <span class="token class-name">NSBundle</span><span class="token punctuation">.</span>mainBundle<span class="token punctuation">.</span>infoDictionary<span class="token punctuation">[</span>@<span class="token string">&quot;CFBundleShortVersionString&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// 获取到本地的版本</span>
    <span class="token class-name">NSUserDefaults</span> <span class="token operator">*</span>defaults <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSUserDefaults</span> standardUserDefaults<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>localVersion <span class="token operator">=</span> <span class="token punctuation">[</span>defaults valueForKey<span class="token operator">:</span>@<span class="token string">&quot;version&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//    如果版本更新了就显示新特性页面</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">[</span>currentVersion isEqualToString<span class="token operator">:</span>localVersion<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">UIViewController</span> <span class="token operator">*</span>newVC <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">UIViewController</span> alloc<span class="token punctuation">]</span> init<span class="token punctuation">]</span><span class="token punctuation">;</span>
        newVC<span class="token punctuation">.</span>view<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token class-name">UIColor</span><span class="token punctuation">.</span>greenColor<span class="token punctuation">;</span>
        self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>rootViewController<span class="token operator">=</span> newVC<span class="token punctuation">;</span>
        <span class="token comment">//  保存当前版本</span>
        <span class="token punctuation">[</span>defaults setObject<span class="token operator">:</span>currentVersion forKey<span class="token operator">:</span>@<span class="token string">&quot;version&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">[</span>defaults synchronize<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token class-name">UIViewController</span> <span class="token operator">*</span>normalVC <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">UIViewController</span> alloc<span class="token punctuation">]</span> init<span class="token punctuation">]</span><span class="token punctuation">;</span>
        normalVC<span class="token punctuation">.</span>view<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token class-name">UIColor</span><span class="token punctuation">.</span>redColor<span class="token punctuation">;</span>
        self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>rootViewController<span class="token operator">=</span> normalVC<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">[</span>self<span class="token punctuation">.</span>window makeKeyAndVisible<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="四、数据存取-归档-nskeyedarchiver"><a href="#四、数据存取-归档-nskeyedarchiver" aria-hidden="true" class="header-anchor">#</a> 四、数据存取: 归档-NSKeyedArchiver</h2> <blockquote><p>归档一般都是保存自定义对象的时候,使用归档.因为 plist 文件不能够保存自定义对象.如果一个字典当中保存有自定义对象,如果把这个字典写入到文件当中,它是不会生成 plist 文件的.</p></blockquote> <h3 id="_1-nskeyedarchiver-的基础使用"><a href="#_1-nskeyedarchiver-的基础使用" aria-hidden="true" class="header-anchor">#</a> 1. NSKeyedArchiver 的基础使用</h3> <blockquote><p>NSArray, NSString, NSInteger, NSDictionary 等 iOS 自带的数据类型，归档是原生支持的。</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code>
<span class="token annotation punctuation">@interface</span> <span class="token class-name">NSKeyedArchiverViewController</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>archive<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender<span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>unarchive<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender<span class="token punctuation">;</span>
<span class="token annotation punctuation">@property</span><span class="token punctuation">(</span>strong<span class="token punctuation">,</span>nonatomic<span class="token punctuation">)</span> <span class="token class-name">NSData</span> <span class="token operator">*</span>data<span class="token punctuation">;</span>
<span class="token annotation punctuation">@end</span>

<span class="token annotation punctuation">@implementation</span> <span class="token class-name">NSKeyedArchiverViewController</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>archive<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender <span class="token punctuation">{</span>
<span class="token comment">//    数据存储,此处案例是序列化一个数组</span>
    self<span class="token punctuation">.</span>data <span class="token operator">=</span><span class="token punctuation">[</span><span class="token class-name">NSKeyedArchiver</span> archivedDataWithRootObject<span class="token operator">:</span>@<span class="token punctuation">[</span>@<span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span>@<span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span>@<span class="token string">&quot;c&quot;</span><span class="token punctuation">]</span> requiringSecureCoding<span class="token operator">:</span>YES error<span class="token operator">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>unarchive<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender <span class="token punctuation">{</span>
<span class="token comment">//    数据读取，转换成数组</span>
  <span class="token class-name">NSArray</span> <span class="token operator">*</span>array<span class="token operator">=</span>  <span class="token punctuation">[</span><span class="token class-name">NSKeyedUnarchiver</span> unarchivedObjectOfClass<span class="token operator">:</span><span class="token class-name">NSArray</span><span class="token punctuation">.</span><span class="token keyword">class</span> fromData<span class="token operator">:</span>self<span class="token punctuation">.</span>data error<span class="token operator">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;%@&quot;</span><span class="token punctuation">,</span>array<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token annotation punctuation">@end</span>
</code></pre></div><h3 id="_1-nskeyedarchiver-自定义对象归档"><a href="#_1-nskeyedarchiver-自定义对象归档" aria-hidden="true" class="header-anchor">#</a> 1. NSKeyedArchiver 自定义对象归档</h3> <p>上面讲到 <code>NSArray</code>, <code>NSString</code>, <code>NSInteger</code>, <code>NSDictionary</code> 等 iOS 自带的数据类型，归档是原生支持的，但是如果是自定义对象，就和上面的方式有所不同。</p> <p>如果我们按照上面的方式去将自定义对象归档:</p> <div class="language-java extra-class"><pre class="language-java"><code> <span class="token class-name">NSError</span> <span class="token operator">*</span>error<span class="token punctuation">;</span>
    self<span class="token punctuation">.</span>userData<span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSKeyedArchiver</span> archivedDataWithRootObject<span class="token operator">:</span>user requiringSecureCoding<span class="token operator">:</span>YES error<span class="token operator">:</span><span class="token operator">&amp;</span>error<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token operator">!=</span>nil<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;%@&quot;</span><span class="token punctuation">,</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>肯定会报错:因为我们没有让自定义的对象去遵守 安全编码<code>NSSecureCoding</code> 协议</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">Domain</span><span class="token operator">=</span>NSCocoaErrorDomain <span class="token assign-left variable">Code</span><span class="token operator">=</span><span class="token number">4866</span> <span class="token string">&quot;The data couldn’t be written because it isn’t in the correct format.&quot;</span> <span class="token assign-left variable">UserInfo</span><span class="token operator">=</span><span class="token punctuation">{</span>NSUnderlyingError<span class="token operator">=</span>0x6000016d0210 <span class="token punctuation">{</span>Error <span class="token assign-left variable">Domain</span><span class="token operator">=</span>NSCocoaErrorDomain <span class="token assign-left variable">Code</span><span class="token operator">=</span><span class="token number">4864</span> <span class="token string">&quot;This decoder will only decode classes that adopt NSSecureCoding. Class 'User' does not adopt it.&quot;</span> <span class="token assign-left variable">UserInfo</span><span class="token operator">=</span><span class="token punctuation">{</span>NSDebugDescription<span class="token operator">=</span>This decoder will only decode classes that adopt NSSecureCoding. Class <span class="token string">'User'</span> does not adopt it.<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre></div><p>所以，我们自定义对象归档有如下几个步骤：</p> <ul><li><ol><li><strong>让自定义对象实现<code>NSSecureCoding</code>协议</strong>;</li></ol></li> <li><ol start="2"><li><strong>至少实现<code>NSSecureCoding</code>协议中的三个方法</strong>;</li></ol> <ul><li><code>encodeWithCoder</code></li> <li><code>initWithCoder</code></li> <li><code>supportsSecureCoding</code></li></ul></li></ul> <p>之前使用的数组其实是已经帮我们实现了<code>encodeWithCoder</code>和<code>initWithCoder</code>；那么我们如何编写？</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// User.h 实现NSSecureCoding协议</span>
#<span class="token keyword">import</span> <span class="token operator">&lt;</span><span class="token class-name">Foundation</span><span class="token operator">/</span><span class="token class-name">Foundation</span><span class="token punctuation">.</span>h<span class="token operator">&gt;</span>

NS_ASSUME_NONNULL_BEGIN

<span class="token annotation punctuation">@interface</span> <span class="token class-name">User</span> <span class="token operator">:</span> <span class="token class-name">NSObject</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">NSSecureCoding</span><span class="token punctuation">&gt;</span></span>
<span class="token annotation punctuation">@property</span><span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span>copy<span class="token punctuation">)</span> <span class="token class-name">NSString</span> <span class="token operator">*</span>userName<span class="token punctuation">;</span>
<span class="token annotation punctuation">@property</span><span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span>assign<span class="token punctuation">)</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>
<span class="token annotation punctuation">@end</span>

NS_ASSUME_NONNULL_END

</code></pre></div><p>在 User.m 去实现协议的几个方法</p> <div class="language-java extra-class"><pre class="language-java"><code>#<span class="token keyword">import</span> <span class="token string">&quot;User.h&quot;</span>

<span class="token annotation punctuation">@implementation</span> <span class="token class-name">User</span>
<span class="token comment">// 编码，将对象写入流中</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>encodeWithCoder<span class="token operator">:</span><span class="token punctuation">(</span>nonnull <span class="token class-name">NSCoder</span> <span class="token operator">*</span><span class="token punctuation">)</span>coder <span class="token punctuation">{</span>
    <span class="token comment">// 要记得将所有的对象都序列化</span>
    <span class="token punctuation">[</span>coder encodeObject<span class="token operator">:</span>self<span class="token punctuation">.</span>userName forKey<span class="token operator">:</span>@<span class="token string">&quot;userName&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>coder encodeInt<span class="token operator">:</span>self<span class="token punctuation">.</span>age forKey<span class="token operator">:</span>@<span class="token string">&quot;age&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
<span class="token comment">// 解码，将流初始化为对象</span>
<span class="token operator">-</span> <span class="token punctuation">(</span>nullable instancetype<span class="token punctuation">)</span>initWithCoder<span class="token operator">:</span><span class="token punctuation">(</span>nonnull <span class="token class-name">NSCoder</span> <span class="token operator">*</span><span class="token punctuation">)</span>coder <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>self <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">super</span> init<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        self<span class="token punctuation">.</span>userName <span class="token operator">=</span> <span class="token punctuation">[</span>coder decodeObjectForKey<span class="token operator">:</span>@<span class="token string">&quot;userName&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        self<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token punctuation">[</span>coder decodeIntForKey<span class="token operator">:</span>@<span class="token string">&quot;age&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> self<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 是否支持安全编码</span>
<span class="token operator">+</span> <span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>supportsSecureCoding<span class="token punctuation">{</span>
    <span class="token keyword">return</span> YES<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@end</span>

</code></pre></div><p>自定义对象 User 的归档和解档:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>archive<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender <span class="token punctuation">{</span>
    <span class="token comment">//    自定义对象需要存储在沙盒中</span>
    <span class="token class-name">User</span> <span class="token operator">*</span>user <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">User</span> alloc<span class="token punctuation">]</span> init<span class="token punctuation">]</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span>userName<span class="token operator">=</span>@<span class="token string">&quot;mrgaogang&quot;</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span>age<span class="token operator">=</span><span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token class-name">NSError</span> <span class="token operator">*</span>error<span class="token punctuation">;</span>
    self<span class="token punctuation">.</span>userData<span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSKeyedArchiver</span> archivedDataWithRootObject<span class="token operator">:</span>user requiringSecureCoding<span class="token operator">:</span>YES error<span class="token operator">:</span><span class="token operator">&amp;</span>error<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token operator">!=</span>nil<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;%@&quot;</span><span class="token punctuation">,</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 我们也可以将归档的数据存放在沙盒中</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>filePath <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSTemporaryDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> stringByAppendingPathComponent<span class="token operator">:</span>@<span class="token string">&quot;User.data&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>self<span class="token punctuation">.</span>userData writeToFile<span class="token operator">:</span>filePath atomically<span class="token operator">:</span>YES<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>unarchive<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender <span class="token punctuation">{</span>
    <span class="token comment">//    从沙盒中取出我们归档的数据</span>
    <span class="token class-name">NSData</span> <span class="token operator">*</span>data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSData</span> dataWithContentsOfFile<span class="token operator">:</span><span class="token punctuation">[</span><span class="token class-name">NSTemporaryDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> stringByAppendingPathComponent<span class="token operator">:</span>@<span class="token string">&quot;User.data&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token class-name">User</span> <span class="token operator">*</span>user<span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSKeyedUnarchiver</span> unarchivedObjectOfClass<span class="token operator">:</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span> fromData<span class="token operator">:</span>data error<span class="token operator">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;userName = %@ , age = %d&quot;</span><span class="token punctuation">,</span>user<span class="token punctuation">.</span>userName<span class="token punctuation">,</span>user<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 打印情况</span>
userName <span class="token operator">=</span> mrgaogang , age <span class="token operator">=</span> <span class="token number">123</span>
</code></pre></div><p><img src="/assets/img/archive-user.bd00de1d.png" alt=""></p> <h2 id="五、数据存取-数据库-sqlite3"><a href="#五、数据存取-数据库-sqlite3" aria-hidden="true" class="header-anchor">#</a> 五、数据存取: 数据库-sqlite3</h2> <h3 id="_1-sqlite-简单介绍"><a href="#_1-sqlite-简单介绍" aria-hidden="true" class="header-anchor">#</a> 1. sqlite 简单介绍</h3> <blockquote><p>SQLite，是一款轻型的数据库，是遵守 ACID 的关系型数据库管理系统，它包含在一个相对小的 C 库中. sqlite 是嵌入式的，占用内存小，且支持 windows,linux,unix 操作系统，所以当前的 android/ios 都是支持的</p></blockquote> <p><strong>sqlite 支持的数据类型</strong>:</p> <ul><li>NULL : NULL 值</li> <li>INTEGER: 整形值</li> <li>REAL: 浮点值</li> <li>TEXT: 文本字符串，存储时使用编码方式为 utf-8 或者 utf-16</li> <li>BLOB: 二进制文件存储</li></ul> <p><strong>sqlite 常用函数</strong>:</p> <ul><li>sqlite3_open: 开数据库</li> <li>sqlite3_close: 关数据库</li> <li>sqlite3_exec: 执行函数</li> <li>sqlite3_prepare_v2: 查询时使用的，执行得到结果集</li> <li>sqlite3_step : 查询时使用的，遍历结果集</li> <li>sqlite3_column_text: 查询时使用，获取对应 column 的值</li></ul> <h3 id="_2-sqlite3-基础使用-工程搭建及自定义-model"><a href="#_2-sqlite3-基础使用-工程搭建及自定义-model" aria-hidden="true" class="header-anchor">#</a> 2. sqlite3 基础使用-工程搭建及自定义 Model</h3> <h4 id="_1-引入-sqlite3-包"><a href="#_1-引入-sqlite3-包" aria-hidden="true" class="header-anchor">#</a> (1) 引入 sqlite3 包</h4> <p>由于 sqlite3 并非 ios 自带的，所以我们需要额外的引入：</p> <p><img src="/assets/img/sqlite-pre.0f8ac39b.png" alt=""></p> <h4 id="_2-自定义-model"><a href="#_2-自定义-model" aria-hidden="true" class="header-anchor">#</a> (2) 自定义 Model</h4> <p>由于操作数据库，对应的映射肯定是一个对象，那么我们首先将 Model 构造出来:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//</span>
<span class="token comment">//  Person.h</span>
<span class="token comment">//  SQLite数据库操作</span>
#<span class="token keyword">import</span> <span class="token operator">&lt;</span><span class="token class-name">Foundation</span><span class="token operator">/</span><span class="token class-name">Foundation</span><span class="token punctuation">.</span>h<span class="token operator">&gt;</span>

NS_ASSUME_NONNULL_BEGIN

<span class="token annotation punctuation">@interface</span> <span class="token class-name">Person</span> <span class="token operator">:</span> <span class="token class-name">NSObject</span>
<span class="token annotation punctuation">@property</span><span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span>copy<span class="token punctuation">)</span> <span class="token class-name">NSString</span> <span class="token operator">*</span>name<span class="token punctuation">;</span>
<span class="token annotation punctuation">@property</span><span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span>copy<span class="token punctuation">)</span> <span class="token class-name">NSString</span> <span class="token operator">*</span>phone<span class="token punctuation">;</span>
<span class="token annotation punctuation">@property</span><span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span>copy<span class="token punctuation">)</span> <span class="token class-name">NSString</span> <span class="token operator">*</span>address<span class="token punctuation">;</span>

<span class="token operator">-</span> <span class="token punctuation">(</span>instancetype<span class="token punctuation">)</span> initWithName<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span> name andPhone<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span> phone andAddress<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span> address<span class="token punctuation">;</span>
<span class="token annotation punctuation">@end</span>

NS_ASSUME_NONNULL_END

</code></pre></div><p>并实现对应的构造函数</p> <div class="language-java extra-class"><pre class="language-java"><code>
<span class="token comment">//</span>
<span class="token comment">//  Person.m</span>
<span class="token comment">//  SQLite数据库操作</span>
#<span class="token keyword">import</span> <span class="token string">&quot;Person.h&quot;</span>

<span class="token annotation punctuation">@implementation</span> <span class="token class-name">Person</span>
<span class="token operator">-</span> <span class="token punctuation">(</span>instancetype<span class="token punctuation">)</span>initWithName<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span>name andPhone<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span>phone andAddress<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span>address<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>self <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">super</span> init<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        self<span class="token punctuation">.</span>name<span class="token operator">=</span> name<span class="token punctuation">;</span>
        self<span class="token punctuation">.</span>phone<span class="token operator">=</span>phone<span class="token punctuation">;</span>
        self<span class="token punctuation">.</span>address<span class="token operator">=</span>address<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> self<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span>description
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token class-name">NSString</span> stringWithFormat<span class="token operator">:</span>@<span class="token string">&quot;name = %@ , phone = %@, address = %@&quot;</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>name<span class="token punctuation">,</span>self<span class="token punctuation">.</span>phone<span class="token punctuation">,</span>self<span class="token punctuation">.</span>address<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token annotation punctuation">@end</span>
</code></pre></div><h3 id="_3-sqlite-操作工具类-增删改查"><a href="#_3-sqlite-操作工具类-增删改查" aria-hidden="true" class="header-anchor">#</a> 3. sqlite 操作工具类(增删改查)</h3> <p>由于对数据库的操作是独立的，我们不应该将其放在 UI/Controller 中，而应该将数据库的操作单独放在一个文件中进行；以便于后续的维护和程序的开发。</p> <h4 id="_1-对外声明-sql-操作方法"><a href="#_1-对外声明-sql-操作方法" aria-hidden="true" class="header-anchor">#</a> (1) 对外声明 sql 操作方法</h4> <p>此处主要演示对数据库的六种操作：</p> <ul><li>数据库的创建</li> <li>表格的创建</li> <li>数据的添加</li> <li>数据的删除</li> <li>数据的更新</li> <li>数据的查询</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//</span>
<span class="token comment">//  DBTools.h</span>
<span class="token comment">//  SQLite数据库操作</span>

#<span class="token keyword">import</span> <span class="token operator">&lt;</span><span class="token class-name">Foundation</span><span class="token operator">/</span><span class="token class-name">Foundation</span><span class="token punctuation">.</span>h<span class="token operator">&gt;</span>
#<span class="token keyword">import</span> <span class="token string">&quot;Person.h&quot;</span>
NS_ASSUME_NONNULL_BEGIN

<span class="token annotation punctuation">@interface</span> <span class="token class-name">DBTools</span> <span class="token operator">:</span> <span class="token class-name">NSObject</span>
<span class="token comment">// 创建db</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> createDB<span class="token punctuation">;</span>
<span class="token comment">// 创建表</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> createTable<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span> tableName<span class="token punctuation">;</span>
<span class="token comment">// 插入数据</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> insertPerson<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">Person</span> <span class="token operator">*</span><span class="token punctuation">)</span> person<span class="token punctuation">;</span>
<span class="token comment">// 条件删除</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> deletePerson<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span> personName<span class="token punctuation">;</span>
<span class="token comment">// 更新数据</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> updatePerson<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">Person</span> <span class="token operator">*</span><span class="token punctuation">)</span> person<span class="token punctuation">;</span>
<span class="token comment">// 查询所有数据</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">NSArray</span><span class="token operator">&lt;</span><span class="token class-name">Person</span> <span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token operator">*</span><span class="token punctuation">)</span> queryPerson<span class="token punctuation">;</span>
<span class="token comment">// 通过条件查询</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">NSArray</span><span class="token operator">&lt;</span><span class="token class-name">Person</span> <span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token operator">*</span><span class="token punctuation">)</span> queryPersonByName<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span> personName<span class="token punctuation">;</span>
<span class="token comment">//  数据库的名字</span>
<span class="token annotation punctuation">@property</span><span class="token punctuation">(</span>nonnull<span class="token punctuation">,</span>copy<span class="token punctuation">)</span> <span class="token class-name">NSString</span> <span class="token operator">*</span>dbName<span class="token punctuation">;</span>

<span class="token annotation punctuation">@end</span>

NS_ASSUME_NONNULL_END

</code></pre></div><h4 id="_2-数据库的增删改查"><a href="#_2-数据库的增删改查" aria-hidden="true" class="header-anchor">#</a> (2) 数据库的增删改查</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//</span>
<span class="token comment">//  DBTools.m</span>
<span class="token comment">//  SQLite数据库操作</span>

#<span class="token keyword">import</span> <span class="token string">&quot;DBTools.h&quot;</span>
#<span class="token keyword">import</span> <span class="token string">&quot;Person.h&quot;</span>
#<span class="token keyword">import</span> <span class="token string">&quot;sqlite3.h&quot;</span>

<span class="token annotation punctuation">@interface</span> <span class="token class-name">DBTools</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    sqlite3 <span class="token operator">*</span>sqlite<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@end</span>
<span class="token annotation punctuation">@implementation</span> <span class="token class-name">DBTools</span>


<span class="token comment">// 创建数据库，存放在沙盒中</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>createDB<span class="token punctuation">{</span>
    <span class="token comment">//    1. 查找沙盒</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>docPath<span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSSearchPathForDirectoriesInDomains</span><span class="token punctuation">(</span><span class="token class-name">NSDocumentDirectory</span><span class="token punctuation">,</span> <span class="token class-name">NSUserDomainMask</span><span class="token punctuation">,</span> YES<span class="token punctuation">)</span> firstObject<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//    2. 拼接数据库</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>dbPath <span class="token operator">=</span> <span class="token punctuation">[</span>docPath stringByAppendingPathComponent<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token class-name">NSString</span> stringWithFormat<span class="token operator">:</span>@<span class="token string">&quot;%@.db&quot;</span><span class="token punctuation">,</span>self<span class="token punctuation">.</span>dbName<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;%@&quot;</span><span class="token punctuation">,</span>dbPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//    3. 创建数据库，需要传递2个参数，1: 数据库名称(c语言的字符串), 2: 数据库的句柄，后续我们需要使用句柄进行数据库的操作</span>
    <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token function">sqlite3_open</span><span class="token punctuation">(</span><span class="token punctuation">[</span>dbPath <span class="token class-name">UTF8String</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>sqlite<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>result <span class="token operator">==</span> SQLITE_OK<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;数据库创建成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;数据库创建失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 数据库的关闭</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> closeDB<span class="token punctuation">{</span>
    <span class="token function">sqlite3_close</span><span class="token punctuation">(</span>sqlite<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 针对创建表格，增加，删除都可以统一使用执行 sqlite3_exec</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> execSQL<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span> sql<span class="token punctuation">{</span>
    <span class="token comment">//    1. 执行之前需要打开数据库</span>
    <span class="token punctuation">[</span>self createDB<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//    2. 创建sql语句</span>
    <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;%@&quot;</span><span class="token punctuation">,</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>error<span class="token punctuation">;</span>
    <span class="token comment">//    3. 执行sql语句</span>
    <span class="token keyword">int</span> result<span class="token operator">=</span> <span class="token function">sqlite3_exec</span><span class="token punctuation">(</span>sqlite<span class="token punctuation">,</span> <span class="token punctuation">[</span>sql <span class="token class-name">UTF8String</span><span class="token punctuation">]</span><span class="token punctuation">,</span> NULL<span class="token punctuation">,</span> NULL<span class="token punctuation">,</span> <span class="token operator">&amp;</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>result <span class="token operator">==</span> SQLITE_OK<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;sql执行成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;sql执行失败, %s&quot;</span> <span class="token punctuation">,</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//    4. 一定要记得关闭数据库</span>
    <span class="token punctuation">[</span>self closeDB<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 执行创建表格的sql语句</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>createTable<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span>tableName<span class="token punctuation">{</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>sql <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSString</span> stringWithFormat<span class="token operator">:</span> @<span class="token string">&quot;create table %@(id integer primary key autoincrement, name text , phone text ,address text)&quot;</span><span class="token punctuation">,</span>tableName<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>self execSQL<span class="token operator">:</span> sql<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 执行插入的sql语句</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>insertPerson<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">Person</span> <span class="token operator">*</span><span class="token punctuation">)</span>person<span class="token punctuation">{</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>sql <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSString</span> stringWithFormat<span class="token operator">:</span> @<span class="token string">&quot;insert into person (name , phone ,address) values ('%@','%@','%@')&quot;</span><span class="token punctuation">,</span>person<span class="token punctuation">.</span>name<span class="token punctuation">,</span>person<span class="token punctuation">.</span>phone<span class="token punctuation">,</span>person<span class="token punctuation">.</span>address<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>self execSQL<span class="token operator">:</span> sql<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 执行删除的sql语句</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>deletePerson<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span>personName<span class="token punctuation">{</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>sql <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSString</span> stringWithFormat<span class="token operator">:</span> @<span class="token string">&quot;delete from person where name='%@'&quot;</span><span class="token punctuation">,</span>personName<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>self execSQL<span class="token operator">:</span> sql<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 执行更新的sql语句</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>updatePerson<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">Person</span> <span class="token operator">*</span><span class="token punctuation">)</span>person<span class="token punctuation">{</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>sql <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSString</span> stringWithFormat<span class="token operator">:</span> @<span class="token string">&quot;update person set phone='%@' ,address='%@' where name='%@'&quot;</span><span class="token punctuation">,</span>person<span class="token punctuation">.</span>phone<span class="token punctuation">,</span>person<span class="token punctuation">.</span>address<span class="token punctuation">,</span>person<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>self execSQL<span class="token operator">:</span>sql<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 查询全部</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">NSArray</span><span class="token operator">&lt;</span><span class="token class-name">Person</span> <span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token operator">*</span><span class="token punctuation">)</span>queryPerson<span class="token punctuation">{</span>
    <span class="token punctuation">[</span>self createDB<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>sql <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSString</span> stringWithFormat<span class="token operator">:</span> @<span class="token string">&quot;select name,phone,address from person&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    sqlite3_stmt <span class="token operator">*</span>stmt<span class="token punctuation">;</span>
    <span class="token comment">// 使用sqlite3_prepare_v2查询数据</span>
    <span class="token keyword">int</span> result<span class="token operator">=</span> <span class="token function">sqlite3_prepare_v2</span><span class="token punctuation">(</span>sqlite<span class="token punctuation">,</span> <span class="token punctuation">[</span>sql <span class="token class-name">UTF8String</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>stmt<span class="token punctuation">,</span> NULL<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">NSMutableArray</span> <span class="token operator">*</span>array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSMutableArray</span> array<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>result <span class="token operator">==</span> SQLITE_OK<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//   遍历结果集</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">sqlite3_step</span><span class="token punctuation">(</span>stmt<span class="token punctuation">)</span> <span class="token operator">==</span> SQLITE_ROW<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 参数为结果集和查询结果集的第几列；且返回的结果为c语言的string</span>
            <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>cName<span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">sqlite3_column_text</span><span class="token punctuation">(</span>stmt<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>cPhone<span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">sqlite3_column_text</span><span class="token punctuation">(</span>stmt<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>cAddress<span class="token operator">=</span>   <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">sqlite3_column_text</span><span class="token punctuation">(</span>stmt<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 要记得将c语言的string 改成NSString</span>
            <span class="token class-name">Person</span> <span class="token operator">*</span>person <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">Person</span> alloc<span class="token punctuation">]</span> initWithName<span class="token operator">:</span><span class="token punctuation">[</span><span class="token class-name">NSString</span> stringWithUTF8String<span class="token operator">:</span>cName<span class="token punctuation">]</span> andPhone<span class="token operator">:</span><span class="token punctuation">[</span><span class="token class-name">NSString</span> stringWithUTF8String<span class="token operator">:</span>cPhone<span class="token punctuation">]</span> andAddress<span class="token operator">:</span><span class="token punctuation">[</span><span class="token class-name">NSString</span> stringWithUTF8String<span class="token operator">:</span>cAddress<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">[</span>array addObject<span class="token operator">:</span>person<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;查询失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">[</span>self closeDB<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> array<span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token comment">//  条件查询</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">NSArray</span><span class="token operator">&lt;</span><span class="token class-name">Person</span> <span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token operator">*</span><span class="token punctuation">)</span>queryPersonByName<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span>personName<span class="token punctuation">{</span>
    <span class="token punctuation">[</span>self createDB<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>sql <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSString</span> stringWithFormat<span class="token operator">:</span> @<span class="token string">&quot;select * from person where name = '%@'&quot;</span><span class="token punctuation">,</span>personName<span class="token punctuation">]</span><span class="token punctuation">;</span>

    sqlite3_stmt <span class="token operator">*</span>stmt<span class="token punctuation">;</span>
    <span class="token comment">// 使用sqlite3_prepare_v2查询数据</span>
    <span class="token keyword">int</span> result<span class="token operator">=</span> <span class="token function">sqlite3_prepare_v2</span><span class="token punctuation">(</span>sqlite<span class="token punctuation">,</span> <span class="token punctuation">[</span>sql <span class="token class-name">UTF8String</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>stmt<span class="token punctuation">,</span> NULL<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">NSMutableArray</span> <span class="token operator">*</span>array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSMutableArray</span> array<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>result <span class="token operator">==</span> SQLITE_OK<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//   遍历结果集</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">sqlite3_step</span><span class="token punctuation">(</span>stmt<span class="token punctuation">)</span> <span class="token operator">==</span> SQLITE_ROW<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 参数为结果集和查询结果集的第几列；且返回的结果为c语言的string</span>
            <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>cPhone<span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">sqlite3_column_text</span><span class="token punctuation">(</span>stmt<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>cAddress<span class="token operator">=</span>   <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">sqlite3_column_text</span><span class="token punctuation">(</span>stmt<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 要记得将c语言的string 改成NSString</span>
            <span class="token class-name">Person</span> <span class="token operator">*</span>person <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">Person</span> alloc<span class="token punctuation">]</span> initWithName<span class="token operator">:</span>personName andPhone<span class="token operator">:</span><span class="token punctuation">[</span><span class="token class-name">NSString</span> stringWithUTF8String<span class="token operator">:</span>cPhone<span class="token punctuation">]</span> andAddress<span class="token operator">:</span><span class="token punctuation">[</span><span class="token class-name">NSString</span> stringWithUTF8String<span class="token operator">:</span>cAddress<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">[</span>array addObject<span class="token operator">:</span>person<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;查询失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">[</span>self closeDB<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> array<span class="token punctuation">;</span>


<span class="token punctuation">}</span>

<span class="token annotation punctuation">@end</span>

</code></pre></div><h4 id="_3-调用增删改查"><a href="#_3-调用增删改查" aria-hidden="true" class="header-anchor">#</a> (3) 调用增删改查</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//</span>
<span class="token comment">//  ViewController.m</span>
<span class="token comment">//  SQLite数据库操作</span>

#<span class="token keyword">import</span> <span class="token string">&quot;ViewController.h&quot;</span>
#<span class="token keyword">import</span> <span class="token string">&quot;DBTools.h&quot;</span>
<span class="token annotation punctuation">@interface</span> <span class="token class-name">ViewController</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>createDB<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender<span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>createTable<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender<span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>insert<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender<span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>deleteData<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender<span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>updateData<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender<span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>queryData<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender<span class="token punctuation">;</span>
<span class="token annotation punctuation">@property</span><span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span>strong<span class="token punctuation">)</span> <span class="token class-name">DBTools</span> <span class="token operator">*</span>dbTools<span class="token punctuation">;</span>
<span class="token annotation punctuation">@end</span>

<span class="token annotation punctuation">@implementation</span> <span class="token class-name">ViewController</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>viewDidLoad <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token keyword">super</span> viewDidLoad<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// Do any additional setup after loading the view.</span>
    self<span class="token punctuation">.</span>dbTools <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">DBTools</span> alloc<span class="token punctuation">]</span> init<span class="token punctuation">]</span><span class="token punctuation">;</span>
    self<span class="token punctuation">.</span>dbTools<span class="token punctuation">.</span>dbName <span class="token operator">=</span> @<span class="token string">&quot;person&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 创建数据库</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>createDB<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>self<span class="token punctuation">.</span>dbTools createDB<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 创建表格</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>createTable<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>self<span class="token punctuation">.</span>dbTools createTable<span class="token operator">:</span>@<span class="token string">&quot;person&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 插入数据</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>insert<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender <span class="token punctuation">{</span>
    <span class="token class-name">Person</span> <span class="token operator">*</span>person <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">Person</span> alloc<span class="token punctuation">]</span> initWithName<span class="token operator">:</span>@<span class="token string">&quot;mrgaogang&quot;</span> andPhone<span class="token operator">:</span>@<span class="token string">&quot;12345678900&quot;</span> andAddress<span class="token operator">:</span>@<span class="token string">&quot;中国-广东深圳&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>self<span class="token punctuation">.</span>dbTools insertPerson<span class="token operator">:</span>person<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 删除数据</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>deleteData<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>self<span class="token punctuation">.</span>dbTools deletePerson<span class="token operator">:</span> @<span class="token string">&quot;mrgaogang&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 更新数据</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>updateData<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender <span class="token punctuation">{</span>
    <span class="token class-name">NSArray</span> <span class="token operator">*</span>array <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>dbTools queryPersonByName<span class="token operator">:</span>@<span class="token string">&quot;mrgaogang&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>array<span class="token punctuation">.</span>count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Person</span> <span class="token operator">*</span>person <span class="token operator">=</span> <span class="token punctuation">[</span>array firstObject<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">[</span>self<span class="token punctuation">.</span>dbTools updatePerson<span class="token operator">:</span>person <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 查询数据</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">IBAction</span><span class="token punctuation">)</span>queryData<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender <span class="token punctuation">{</span>
    <span class="token class-name">NSArray</span> <span class="token operator">*</span>array <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>dbTools queryPersonByName<span class="token operator">:</span>@<span class="token string">&quot;mrgaogang&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>array<span class="token punctuation">.</span>count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Person</span> <span class="token operator">*</span>p in array<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;%@&quot;</span><span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
<span class="token annotation punctuation">@end</span>


</code></pre></div><h2 id="六、-fmdb-的使用"><a href="#六、-fmdb-的使用" aria-hidden="true" class="header-anchor">#</a> 六、 FMDB 的使用</h2> <p><strong>FMDB 是什么？</strong></p> <ul><li>FMDB 是 iOS 平台的 SQLite 数据库框架</li> <li>FMDB 以 OC 的方式封装了 SQLite 的 C 语言 API</li></ul> <p><strong>FMDB 的优点</strong></p> <ul><li>使用起来更加面向对象，省去了很多麻烦、冗余的 C 语言代码</li> <li>对比苹果自带的 Core Data 框架，更加轻量级和灵活</li> <li>提供了多线程安全的数据库操作方法，有效地防止数据混乱</li></ul> <h3 id="_1-fmdb-的安装"><a href="#_1-fmdb-的安装" aria-hidden="true" class="header-anchor">#</a> 1. FMDB 的安装</h3> <p>此处使用 cocospods 的方式安装，当然你也可以将源代码下面的 fmdb 拷贝下来，放在工程内部。如果不知道如何使用 cocospods的同学可以参考<a href="https://juejin.im/entry/5c067eb56fb9a04a0a5ef583" target="_blank" rel="noopener noreferrer">此文章:cocospods的使用<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-bash extra-class"><pre class="language-bash"><code>pod init
</code></pre></div><p>然后编辑<code>Podfile</code>并新增 <code>FMDB</code>:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>
<span class="token comment"># Uncomment the next line to define a global platform for your project</span>
<span class="token comment"># platform :ios, '9.0'</span>

target <span class="token string">'FMDB的使用'</span> <span class="token keyword">do</span>
    <span class="token comment"># Comment the next line if you're not using Swift and don't want to use dynamic frameworks</span>
    use_frameworks<span class="token operator">!</span>

    <span class="token comment"># Pods for MyApp2</span>

    pod <span class="token string">'FMDB'</span>
    <span class="token comment"># pod 'FMDB/FTS'   # FMDB with FTS</span>
    <span class="token comment"># pod 'FMDB/standalone'   # FMDB with latest SQLite amalgamation source</span>
    <span class="token comment"># pod 'FMDB/standalone/FTS'   # FMDB with latest SQLite amalgamation source and FTS</span>
    <span class="token comment"># pod 'FMDB/SQLCipher'   # FMDB with SQLCipher</span>
end

</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code>pod <span class="token function">install</span>

</code></pre></div><p>安装之后打开: <strong>FMDB的使用.xcworkspace</strong> 记住 是 : <code>FMDB的使用.xcworkspace</code>而不是 <code>FMDB的使用.xcodeproj</code>.</p> <p>如果编译有如下报错</p> <p><img src="/assets/img/fmdb_install.812882d5.png" alt=""></p> <p><strong>解决办法：删除Pods.frameworks,剩余有Pods_.framework</strong> <img src="/assets/img/fmdb-lib.354b73b4.png" alt=""></p> <h3 id="_2-model的建立"><a href="#_2-model的建立" aria-hidden="true" class="header-anchor">#</a> 2. Model的建立</h3> <p>Model和之前的Person几乎类似。
<strong>声明Model的属性及构造函数</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//</span>
<span class="token comment">//  Student.h</span>
<span class="token comment">//  FMDB的使用</span>
#<span class="token keyword">import</span> <span class="token operator">&lt;</span><span class="token class-name">Foundation</span><span class="token operator">/</span><span class="token class-name">Foundation</span><span class="token punctuation">.</span>h<span class="token operator">&gt;</span>

NS_ASSUME_NONNULL_BEGIN

<span class="token annotation punctuation">@interface</span> <span class="token class-name">Student</span> <span class="token operator">:</span> <span class="token class-name">NSObject</span>

<span class="token annotation punctuation">@property</span><span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span>copy<span class="token punctuation">)</span> <span class="token class-name">NSString</span> <span class="token operator">*</span>name<span class="token punctuation">;</span>
<span class="token annotation punctuation">@property</span><span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span>assign<span class="token punctuation">)</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>
<span class="token annotation punctuation">@property</span> <span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span>copy<span class="token punctuation">)</span> <span class="token class-name">NSString</span> <span class="token operator">*</span>sex<span class="token punctuation">;</span>

<span class="token operator">-</span> <span class="token punctuation">(</span>instancetype<span class="token punctuation">)</span>initWithName<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span> name andAge<span class="token operator">:</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> age andSex<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span> sex<span class="token punctuation">;</span>

<span class="token annotation punctuation">@end</span>

NS_ASSUME_NONNULL_END
</code></pre></div><p><strong>实现Model的构造函数和description方法</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//</span>
<span class="token comment">//  Student.h</span>
<span class="token comment">//  FMDB的使用</span>

#<span class="token keyword">import</span> <span class="token operator">&lt;</span><span class="token class-name">Foundation</span><span class="token operator">/</span><span class="token class-name">Foundation</span><span class="token punctuation">.</span>h<span class="token operator">&gt;</span>

NS_ASSUME_NONNULL_BEGIN

<span class="token annotation punctuation">@interface</span> <span class="token class-name">Student</span> <span class="token operator">:</span> <span class="token class-name">NSObject</span>

<span class="token annotation punctuation">@property</span><span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span>copy<span class="token punctuation">)</span> <span class="token class-name">NSString</span> <span class="token operator">*</span>name<span class="token punctuation">;</span>
<span class="token annotation punctuation">@property</span><span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span>assign<span class="token punctuation">)</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>
<span class="token annotation punctuation">@property</span> <span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span>copy<span class="token punctuation">)</span> <span class="token class-name">NSString</span> <span class="token operator">*</span>sex<span class="token punctuation">;</span>

<span class="token operator">-</span> <span class="token punctuation">(</span>instancetype<span class="token punctuation">)</span>initWithName<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span> name andAge<span class="token operator">:</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> age andSex<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span> sex<span class="token punctuation">;</span>

<span class="token annotation punctuation">@end</span>

NS_ASSUME_NONNULL_END


</code></pre></div><h3 id="_3-数据库的增删改查"><a href="#_3-数据库的增删改查" aria-hidden="true" class="header-anchor">#</a> 3. 数据库的增删改查</h3> <p>其实整体的流程和纯操作sqlite3是类似的，主要有如下几个变化：</p> <ul><li><p><strong>创建库成功之后使用<code>FMDatabase</code>存储</strong></p></li> <li><p><strong>不再直接操作sqlite3_exec而是使用<code>executeUpdate</code>执行增加，删除和修改；</strong></p></li> <li><p><strong>使用<code>executeUpdate</code>的时候，不再使用字符串拼接的方式，而是使用占位符<code>?</code>，且<code>executeUpdate</code>第一个参数为sql，后面为可变参数，参数的个数和<code>?</code>的个数一致;</strong></p></li> <li><p><strong>使用<code>executeUpdate</code>的时候，注意传入的都必须是对象，对于int等基础类型，需要使用<code>@()</code>包裹传递参数。</strong></p></li> <li><p><strong>查询操作直接使用<code>executeQuery</code>,且使用更加直观的<code>FMResultSet</code>存储结果集</strong></p></li> <li><p><strong>从结果集中获取数据也使用更加直观的:<code>stringForColumn</code> ,   <code>intForColumn</code>等 获取</strong></p></li></ul> <div class="language-java extra-class"><pre class="language-java"><code>
#<span class="token keyword">import</span> <span class="token string">&quot;DBTools.h&quot;</span>
#<span class="token keyword">import</span> <span class="token string">&quot;FMDB.h&quot;</span>

<span class="token annotation punctuation">@interface</span> <span class="token class-name">DBTools</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token annotation punctuation">@property</span> <span class="token punctuation">(</span>strong<span class="token punctuation">,</span>nonatomic<span class="token punctuation">)</span> <span class="token class-name">FMDatabase</span> <span class="token operator">*</span>fmdb<span class="token punctuation">;</span>

<span class="token annotation punctuation">@end</span>
<span class="token annotation punctuation">@implementation</span> <span class="token class-name">DBTools</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> createDB<span class="token punctuation">{</span>
    <span class="token comment">//    1. 找到沙盒路径</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>docPath <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSSearchPathForDirectoriesInDomains</span><span class="token punctuation">(</span><span class="token class-name">NSDocumentDirectory</span><span class="token punctuation">,</span> <span class="token class-name">NSUserDomainMask</span><span class="token punctuation">,</span> YES<span class="token punctuation">)</span> firstObject<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//   2. 找到db文件</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span>fileName <span class="token operator">=</span>  <span class="token punctuation">[</span>docPath stringByAppendingPathComponent<span class="token operator">:</span> @<span class="token string">&quot;student.db&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    self<span class="token punctuation">.</span>fmdb <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">FMDatabase</span> databaseWithPath<span class="token operator">:</span>fileName<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token class-name">BOOL</span> success <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>fmdb <span class="token keyword">open</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span>success<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;打开数据库成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;打开数据库失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>


<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> createTable<span class="token punctuation">{</span>
    <span class="token comment">//用之前一定要打开数据库</span>
    <span class="token punctuation">[</span>self createDB<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token class-name">NSString</span> <span class="token operator">*</span>sql <span class="token operator">=</span> @<span class="token string">&quot;create table t_stu(id integer primary key autoincrement, name text,  age integer, sex text)&quot;</span><span class="token punctuation">;</span>
    
    <span class="token class-name">BOOL</span> isSuccess <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>fmdb executeUpdate<span class="token operator">:</span>sql<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span>isSuccess<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;创建表成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;创建表失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//用完关闭数据库</span>
    <span class="token punctuation">[</span>self<span class="token punctuation">.</span>fmdb close<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
<span class="token punctuation">}</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> insertStudent<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">Student</span> <span class="token operator">*</span><span class="token punctuation">)</span> student<span class="token punctuation">{</span>
    
    <span class="token punctuation">[</span>self createDB<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token class-name">NSString</span> <span class="token operator">*</span>sql <span class="token operator">=</span> @<span class="token string">&quot;insert into t_stu(name,age,sex) values (?,?,?)&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// 注意FMDB操作数据必须使用对象，age是int类型，不符合，所以需要转换成对象的方式</span>
    <span class="token class-name">BOOL</span> isSuccess <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>fmdb executeUpdate<span class="token operator">:</span>sql<span class="token punctuation">,</span>student<span class="token punctuation">.</span>name<span class="token punctuation">,</span>@<span class="token punctuation">(</span>student<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">,</span>student<span class="token punctuation">.</span>sex<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span>isSuccess<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;插入成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;插入失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//用完关闭数据库</span>
    <span class="token punctuation">[</span>self<span class="token punctuation">.</span>fmdb close<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    
<span class="token punctuation">}</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> deleteStudent<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span> stuName<span class="token punctuation">{</span>
    
    <span class="token punctuation">[</span>self createDB<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token class-name">NSString</span> <span class="token operator">*</span>sql <span class="token operator">=</span> @<span class="token string">&quot;delete from t_stu where name=?&quot;</span><span class="token punctuation">;</span>
    
    <span class="token class-name">BOOL</span> isSuccess <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>fmdb executeUpdate<span class="token operator">:</span>sql<span class="token punctuation">,</span>stuName<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span>isSuccess<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;删除成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;删除失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//用完关闭数据库</span>
    <span class="token punctuation">[</span>self<span class="token punctuation">.</span>fmdb close<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
<span class="token punctuation">}</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> updateStudent<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">Student</span> <span class="token operator">*</span><span class="token punctuation">)</span> student<span class="token punctuation">{</span>
    <span class="token punctuation">[</span>self createDB<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token class-name">NSString</span> <span class="token operator">*</span>sql <span class="token operator">=</span> @<span class="token string">&quot;update t_stu set age=? , sex=? where name=?&quot;</span><span class="token punctuation">;</span>
    
    <span class="token class-name">BOOL</span> isSuccess <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>fmdb executeUpdate<span class="token operator">:</span>sql<span class="token punctuation">,</span>@<span class="token punctuation">(</span>student<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">,</span>student<span class="token punctuation">.</span>sex<span class="token punctuation">,</span>student<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span>isSuccess<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;更新成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;更新失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//用完关闭数据库</span>
    <span class="token punctuation">[</span>self<span class="token punctuation">.</span>fmdb close<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
<span class="token punctuation">}</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">NSArray</span><span class="token operator">&lt;</span><span class="token class-name">Student</span> <span class="token operator">*</span><span class="token operator">&gt;</span><span class="token operator">*</span><span class="token punctuation">)</span> queryStudentByName<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span> stuName<span class="token punctuation">{</span>
    <span class="token punctuation">[</span>self createDB<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token class-name">NSString</span> <span class="token operator">*</span>sql <span class="token operator">=</span> @<span class="token string">&quot;select name,age,sex from  t_stu  where name=?&quot;</span><span class="token punctuation">;</span>
    
    <span class="token class-name">FMResultSet</span> <span class="token operator">*</span>resultSet<span class="token operator">=</span><span class="token punctuation">[</span>self<span class="token punctuation">.</span>fmdb executeQuery<span class="token operator">:</span>sql<span class="token punctuation">,</span>stuName<span class="token punctuation">]</span><span class="token punctuation">;</span>
 
    <span class="token class-name">NSMutableArray</span> <span class="token operator">*</span>array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSMutableArray</span> array<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>resultSet next<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">NSString</span> <span class="token operator">*</span>name <span class="token operator">=</span> <span class="token punctuation">[</span>resultSet stringForColumn<span class="token operator">:</span>@<span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token punctuation">[</span>resultSet intForColumn<span class="token operator">:</span>@<span class="token string">&quot;age&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">NSString</span> <span class="token operator">*</span>sex <span class="token operator">=</span> <span class="token punctuation">[</span>resultSet stringForColumn<span class="token operator">:</span>@<span class="token string">&quot;sex&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">Student</span> <span class="token operator">*</span>stu <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">Student</span> alloc<span class="token punctuation">]</span> initWithName<span class="token operator">:</span>name andAge<span class="token operator">:</span>age andSex<span class="token operator">:</span>sex<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">[</span>array addObject<span class="token operator">:</span>stu<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//用完关闭数据库</span>
    <span class="token punctuation">[</span>self<span class="token punctuation">.</span>fmdb close<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> array<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@end</span>

</code></pre></div><h3 id="_4-事务的操作"><a href="#_4-事务的操作" aria-hidden="true" class="header-anchor">#</a> 4. 事务的操作</h3> <div class="language-java extra-class"><pre class="language-java"><code>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>insertStudents<span class="token operator">:</span><span class="token punctuation">(</span><span class="token class-name">NSArray</span><span class="token operator">&lt;</span><span class="token class-name">Student</span> <span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token operator">*</span><span class="token punctuation">)</span>students<span class="token punctuation">{</span>
    <span class="token punctuation">[</span>self createDB<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//    开启事务</span>
    <span class="token punctuation">[</span>self<span class="token punctuation">.</span>fmdb beginTransaction<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@try</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Student</span> <span class="token operator">*</span>student in students<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">NSString</span> <span class="token operator">*</span>sql <span class="token operator">=</span> @<span class="token string">&quot;insert into t_stu(name,age,sex) values (?,?,?)&quot;</span><span class="token punctuation">;</span>
            <span class="token comment">// 注意FMDB操作数据必须使用对象，age是int类型，不符合，所以需要转换成对象的方式</span>
            <span class="token class-name">BOOL</span> isSuccess <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>fmdb executeUpdate<span class="token operator">:</span>sql<span class="token punctuation">,</span>student<span class="token punctuation">.</span>name<span class="token punctuation">,</span>@<span class="token punctuation">(</span>student<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">,</span>student<span class="token punctuation">.</span>sex<span class="token punctuation">]</span><span class="token punctuation">;</span>
            
            <span class="token keyword">if</span><span class="token punctuation">(</span>isSuccess<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;插入成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span><span class="token punctuation">{</span>
                <span class="token class-name">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;插入失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token annotation punctuation">@catch</span> <span class="token punctuation">(</span><span class="token class-name">NSException</span> <span class="token operator">*</span>exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//   回滚数据</span>
        <span class="token punctuation">[</span>self<span class="token punctuation">.</span>fmdb rollback<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token annotation punctuation">@finally</span> <span class="token punctuation">{</span>
        <span class="token comment">//   提交数据</span>
        <span class="token punctuation">[</span>self<span class="token punctuation">.</span>fmdb commit<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//用完关闭数据库</span>
    <span class="token punctuation">[</span>self<span class="token punctuation">.</span>fmdb close<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>测试：</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token class-name">NSMutableArray</span> <span class="token operator">*</span>array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSMutableArray</span> array<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token class-name">Student</span> <span class="token operator">*</span>stu <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">Student</span> alloc<span class="token punctuation">]</span> initWithName<span class="token operator">:</span>@<span class="token string">&quot;mrgaogang&quot;</span> andAge<span class="token operator">:</span>i andSex<span class="token operator">:</span>@<span class="token string">&quot;male&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">[</span>array addObject<span class="token operator">:</span>stu<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">[</span>self<span class="token punctuation">.</span>dbTools insertStudents<span class="token operator">:</span> array<span class="token punctuation">]</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>参考</strong></p> <ul><li><a href="https://blog.csdn.net/wangyanchang21/article/details/49130599" target="_blank" rel="noopener noreferrer">NSBundle 详解及 iOS 包内容<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://ke.qq.com/webcourse/index.html#cid=1583910&amp;term_id=101682609&amp;taid=7928380780981030&amp;vid=5285890788197354936" target="_blank" rel="noopener noreferrer">IOS12+Objective-C+Xcode 教程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">3/29/2021, 6:46:08 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.c442d8c4.js" defer></script><script src="/assets/js/6.67406e8c.js" defer></script><script src="/assets/js/3.5ac3ae2c.js" defer></script><script src="/assets/js/12.a3342e3d.js" defer></script>
  </body>
</html>
