(window.webpackJsonp=window.webpackJsonp||[]).push([[221],{908:function(e,t,a){"use strict";a.r(t);var n=a(18),s=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("blockquote",[a("p",[e._v("æ­¤æ–‡ç« éƒ¨åˆ†æ‘˜å½•è‡ª: "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-faq.html#are-hooks-slow-because-of-creating-functions-in-render",target:"_blank",rel:"noopener noreferrer"}},[e._v("react å®˜ç½‘ hooks FAQ"),a("OutboundLink")],1)])]),e._v(" "),a("h2",{attrs:{id:"hooksä½¿ç”¨æ³¨æ„äº‹é¡¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hooksä½¿ç”¨æ³¨æ„äº‹é¡¹"}},[e._v("#")]),e._v(" Hooksä½¿ç”¨æ³¨æ„äº‹é¡¹")]),e._v(" "),a("h3",{attrs:{id:"æ˜¯å¦åº”è¯¥ä¸€ç›´ä½¿ç”¨usecallbackåŒ…è£¹å‡½æ•°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ˜¯å¦åº”è¯¥ä¸€ç›´ä½¿ç”¨usecallbackåŒ…è£¹å‡½æ•°"}},[e._v("#")]),e._v(" æ˜¯å¦åº”è¯¥ä¸€ç›´ä½¿ç”¨useCallbackåŒ…è£¹å‡½æ•°")]),e._v(" "),a("p",[e._v("ä¾‹å­:")]),e._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("function")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("App")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[e._v("method1")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// ...")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v("  method2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("useCallback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// è¿™æ˜¯ä¸€ä¸ªå’Œ method1 åŠŸèƒ½ä¸€æ ·çš„æ–¹æ³•")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("div onClick"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("method1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("button"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("div onClick"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("method2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("button"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\n")])])]),a("p",[e._v("æˆ‘ä»¬çš„ App å‡½æ•°åœ¨æ¯ä¸€æ¬¡æ›´æ–°çš„æ—¶å€™éƒ½ä¼šé‡æ–°æ‰§è¡Œï¼Œç”±äºè¿™ä¸ªåŸå› ï¼Œå®ƒå†…éƒ¨çš„å‡½æ•°ä¹Ÿéƒ½ä¼šé‡æ–°ç”Ÿæˆä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬çš„ "),a("code",[e._v("method1")]),e._v(" æ¯æ¬¡éƒ½ä¼šé‡æ–°æ‰§è¡Œç”Ÿæˆä¸€éã€‚\nè€Œ "),a("code",[e._v("method2")]),e._v(" å°±ä¸ä¸€æ ·äº†ï¼Œå®ƒæ˜¯è¢« "),a("code",[e._v("useCallback")]),e._v(" åŒ…è£¹çš„è¿”å›å€¼ï¼Œé™¤éä¾èµ–å˜åŒ–äº†ï¼Œä¸ç„¶å®ƒä¸ä¼šé‡æ–°ç”Ÿæˆï¼Œäºæ˜¯ï¼Œä½ å¯èƒ½å°±ä¼šè®¤ä¸º "),a("code",[e._v("method2")]),e._v(" é‚£ç§å†™æ³•æ€§èƒ½æ›´é«˜ã€‚")]),e._v(" "),a("p",[e._v("äº‹å®ä¸Šå¹¶ä¸ä¸€å®šå¦‚æ­¤:")]),e._v(" "),a("p",[a("img",{attrs:{src:"https://cdn-1252273386.cos.ap-guangzhou.myqcloud.com/images/63061e25d5211c45e2286589bd96c86a.png",alt:""}})]),e._v(" "),a("p",[a("strong",[e._v("å¯¹äº method1")]),e._v(":  æ¯æ¬¡å‡½æ•°æ‰§è¡Œåˆ›å»ºæ–°çš„å‡½æ•°å‡ ä¹æ˜¯å¯ä»¥å¿½ç•¥ä¸è®¡çš„;\n"),a("strong",[e._v("å¯¹äº method2")]),e._v(": æ¯æ¬¡ props æ›´æ–° é‡æ–°æ‰§è¡Œï¼Œéœ€è¦å¯¹æ¯”å‰åçš„propsæ˜¯å¦ç›¸åŒã€å¢åŠ äº†å¯¹æ¯”çš„æˆæœ¬ã€‘ï¼›ä¸ºäº†èƒ½åˆ¤æ–­ useCallback è¦ä¸è¦æ›´æ–°ç»“æœï¼Œæˆ‘ä»¬è¿˜è¦åœ¨å†…å­˜ä¿å­˜ä¸Šä¸€æ¬¡çš„ä¾èµ–ã€‚ã€å¢åŠ äº†æ•°æ®å­˜å‚¨ã€‘")]),e._v(" "),a("p",[a("strong",[e._v("useCallbackå»ºè®®ä½¿ç”¨çš„åœºæ™¯")])]),e._v(" "),a("blockquote",[a("p",[a("strong",[e._v("éœ€è¦å°†å‡½æ•°ä¼ é€’ç»™å­å¯¹è±¡")]),e._v("ï¼›")])]),e._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// parent.tsx")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[e._v("handleClick")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("Children count"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v(" onClick"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("handleClick"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n\n")])])]),a("p",[e._v("å¦‚æœå­ç»„ä»¶ç”±äºå…¶ä»–å€¼çš„æ›´æ”¹è€Œå‘ç”Ÿäº†æ›´æ–°ï¼Œå­ç»„ä»¶ä¼šé‡æ–°æ¸²æŸ“ï¼Œç”±äº "),a("code",[e._v("handleClick")]),e._v(" æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ¯æ¬¡æ¸²æŸ“ç”Ÿæˆçš„ "),a("code",[e._v("handleClick")]),e._v(" éƒ½æ˜¯æ–°çš„ã€‚")]),e._v(" "),a("p",[e._v("è¿™å°±ä¼šå¯¼è‡´ï¼Œå°½ç®¡ "),a("code",[e._v("Children")]),e._v(" è¢« "),a("code",[e._v("React.memo")]),e._v(" åŒ…è£¹äº†ä¸€å±‚ï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šé‡æ–°æ¸²æŸ“ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°±è¦è¿™æ ·å†™ "),a("code",[e._v("handleClick")]),e._v(" å‡½æ•°äº†ï¼š")]),e._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" handleClick "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("useCallback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// åŸæ¥çš„ handleClick...")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("h3",{attrs:{id:"æˆ‘è¯¥å¦‚ä½•æµ‹é‡-dom-èŠ‚ç‚¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æˆ‘è¯¥å¦‚ä½•æµ‹é‡-dom-èŠ‚ç‚¹"}},[e._v("#")]),e._v(" æˆ‘è¯¥å¦‚ä½•æµ‹é‡ DOM èŠ‚ç‚¹ï¼Ÿ")]),e._v(" "),a("p",[e._v("è·å– DOM èŠ‚ç‚¹çš„ä½ç½®æˆ–æ˜¯å¤§å°çš„åŸºæœ¬æ–¹å¼æ˜¯ä½¿ç”¨ "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/refs-and-the-dom.html#callback-refs",target:"_blank",rel:"noopener noreferrer"}},[e._v("callback ref"),a("OutboundLink")],1),e._v("ã€‚æ¯å½“ ref è¢«é™„åŠ åˆ°ä¸€ä¸ªå¦ä¸€ä¸ªèŠ‚ç‚¹ï¼ŒReact å°±ä¼šè°ƒç”¨ callbackã€‚è¿™é‡Œæœ‰ä¸€ä¸ª "),a("a",{attrs:{href:"https://codesandbox.io/s/l7m0v5x4v9",target:"_blank",rel:"noopener noreferrer"}},[e._v("å° demo"),a("OutboundLink")],1),e._v(":")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("function MeasureExample() {\n  const [height, setHeight] = useState(0);\n\n  const measuredRef = useCallback(node => {    if (node !== null) {      setHeight(node.getBoundingClientRect().height);    }  }, []);\n  return (\n    <>\n      <h1 ref={measuredRef}>Hello, world</h1>      <h2>The above header is {Math.round(height)}px tall</h2>\n    </>\n  );\n}\n")])])]),a("p",[e._v("åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰é€‰æ‹©ä½¿ç”¨ "),a("code",[e._v("useRef")]),e._v("ï¼Œå› ä¸ºå½“ ref æ˜¯ä¸€ä¸ªå¯¹è±¡æ—¶å®ƒå¹¶ä¸ä¼šæŠŠå½“å‰ ref çš„å€¼çš„ "),a("em",[e._v("å˜åŒ–")]),e._v(" é€šçŸ¥åˆ°æˆ‘ä»¬ã€‚ä½¿ç”¨ callback ref å¯ä»¥ç¡®ä¿ "),a("a",{attrs:{href:"https://codesandbox.io/s/818zzk8m78",target:"_blank",rel:"noopener noreferrer"}},[e._v("å³ä¾¿å­ç»„ä»¶å»¶è¿Ÿæ˜¾ç¤ºè¢«æµ‹é‡çš„èŠ‚ç‚¹"),a("OutboundLink")],1),e._v(" (æ¯”å¦‚ä¸ºäº†å“åº”ä¸€æ¬¡ç‚¹å‡»)ï¼Œæˆ‘ä»¬ä¾ç„¶èƒ½å¤Ÿåœ¨çˆ¶ç»„ä»¶æ¥æ”¶åˆ°ç›¸å…³çš„ä¿¡æ¯ï¼Œä»¥ä¾¿æ›´æ–°æµ‹é‡ç»“æœã€‚")]),e._v(" "),a("p",[e._v("æ³¨æ„åˆ°æˆ‘ä»¬ä¼ é€’äº† "),a("code",[e._v("[]")]),e._v(" ä½œä¸º "),a("code",[e._v("useCallback")]),e._v(" çš„ä¾èµ–åˆ—è¡¨ã€‚è¿™ç¡®ä¿äº† ref callback ä¸ä¼šåœ¨å†æ¬¡æ¸²æŸ“æ—¶æ”¹å˜ï¼Œå› æ­¤ React ä¸ä¼šåœ¨éå¿…è¦çš„æ—¶å€™è°ƒç”¨å®ƒã€‚")]),e._v(" "),a("p",[e._v("åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå½“ä¸”ä»…å½“ç»„ä»¶æŒ‚è½½å’Œå¸è½½æ—¶ï¼Œcallback ref æ‰ä¼šè¢«è°ƒç”¨ï¼Œå› ä¸ºæ¸²æŸ“çš„ "),a("code",[e._v("<h1>")]),e._v(" ç»„ä»¶åœ¨æ•´ä¸ªé‡æ–°æ¸²æŸ“æœŸé—´å§‹ç»ˆå­˜åœ¨ã€‚å¦‚æœä½ å¸Œæœ›åœ¨æ¯æ¬¡ç»„ä»¶è°ƒæ•´å¤§å°æ—¶éƒ½æ”¶åˆ°é€šçŸ¥ï¼Œåˆ™å¯èƒ½éœ€è¦ä½¿ç”¨ "),a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/ResizeObserver",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("ResizeObserver")]),a("OutboundLink")],1),e._v(" æˆ–åŸºäºå…¶æ„å»ºçš„ç¬¬ä¸‰æ–¹ Hookã€‚")]),e._v(" "),a("p",[e._v("å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥ "),a("a",{attrs:{href:"https://codesandbox.io/s/m5o42082xy",target:"_blank",rel:"noopener noreferrer"}},[e._v("æŠŠè¿™ä¸ªé€»è¾‘æŠ½å–å‡ºæ¥ä½œä¸º"),a("OutboundLink")],1),e._v(" ä¸€ä¸ªå¯å¤ç”¨çš„ Hook:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("function MeasureExample() {\n  const [rect, ref] = useClientRect();  return (\n    <>\n      <h1 ref={ref}>Hello, world</h1>\n      {rect !== null &&\n        <h2>The above header is {Math.round(rect.height)}px tall</h2>\n      }\n    </>\n  );\n}\n\nfunction useClientRect() {\n  const [rect, setRect] = useState(null);\n  const ref = useCallback(node => {\n    if (node !== null) {\n      setRect(node.getBoundingClientRect());\n    }\n  }, []);\n  return [rect, ref];\n}\n")])])]),a("h3",{attrs:{id:"const-thing-setthing-usestate-æ˜¯ä»€ä¹ˆæ„æ€"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#const-thing-setthing-usestate-æ˜¯ä»€ä¹ˆæ„æ€"}},[e._v("#")]),e._v(" "),a("code",[e._v("const [thing, setThing] = useState()")]),e._v(" æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ")]),e._v(" "),a("p",[e._v("å¦‚æœä½ ä¸ç†Ÿæ‚‰è¿™ä¸ªè¯­æ³•ï¼Œå¯ä»¥æŸ¥çœ‹ State Hook æ–‡æ¡£ä¸­çš„ "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-state.html#tip-what-do-square-brackets-mean",target:"_blank",rel:"noopener noreferrer"}},[e._v("è§£é‡Š"),a("OutboundLink")],1),e._v(" ä¸€èŠ‚ã€‚")]),e._v(" "),a("h2",{attrs:{id:"æ€§èƒ½ä¼˜åŒ–"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ€§èƒ½ä¼˜åŒ–"}},[e._v("#")]),e._v(" æ€§èƒ½ä¼˜åŒ–")]),e._v(" "),a("h3",{attrs:{id:"æˆ‘å¯ä»¥åœ¨æ›´æ–°æ—¶è·³è¿‡-effect-å—"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æˆ‘å¯ä»¥åœ¨æ›´æ–°æ—¶è·³è¿‡-effect-å—"}},[e._v("#")]),e._v(" æˆ‘å¯ä»¥åœ¨æ›´æ–°æ—¶è·³è¿‡ effect å—ï¼Ÿ")]),e._v(" "),a("p",[e._v("å¯ä»¥çš„ã€‚å‚è§ "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-reference.html#conditionally-firing-an-effect",target:"_blank",rel:"noopener noreferrer"}},[e._v("æ¡ä»¶å¼çš„å‘èµ· effect"),a("OutboundLink")],1),e._v("ã€‚æ³¨æ„ï¼Œå¿˜è®°å¤„ç†æ›´æ–°å¸¸ä¼š "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-effect.html#explanation-why-effects-run-on-each-update",target:"_blank",rel:"noopener noreferrer"}},[e._v("å¯¼è‡´ bug"),a("OutboundLink")],1),e._v("ï¼Œè¿™ä¹Ÿæ­£æ˜¯æˆ‘ä»¬æ²¡æœ‰é»˜è®¤ä½¿ç”¨æ¡ä»¶å¼ effect çš„åŸå› ã€‚")]),e._v(" "),a("h3",{attrs:{id:"åœ¨ä¾èµ–åˆ—è¡¨ä¸­çœç•¥å‡½æ•°æ˜¯å¦å®‰å…¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åœ¨ä¾èµ–åˆ—è¡¨ä¸­çœç•¥å‡½æ•°æ˜¯å¦å®‰å…¨"}},[e._v("#")]),e._v(" åœ¨ä¾èµ–åˆ—è¡¨ä¸­çœç•¥å‡½æ•°æ˜¯å¦å®‰å…¨ï¼Ÿ")]),e._v(" "),a("p",[e._v("ä¸€èˆ¬æ¥è¯´ï¼Œä¸å®‰å…¨ã€‚")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("function Example({ someProp }) {\n  function doSomething() {\n    console.log(someProp);  }\n\n  useEffect(() => {\n    doSomething();\n  }, []); // ğŸ”´ è¿™æ ·ä¸å®‰å…¨ï¼ˆå®ƒè°ƒç”¨çš„ `doSomething` å‡½æ•°ä½¿ç”¨äº† `someProp`ï¼‰}\n")])])]),a("p",[e._v("è¦è®°ä½ effect å¤–éƒ¨çš„å‡½æ•°ä½¿ç”¨äº†å“ªäº› props å’Œ state å¾ˆéš¾ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ "),a("strong",[e._v("é€šå¸¸ä½ ä¼šæƒ³è¦åœ¨ effect "),a("em",[e._v("å†…éƒ¨")]),e._v(" å»å£°æ˜å®ƒæ‰€éœ€è¦çš„å‡½æ•°ã€‚")]),e._v(" è¿™æ ·å°±èƒ½å®¹æ˜“çš„çœ‹å‡ºé‚£ä¸ª effect ä¾èµ–äº†ç»„ä»¶ä½œç”¨åŸŸä¸­çš„å“ªäº›å€¼ï¼š")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("function Example({ someProp }) {\n  useEffect(() => {\n    function doSomething() {\n      console.log(someProp);    }\n\n    doSomething();\n  }, [someProp]); // âœ… å®‰å…¨ï¼ˆæˆ‘ä»¬çš„ effect ä»…ç”¨åˆ°äº† `someProp`ï¼‰}\n")])])]),a("p",[e._v("å¦‚æœè¿™æ ·ä¹‹åæˆ‘ä»¬ä¾ç„¶æ²¡ç”¨åˆ°ç»„ä»¶ä½œç”¨åŸŸä¸­çš„ä»»ä½•å€¼ï¼Œå°±å¯ä»¥å®‰å…¨åœ°æŠŠå®ƒæŒ‡å®šä¸º "),a("code",[e._v("[]")]),e._v("ï¼š")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("useEffect(() => {\n  function doSomething() {\n    console.log('hello');\n  }\n\n  doSomething();\n}, []); // âœ… åœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰ç”¨åˆ°ç»„ä»¶ä½œç”¨åŸŸä¸­çš„ *ä»»ä½•* å€¼\n")])])]),a("p",[e._v("æ ¹æ®ä½ çš„ç”¨ä¾‹ï¼Œä¸‹é¢åˆ—ä¸¾äº†ä¸€äº›å…¶ä»–çš„åŠæ³•ã€‚")]),e._v(" "),a("blockquote",[a("p",[e._v("æ³¨æ„")]),e._v(" "),a("p",[e._v("æˆ‘ä»¬æä¾›äº†ä¸€ä¸ª "),a("a",{attrs:{href:"https://github.com/facebook/react/issues/14920",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("exhaustive-deps")]),a("OutboundLink")],1),e._v(" ESLint è§„åˆ™ä½œä¸º "),a("a",{attrs:{href:"https://www.npmjs.com/package/eslint-plugin-react-hooks#installation",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("eslint-plugin-react-hooks")]),a("OutboundLink")],1),e._v(" åŒ…çš„ä¸€éƒ¨åˆ†ã€‚å®ƒä¼šå¸®åŠ©ä½ æ‰¾å‡ºæ— æ³•ä¸€è‡´åœ°å¤„ç†æ›´æ–°çš„ç»„ä»¶ã€‚")])]),e._v(" "),a("p",[e._v("è®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™æœ‰ä»€ä¹ˆå…³ç³»ã€‚")]),e._v(" "),a("p",[e._v("å¦‚æœä½ æŒ‡å®šäº†ä¸€ä¸ª "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-reference.html#conditionally-firing-an-effect",target:"_blank",rel:"noopener noreferrer"}},[e._v("ä¾èµ–åˆ—è¡¨"),a("OutboundLink")],1),e._v(" ä½œä¸º "),a("code",[e._v("useEffect")]),e._v("ã€"),a("code",[e._v("useLayoutEffect")]),e._v("ã€"),a("code",[e._v("useMemo")]),e._v("ã€"),a("code",[e._v("useCallback")]),e._v(" æˆ– "),a("code",[e._v("useImperativeHandle")]),e._v(" çš„æœ€åä¸€ä¸ªå‚æ•°ï¼Œå®ƒå¿…é¡»åŒ…å«å›è°ƒä¸­çš„æ‰€æœ‰å€¼ï¼Œå¹¶å‚ä¸ React æ•°æ®æµã€‚è¿™å°±åŒ…æ‹¬ propsã€stateï¼Œä»¥åŠä»»ä½•ç”±å®ƒä»¬è¡ç”Ÿè€Œæ¥çš„ä¸œè¥¿ã€‚")]),e._v(" "),a("p",[a("strong",[e._v("åªæœ‰")]),e._v(" å½“å‡½æ•°ï¼ˆä»¥åŠå®ƒæ‰€è°ƒç”¨çš„å‡½æ•°ï¼‰ä¸å¼•ç”¨ propsã€state ä»¥åŠç”±å®ƒä»¬è¡ç”Ÿè€Œæ¥çš„å€¼æ—¶ï¼Œä½ æ‰èƒ½æ”¾å¿ƒåœ°æŠŠå®ƒä»¬ä»ä¾èµ–åˆ—è¡¨ä¸­çœç•¥ã€‚ä¸‹é¢è¿™ä¸ªæ¡ˆä¾‹æœ‰ä¸€ä¸ª Bugï¼š")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("function ProductPage({ productId }) {\n  const [product, setProduct] = useState(null);\n\n  async function fetchProduct() {\n    const response = await fetch('http://myapi/product/' + productId); // ä½¿ç”¨äº† productId prop    const json = await response.json();\n    setProduct(json);\n  }\n\n  useEffect(() => {\n    fetchProduct();\n  }, []); // ğŸ”´ è¿™æ ·æ˜¯æ— æ•ˆçš„ï¼Œå› ä¸º `fetchProduct` ä½¿ç”¨äº† `productId`  // ...\n}\n")])])]),a("p",[a("strong",[e._v("æ¨èçš„ä¿®å¤æ–¹æ¡ˆæ˜¯æŠŠé‚£ä¸ªå‡½æ•°ç§»åŠ¨åˆ°ä½ çš„ effect "),a("em",[e._v("å†…éƒ¨")])]),e._v("ã€‚è¿™æ ·å°±èƒ½å¾ˆå®¹æ˜“çš„çœ‹å‡ºæ¥ä½ çš„ effect ä½¿ç”¨äº†å“ªäº› props å’Œ stateï¼Œå¹¶ç¡®ä¿å®ƒä»¬éƒ½è¢«å£°æ˜äº†ï¼š")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("function ProductPage({ productId }) {\n  const [product, setProduct] = useState(null);\n\n  useEffect(() => {\n    // æŠŠè¿™ä¸ªå‡½æ•°ç§»åŠ¨åˆ° effect å†…éƒ¨åï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°å®ƒç”¨åˆ°çš„å€¼ã€‚    async function fetchProduct() {      const response = await fetch('http://myapi/product/' + productId);      const json = await response.json();      setProduct(json);    }\n    fetchProduct();\n  }, [productId]); // âœ… æœ‰æ•ˆï¼Œå› ä¸ºæˆ‘ä»¬çš„ effect åªç”¨åˆ°äº† productId  // ...\n}\n")])])]),a("p",[e._v("è¿™åŒæ—¶ä¹Ÿå…è®¸ä½ é€šè¿‡ effect å†…éƒ¨çš„å±€éƒ¨å˜é‡æ¥å¤„ç†æ— åºçš„å“åº”ï¼š")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("  useEffect(() => {\n    let ignore = false;    async function fetchProduct() {\n      const response = await fetch('http://myapi/product/' + productId);\n      const json = await response.json();\n      if (!ignore) setProduct(json);    }\n\n    fetchProduct();\n    return () => { ignore = true };  }, [productId]);\n")])])]),a("p",[e._v("æˆ‘ä»¬æŠŠè¿™ä¸ªå‡½æ•°ç§»åŠ¨åˆ° effect å†…éƒ¨ï¼Œè¿™æ ·å®ƒå°±ä¸ç”¨å‡ºç°åœ¨å®ƒçš„ä¾èµ–åˆ—è¡¨ä¸­äº†ã€‚")]),e._v(" "),a("blockquote",[a("p",[e._v("æç¤º")]),e._v(" "),a("p",[e._v("çœ‹çœ‹ "),a("a",{attrs:{href:"https://codesandbox.io/s/jvvkoo8pq3",target:"_blank",rel:"noopener noreferrer"}},[e._v("è¿™ä¸ªå° demo"),a("OutboundLink")],1),e._v(" å’Œ "),a("a",{attrs:{href:"https://www.robinwieruch.de/react-hooks-fetch-data/",target:"_blank",rel:"noopener noreferrer"}},[e._v("è¿™ç¯‡æ–‡ç« "),a("OutboundLink")],1),e._v(" æ¥äº†è§£æ›´å¤šå…³äºå¦‚ä½•ç”¨ Hook è¿›è¡Œæ•°æ®è·å–ã€‚")])]),e._v(" "),a("p",[a("strong",[e._v("å¦‚æœå‡ºäºæŸäº›åŸå› ä½  "),a("em",[e._v("æ— æ³•")]),e._v(" æŠŠä¸€ä¸ªå‡½æ•°ç§»åŠ¨åˆ° effect å†…éƒ¨ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–åŠæ³•ï¼š")])]),e._v(" "),a("ul",[a("li",[a("strong",[e._v("ä½ å¯ä»¥å°è¯•æŠŠé‚£ä¸ªå‡½æ•°ç§»åŠ¨åˆ°ä½ çš„ç»„ä»¶ä¹‹å¤–")]),e._v("ã€‚é‚£æ ·ä¸€æ¥ï¼Œè¿™ä¸ªå‡½æ•°å°±è‚¯å®šä¸ä¼šä¾èµ–ä»»ä½• props æˆ– stateï¼Œå¹¶ä¸”ä¹Ÿä¸ç”¨å‡ºç°åœ¨ä¾èµ–åˆ—è¡¨ä¸­äº†ã€‚")]),e._v(" "),a("li",[e._v("å¦‚æœä½ æ‰€è°ƒç”¨çš„æ–¹æ³•æ˜¯ä¸€ä¸ªçº¯è®¡ç®—ï¼Œå¹¶ä¸”å¯ä»¥åœ¨æ¸²æŸ“æ—¶è°ƒç”¨ï¼Œä½ å¯ä»¥ "),a("strong",[e._v("è½¬è€Œåœ¨ effect ä¹‹å¤–è°ƒç”¨å®ƒï¼Œ")]),e._v(" å¹¶è®© effect ä¾èµ–äºå®ƒçš„è¿”å›å€¼ã€‚")]),e._v(" "),a("li",[e._v("ä¸‡ä¸å¾—å·²çš„æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ "),a("strong",[e._v("æŠŠå‡½æ•°åŠ å…¥ effect çš„ä¾èµ–ä½† "),a("em",[e._v("æŠŠå®ƒçš„å®šä¹‰åŒ…è£¹")])]),e._v(" è¿› "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-reference.html#usecallback",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("useCallback")]),a("OutboundLink")],1),e._v(" Hookã€‚è¿™å°±ç¡®ä¿äº†å®ƒä¸éšæ¸²æŸ“è€Œæ”¹å˜ï¼Œé™¤é "),a("em",[e._v("å®ƒè‡ªèº«")]),e._v(" çš„ä¾èµ–å‘ç”Ÿäº†æ”¹å˜ï¼š")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("function ProductPage({ productId }) {\n  // âœ… ç”¨ useCallback åŒ…è£¹ä»¥é¿å…éšæ¸²æŸ“å‘ç”Ÿæ”¹å˜  const fetchProduct = useCallback(() => {    // ... Does something with productId ...  }, [productId]); // âœ… useCallback çš„æ‰€æœ‰ä¾èµ–éƒ½è¢«æŒ‡å®šäº†\n  return <ProductDetails fetchProduct={fetchProduct} />;\n}\n\nfunction ProductDetails({ fetchProduct }) {\n  useEffect(() => {\n    fetchProduct();\n  }, [fetchProduct]); // âœ… useEffect çš„æ‰€æœ‰ä¾èµ–éƒ½è¢«æŒ‡å®šäº†\n  // ...\n}\n")])])]),a("p",[e._v("æ³¨æ„åœ¨ä¸Šé¢çš„æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬ "),a("strong",[e._v("éœ€è¦")]),e._v(" è®©å‡½æ•°å‡ºç°åœ¨ä¾èµ–åˆ—è¡¨ä¸­ã€‚è¿™ç¡®ä¿äº† "),a("code",[e._v("ProductPage")]),e._v(" çš„ "),a("code",[e._v("productId")]),e._v(" prop çš„å˜åŒ–ä¼šè‡ªåŠ¨è§¦å‘ "),a("code",[e._v("ProductDetails")]),e._v(" çš„é‡æ–°è·å–ã€‚")]),e._v(" "),a("h3",{attrs:{id:"å¦‚æœæˆ‘çš„-effect-çš„ä¾èµ–é¢‘ç¹å˜åŒ–-æˆ‘è¯¥æ€ä¹ˆåŠ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¦‚æœæˆ‘çš„-effect-çš„ä¾èµ–é¢‘ç¹å˜åŒ–-æˆ‘è¯¥æ€ä¹ˆåŠ"}},[e._v("#")]),e._v(" å¦‚æœæˆ‘çš„ effect çš„ä¾èµ–é¢‘ç¹å˜åŒ–ï¼Œæˆ‘è¯¥æ€ä¹ˆåŠï¼Ÿ")]),e._v(" "),a("p",[e._v("æœ‰æ—¶å€™ï¼Œä½ çš„ effect å¯èƒ½ä¼šä½¿ç”¨ä¸€äº›é¢‘ç¹å˜åŒ–çš„å€¼ã€‚ä½ å¯èƒ½ä¼šå¿½ç•¥ä¾èµ–åˆ—è¡¨ä¸­ stateï¼Œä½†è¿™é€šå¸¸ä¼šå¼•èµ· Bugï¼š")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("function Counter() {\n  const [count, setCount] = useState(0);\n\n  useEffect(() => {\n    const id = setInterval(() => {\n      setCount(count + 1); // è¿™ä¸ª effect ä¾èµ–äº `count` state    }, 1000);\n    return () => clearInterval(id);\n  }, []); // ğŸ”´ Bug: `count` æ²¡æœ‰è¢«æŒ‡å®šä¸ºä¾èµ–\n  return <h1>{count}</h1>;\n}\n")])])]),a("p",[e._v("ä¼ å…¥ç©ºçš„ä¾èµ–æ•°ç»„ "),a("code",[e._v("[]")]),e._v("ï¼Œæ„å‘³ç€è¯¥ hook åªåœ¨ç»„ä»¶æŒ‚è½½æ—¶è¿è¡Œä¸€æ¬¡ï¼Œå¹¶éé‡æ–°æ¸²æŸ“æ—¶ã€‚ä½†å¦‚æ­¤ä¼šæœ‰é—®é¢˜ï¼Œåœ¨ "),a("code",[e._v("setInterval")]),e._v(" çš„å›è°ƒä¸­ï¼Œ"),a("code",[e._v("count")]),e._v(" çš„å€¼ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚å› ä¸ºå½“ effect æ‰§è¡Œæ—¶ï¼Œæˆ‘ä»¬ä¼šåˆ›å»ºä¸€ä¸ªé—­åŒ…ï¼Œå¹¶å°† "),a("code",[e._v("count")]),e._v(" çš„å€¼è¢«ä¿å­˜åœ¨è¯¥é—­åŒ…å½“ä¸­ï¼Œä¸”åˆå€¼ä¸º "),a("code",[e._v("0")]),e._v("ã€‚æ¯éš”ä¸€ç§’ï¼Œå›è°ƒå°±ä¼šæ‰§è¡Œ "),a("code",[e._v("setCount(0 + 1)")]),e._v("ï¼Œå› æ­¤ï¼Œ"),a("code",[e._v("count")]),e._v(" æ°¸è¿œä¸ä¼šè¶…è¿‡ 1ã€‚")]),e._v(" "),a("p",[e._v("æŒ‡å®š "),a("code",[e._v("[count]")]),e._v(" ä½œä¸ºä¾èµ–åˆ—è¡¨å°±èƒ½ä¿®å¤è¿™ä¸ª Bugï¼Œä½†ä¼šå¯¼è‡´æ¯æ¬¡æ”¹å˜å‘ç”Ÿæ—¶å®šæ—¶å™¨éƒ½è¢«é‡ç½®ã€‚äº‹å®ä¸Šï¼Œæ¯ä¸ª "),a("code",[e._v("setInterval")]),e._v(" åœ¨è¢«æ¸…é™¤å‰ï¼ˆç±»ä¼¼äº "),a("code",[e._v("setTimeout")]),e._v("ï¼‰éƒ½ä¼šè°ƒç”¨ä¸€æ¬¡ã€‚ä½†è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-reference.html#functional-updates",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("setState")]),e._v(" çš„å‡½æ•°å¼æ›´æ–°å½¢å¼"),a("OutboundLink")],1),e._v("ã€‚å®ƒå…è®¸æˆ‘ä»¬æŒ‡å®š state è¯¥ "),a("em",[e._v("å¦‚ä½•")]),e._v(" æ”¹å˜è€Œä¸ç”¨å¼•ç”¨ "),a("em",[e._v("å½“å‰")]),e._v(" stateï¼š")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("function Counter() {\n  const [count, setCount] = useState(0);\n\n  useEffect(() => {\n    const id = setInterval(() => {\n      setCount(c => c + 1); // âœ… åœ¨è¿™ä¸ä¾èµ–äºå¤–éƒ¨çš„ `count` å˜é‡    }, 1000);\n    return () => clearInterval(id);\n  }, []); // âœ… æˆ‘ä»¬çš„ effect ä¸ä½¿ç”¨ç»„ä»¶ä½œç”¨åŸŸä¸­çš„ä»»ä½•å˜é‡\n  return <h1>{count}</h1>;\n}\n")])])]),a("p",[e._v("ï¼ˆ"),a("code",[e._v("setCount")]),e._v(" å‡½æ•°çš„èº«ä»½æ˜¯è¢«ç¡®ä¿ç¨³å®šçš„ï¼Œæ‰€ä»¥å¯ä»¥æ”¾å¿ƒçš„çœç•¥æ‰ï¼‰")]),e._v(" "),a("p",[e._v("æ­¤æ—¶ï¼Œ"),a("code",[e._v("setInterval")]),e._v(" çš„å›è°ƒä¾æ—§æ¯ç§’è°ƒç”¨ä¸€æ¬¡ï¼Œä½†æ¯æ¬¡ "),a("code",[e._v("setCount")]),e._v(" å†…éƒ¨çš„å›è°ƒå–åˆ°çš„ "),a("code",[e._v("count")]),e._v(" æ˜¯æœ€æ–°å€¼ï¼ˆåœ¨å›è°ƒä¸­å˜é‡å‘½åä¸º "),a("code",[e._v("c")]),e._v("ï¼‰ã€‚")]),e._v(" "),a("p",[e._v("åœ¨ä¸€äº›æ›´åŠ å¤æ‚çš„åœºæ™¯ä¸­ï¼ˆæ¯”å¦‚ä¸€ä¸ª state ä¾èµ–äºå¦ä¸€ä¸ª stateï¼‰ï¼Œå°è¯•ç”¨ "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-reference.html#usereducer",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("useReducer")]),e._v(" Hook"),a("OutboundLink")],1),e._v(" æŠŠ state æ›´æ–°é€»è¾‘ç§»åˆ° effect ä¹‹å¤–ã€‚"),a("a",{attrs:{href:"https://adamrackis.dev/state-and-use-reducer/",target:"_blank",rel:"noopener noreferrer"}},[e._v("è¿™ç¯‡æ–‡ç« "),a("OutboundLink")],1),e._v(" æä¾›äº†ä¸€ä¸ªä½ è¯¥å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹çš„æ¡ˆä¾‹ã€‚ "),a("strong",[a("code",[e._v("useReducer")]),e._v(" çš„ "),a("code",[e._v("dispatch")]),e._v(" çš„èº«ä»½æ°¸è¿œæ˜¯ç¨³å®šçš„")]),e._v(" â€”â€” å³ä½¿ reducer å‡½æ•°æ˜¯å®šä¹‰åœ¨ç»„ä»¶å†…éƒ¨å¹¶ä¸”ä¾èµ– propsã€‚")]),e._v(" "),a("p",[e._v("ä¸‡ä¸å¾—å·²çš„æƒ…å†µä¸‹ï¼Œå¦‚æœä½ æƒ³è¦ç±»ä¼¼ class ä¸­çš„ "),a("code",[e._v("this")]),e._v(" çš„åŠŸèƒ½ï¼Œä½ å¯ä»¥ "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-faq.html#is-there-something-like-instance-variables",target:"_blank",rel:"noopener noreferrer"}},[e._v("ä½¿ç”¨ä¸€ä¸ª ref"),a("OutboundLink")],1),e._v(" æ¥ä¿å­˜ä¸€ä¸ªå¯å˜çš„å˜é‡ã€‚ç„¶åä½ å°±å¯ä»¥å¯¹å®ƒè¿›è¡Œè¯»å†™äº†ã€‚ä¸¾ä¸ªä¾‹å­ï¼š")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("function Example(props) {\n  // æŠŠæœ€æ–°çš„ props ä¿å­˜åœ¨ä¸€ä¸ª ref ä¸­  const latestProps = useRef(props);  useEffect(() => {    latestProps.current = props;  });\n  useEffect(() => {\n    function tick() {\n      // åœ¨ä»»ä½•æ—¶å€™è¯»å–æœ€æ–°çš„ props      console.log(latestProps.current);    }\n\n    const id = setInterval(tick, 1000);\n    return () => clearInterval(id);\n  }, []); // è¿™ä¸ª effect ä»ä¸ä¼šé‡æ–°æ‰§è¡Œ}\n")])])]),a("p",[e._v("ä»…å½“ä½ å®åœ¨æ‰¾ä¸åˆ°æ›´å¥½åŠæ³•çš„æ—¶å€™æ‰è¿™ä¹ˆåšï¼Œå› ä¸ºä¾èµ–äºå˜æ›´ä¼šä½¿å¾—ç»„ä»¶æ›´éš¾ä»¥é¢„æµ‹ã€‚å¦‚æœæœ‰æŸäº›ç‰¹å®šçš„æ¨¡å¼æ— æ³•å¾ˆå¥½åœ°è½¬åŒ–æˆè¿™æ ·ï¼Œ"),a("a",{attrs:{href:"https://github.com/facebook/react/issues/new",target:"_blank",rel:"noopener noreferrer"}},[e._v("å‘èµ·ä¸€ä¸ª issue"),a("OutboundLink")],1),e._v(" å¹¶é…ä¸Šå¯è¿è¡Œçš„å®ä¾‹ä»£ç ä»¥ä¾¿ï¼Œæˆ‘ä»¬ä¼šå°½å¯èƒ½å¸®åŠ©ä½ ã€‚")]),e._v(" "),a("h3",{attrs:{id:"æˆ‘è¯¥å¦‚ä½•å®ç°-shouldcomponentupdate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æˆ‘è¯¥å¦‚ä½•å®ç°-shouldcomponentupdate"}},[e._v("#")]),e._v(" æˆ‘è¯¥å¦‚ä½•å®ç° "),a("code",[e._v("shouldComponentUpdate")]),e._v("?")]),e._v(" "),a("p",[e._v("ä½ å¯ä»¥ç”¨ "),a("code",[e._v("React.memo")]),e._v(" åŒ…è£¹ä¸€ä¸ªç»„ä»¶æ¥å¯¹å®ƒçš„ props è¿›è¡Œæµ…æ¯”è¾ƒï¼š")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("const Button = React.memo((props) => {\n  // ä½ çš„ç»„ä»¶\n});\n")])])]),a("p",[e._v("è¿™ä¸æ˜¯ä¸€ä¸ª Hook å› ä¸ºå®ƒçš„å†™æ³•å’Œ Hook ä¸åŒã€‚"),a("code",[e._v("React.memo")]),e._v(" ç­‰æ•ˆäº "),a("code",[e._v("PureComponent")]),e._v("ï¼Œä½†å®ƒåªæ¯”è¾ƒ propsã€‚ï¼ˆä½ ä¹Ÿå¯ä»¥é€šè¿‡ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šä¸€ä¸ªè‡ªå®šä¹‰çš„æ¯”è¾ƒå‡½æ•°æ¥æ¯”è¾ƒæ–°æ—§ propsã€‚å¦‚æœå‡½æ•°è¿”å› trueï¼Œå°±ä¼šè·³è¿‡æ›´æ–°ã€‚ï¼‰")]),e._v(" "),a("p",[a("code",[e._v("React.memo")]),e._v(" ä¸æ¯”è¾ƒ stateï¼Œå› ä¸ºæ²¡æœ‰å•ä¸€çš„ state å¯¹è±¡å¯ä¾›æ¯”è¾ƒã€‚ä½†ä½ ä¹Ÿå¯ä»¥è®©å­èŠ‚ç‚¹å˜ä¸ºçº¯ç»„ä»¶ï¼Œæˆ–è€… "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-faq.html#how-to-memoize-calculations",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç”¨ "),a("code",[e._v("useMemo")]),e._v(" ä¼˜åŒ–æ¯ä¸€ä¸ªå…·ä½“çš„å­èŠ‚ç‚¹"),a("OutboundLink")],1),e._v("ã€‚")]),e._v(" "),a("h3",{attrs:{id:"å¦‚ä½•è®°å¿†è®¡ç®—ç»“æœ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¦‚ä½•è®°å¿†è®¡ç®—ç»“æœ"}},[e._v("#")]),e._v(" å¦‚ä½•è®°å¿†è®¡ç®—ç»“æœï¼Ÿ")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-reference.html#usememo",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("useMemo")]),a("OutboundLink")],1),e._v(" Hook å…è®¸ä½ é€šè¿‡ã€Œè®°ä½ã€ä¸Šä¸€æ¬¡è®¡ç®—ç»“æœçš„æ–¹å¼åœ¨å¤šæ¬¡æ¸²æŸ“çš„ä¹‹é—´ç¼“å­˜è®¡ç®—ç»“æœï¼š")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("const memoizedValue = useMemo(() => computeExpensiveValue(a, b), [a, b]);\n")])])]),a("p",[e._v("è¿™è¡Œä»£ç ä¼šè°ƒç”¨ "),a("code",[e._v("computeExpensiveValue(a, b)")]),e._v("ã€‚ä½†å¦‚æœä¾èµ–æ•°ç»„ "),a("code",[e._v("[a, b]")]),e._v(" è‡ªä¸Šæ¬¡èµ‹å€¼ä»¥æ¥æ²¡æœ‰æ”¹å˜è¿‡ï¼Œ"),a("code",[e._v("useMemo")]),e._v(" ä¼šè·³è¿‡äºŒæ¬¡è°ƒç”¨ï¼Œåªæ˜¯ç®€å•å¤ç”¨å®ƒä¸Šä¸€æ¬¡è¿”å›çš„å€¼ã€‚")]),e._v(" "),a("p",[e._v("è®°ä½ï¼Œä¼ ç»™ "),a("code",[e._v("useMemo")]),e._v(" çš„å‡½æ•°æ˜¯åœ¨æ¸²æŸ“æœŸé—´è¿è¡Œçš„ã€‚ä¸è¦åœ¨å…¶ä¸­åšä»»ä½•ä½ é€šå¸¸ä¸ä¼šåœ¨æ¸²æŸ“æœŸé—´åšçš„äº‹ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‰¯ä½œç”¨å±äº "),a("code",[e._v("useEffect")]),e._v("ï¼Œè€Œä¸æ˜¯ "),a("code",[e._v("useMemo")]),e._v("ã€‚")]),e._v(" "),a("p",[e._v("**ä½ å¯ä»¥æŠŠ "),a("code",[e._v("useMemo")]),e._v(" ä½œä¸ºä¸€ç§æ€§èƒ½ä¼˜åŒ–çš„æ‰‹æ®µï¼Œä½†ä¸è¦æŠŠå®ƒå½“åšä¸€ç§è¯­ä¹‰ä¸Šçš„ä¿è¯ã€‚**æœªæ¥ï¼ŒReact å¯èƒ½ä¼šé€‰æ‹©ã€Œå¿˜æ‰ã€ä¸€äº›ä¹‹å‰è®°ä½çš„å€¼å¹¶åœ¨ä¸‹ä¸€æ¬¡æ¸²æŸ“æ—¶é‡æ–°è®¡ç®—å®ƒä»¬ï¼Œæ¯”å¦‚ä¸ºç¦»å±ç»„ä»¶é‡Šæ”¾å†…å­˜ã€‚å»ºè®®è‡ªå·±ç¼–å†™ç›¸å…³ä»£ç ä»¥ä¾¿æ²¡æœ‰ "),a("code",[e._v("useMemo")]),e._v(" ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œ â€”â€” ç„¶åæŠŠå®ƒåŠ å…¥æ€§èƒ½ä¼˜åŒ–ã€‚ï¼ˆåœ¨æŸäº›å–å€¼å¿…é¡» "),a("em",[e._v("ä»ä¸")]),e._v(" è¢«é‡æ–°è®¡ç®—çš„ç½•è§åœºæ™¯ï¼Œä½ å¯ä»¥ "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-faq.html#how-to-create-expensive-objects-lazily",target:"_blank",rel:"noopener noreferrer"}},[e._v("æƒ°æ€§åˆå§‹åŒ–"),a("OutboundLink")],1),e._v(" ä¸€ä¸ª refã€‚ï¼‰")]),e._v(" "),a("p",[e._v("æ–¹ä¾¿èµ·è§ï¼Œ"),a("code",[e._v("useMemo")]),e._v(" ä¹Ÿå…è®¸ä½ è·³è¿‡ä¸€æ¬¡å­èŠ‚ç‚¹çš„æ˜‚è´µçš„é‡æ–°æ¸²æŸ“ï¼š")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("function Parent({ a, b }) {\n  // Only re-rendered if `a` changes:\n  const child1 = useMemo(() => <Child1 a={a} />, [a]);\n  // Only re-rendered if `b` changes:\n  const child2 = useMemo(() => <Child2 b={b} />, [b]);\n  return (\n    <>\n      {child1}\n      {child2}\n    </>\n  )\n}\n")])])]),a("p",[e._v("æ³¨æ„è¿™ç§æ–¹å¼åœ¨å¾ªç¯ä¸­æ˜¯æ— æ•ˆçš„ï¼Œå› ä¸º Hook è°ƒç”¨ "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-rules.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("ä¸èƒ½"),a("OutboundLink")],1),e._v(" è¢«æ”¾åœ¨å¾ªç¯ä¸­ã€‚ä½†ä½ å¯ä»¥ä¸ºåˆ—è¡¨é¡¹æŠ½å–ä¸€ä¸ªå•ç‹¬çš„ç»„ä»¶ï¼Œå¹¶åœ¨å…¶ä¸­è°ƒç”¨ "),a("code",[e._v("useMemo")]),e._v("ã€‚")]),e._v(" "),a("h3",{attrs:{id:"å¦‚ä½•æƒ°æ€§åˆ›å»ºæ˜‚è´µçš„å¯¹è±¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¦‚ä½•æƒ°æ€§åˆ›å»ºæ˜‚è´µçš„å¯¹è±¡"}},[e._v("#")]),e._v(" å¦‚ä½•æƒ°æ€§åˆ›å»ºæ˜‚è´µçš„å¯¹è±¡ï¼Ÿ")]),e._v(" "),a("p",[e._v("å¦‚æœä¾èµ–æ•°ç»„çš„å€¼ç›¸åŒï¼Œ"),a("code",[e._v("useMemo")]),e._v(" å…è®¸ä½  "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-faq.html#how-to-memoize-calculations",target:"_blank",rel:"noopener noreferrer"}},[e._v("è®°ä½ä¸€æ¬¡æ˜‚è´µçš„è®¡ç®—"),a("OutboundLink")],1),e._v("ã€‚ä½†æ˜¯ï¼Œè¿™ä»…ä½œä¸ºä¸€ç§æç¤ºï¼Œå¹¶ä¸ "),a("em",[e._v("ä¿è¯")]),e._v(" è®¡ç®—ä¸ä¼šé‡æ–°è¿è¡Œã€‚ä½†æœ‰æ—¶å€™éœ€è¦ç¡®ä¿ä¸€ä¸ªå¯¹è±¡ä»…è¢«åˆ›å»ºä¸€æ¬¡ã€‚")]),e._v(" "),a("p",[a("strong",[e._v("ç¬¬ä¸€ä¸ªå¸¸è§çš„ä½¿ç”¨åœºæ™¯æ˜¯å½“åˆ›å»ºåˆå§‹ state å¾ˆæ˜‚è´µæ—¶ï¼š")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("function Table(props) {\n  // âš ï¸ createRows() æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šè¢«è°ƒç”¨\n  const [rows, setRows] = useState(createRows(props.count));\n  // ...\n}\n")])])]),a("p",[e._v("ä¸ºé¿å…é‡æ–°åˆ›å»ºè¢«å¿½ç•¥çš„åˆå§‹ stateï¼Œæˆ‘ä»¬å¯ä»¥ä¼ ä¸€ä¸ª "),a("strong",[e._v("å‡½æ•°")]),e._v(" ç»™ "),a("code",[e._v("useState")]),e._v("ï¼š")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("function Table(props) {\n  // âœ… createRows() åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡\n  const [rows, setRows] = useState(() => createRows(props.count));\n  // ...\n}\n")])])]),a("p",[e._v("React åªä¼šåœ¨é¦–æ¬¡æ¸²æŸ“æ—¶è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚å‚è§ "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-reference.html#usestate",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("useState")]),e._v(" API å‚è€ƒ"),a("OutboundLink")],1),e._v("ã€‚")]),e._v(" "),a("p",[e._v("**ä½ æˆ–è®¸ä¹Ÿä¼šå¶å°”æƒ³è¦é¿å…é‡æ–°åˆ›å»º "),a("code",[e._v("useRef()")]),e._v(" çš„åˆå§‹å€¼ã€‚**ä¸¾ä¸ªä¾‹å­ï¼Œæˆ–è®¸ä½ æƒ³ç¡®ä¿æŸäº›å‘½ä»¤å¼çš„ class å®ä¾‹åªè¢«åˆ›å»ºä¸€æ¬¡ï¼š")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("function Image(props) {\n  // âš ï¸ IntersectionObserver åœ¨æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šè¢«åˆ›å»º\n  const ref = useRef(new IntersectionObserver(onIntersect));\n  // ...\n}\n")])])]),a("p",[a("code",[e._v("useRef")]),e._v(" "),a("strong",[e._v("ä¸ä¼š")]),e._v(" åƒ "),a("code",[e._v("useState")]),e._v(" é‚£æ ·æ¥å—ä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°é‡è½½ã€‚ç›¸åï¼Œä½ å¯ä»¥ç¼–å†™ä½ è‡ªå·±çš„å‡½æ•°æ¥åˆ›å»ºå¹¶å°†å…¶è®¾ä¸ºæƒ°æ€§çš„ï¼š")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("function Image(props) {\n  const ref = useRef(null);\n\n  // âœ… IntersectionObserver åªä¼šè¢«æƒ°æ€§åˆ›å»ºä¸€æ¬¡\n  function getObserver() {\n    if (ref.current === null) {\n      ref.current = new IntersectionObserver(onIntersect);\n    }\n    return ref.current;\n  }\n\n  // å½“ä½ éœ€è¦æ—¶ï¼Œè°ƒç”¨ getObserver()\n  // ...\n}\n")])])]),a("p",[e._v("è¿™é¿å…äº†æˆ‘ä»¬åœ¨ä¸€ä¸ªå¯¹è±¡è¢«é¦–æ¬¡çœŸæ­£éœ€è¦ä¹‹å‰å°±åˆ›å»ºå®ƒã€‚å¦‚æœä½ ä½¿ç”¨ Flow æˆ– TypeScriptï¼Œä½ è¿˜å¯ä»¥ä¸ºäº†æ–¹ä¾¿ç»™ "),a("code",[e._v("getObserver()")]),e._v(" ä¸€ä¸ªä¸å¯ä¸º null çš„ç±»å‹ã€‚")]),e._v(" "),a("h3",{attrs:{id:"hook-ä¼šå› ä¸ºåœ¨æ¸²æŸ“æ—¶åˆ›å»ºå‡½æ•°è€Œå˜æ…¢å—"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hook-ä¼šå› ä¸ºåœ¨æ¸²æŸ“æ—¶åˆ›å»ºå‡½æ•°è€Œå˜æ…¢å—"}},[e._v("#")]),e._v(" Hook ä¼šå› ä¸ºåœ¨æ¸²æŸ“æ—¶åˆ›å»ºå‡½æ•°è€Œå˜æ…¢å—ï¼Ÿ")]),e._v(" "),a("p",[e._v("ä¸ä¼šã€‚åœ¨ç°ä»£æµè§ˆå™¨ä¸­ï¼Œé—­åŒ…å’Œç±»çš„åŸå§‹æ€§èƒ½åªæœ‰åœ¨æç«¯åœºæ™¯ä¸‹æ‰ä¼šæœ‰æ˜æ˜¾çš„å·®åˆ«ã€‚")]),e._v(" "),a("p",[e._v("é™¤æ­¤ä¹‹å¤–ï¼Œå¯ä»¥è®¤ä¸º Hook çš„è®¾è®¡åœ¨æŸäº›æ–¹é¢æ›´åŠ é«˜æ•ˆï¼š")]),e._v(" "),a("ul",[a("li",[e._v("Hook é¿å…äº† class éœ€è¦çš„é¢å¤–å¼€æ”¯ï¼Œåƒæ˜¯åˆ›å»ºç±»å®ä¾‹å’Œåœ¨æ„é€ å‡½æ•°ä¸­ç»‘å®šäº‹ä»¶å¤„ç†å™¨çš„æˆæœ¬ã€‚")]),e._v(" "),a("li",[a("strong",[e._v("ç¬¦åˆè¯­è¨€ä¹ æƒ¯çš„ä»£ç åœ¨ä½¿ç”¨ Hook æ—¶ä¸éœ€è¦å¾ˆæ·±çš„ç»„ä»¶æ ‘åµŒå¥—")]),e._v("ã€‚è¿™ä¸ªç°è±¡åœ¨ä½¿ç”¨é«˜é˜¶ç»„ä»¶ã€render propsã€å’Œ context çš„ä»£ç åº“ä¸­éå¸¸æ™®éã€‚ç»„ä»¶æ ‘å°äº†ï¼ŒReact çš„å·¥ä½œé‡ä¹Ÿéšä¹‹å‡å°‘ã€‚")])]),e._v(" "),a("p",[e._v("ä¼ ç»Ÿä¸Šè®¤ä¸ºï¼Œåœ¨ React ä¸­ä½¿ç”¨å†…è”å‡½æ•°å¯¹æ€§èƒ½çš„å½±å“ï¼Œä¸æ¯æ¬¡æ¸²æŸ“éƒ½ä¼ é€’æ–°çš„å›è°ƒä¼šå¦‚ä½•ç ´åå­ç»„ä»¶çš„ "),a("code",[e._v("shouldComponentUpdate")]),e._v(" ä¼˜åŒ–æœ‰å…³ã€‚Hook ä»ä¸‰ä¸ªæ–¹é¢è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚")]),e._v(" "),a("ul",[a("li",[a("p",[a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-reference.html#usecallback",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("useCallback")]),a("OutboundLink")],1),e._v(" Hook å…è®¸ä½ åœ¨é‡æ–°æ¸²æŸ“ä¹‹é—´ä¿æŒå¯¹ç›¸åŒçš„å›è°ƒå¼•ç”¨ä»¥ä½¿å¾— "),a("code",[e._v("shouldComponentUpdate")]),e._v(" ç»§ç»­å·¥ä½œï¼š")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("// é™¤é `a` æˆ– `b` æ”¹å˜ï¼Œå¦åˆ™ä¸ä¼šå˜\nconst memoizedCallback = useCallback(() => {  doSomething(a, b);\n}, [a, b]);\n")])])])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-faq.html#how-to-memoize-calculations",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("useMemo")]),a("OutboundLink")],1),e._v(" Hook ä½¿å¾—æ§åˆ¶å…·ä½“å­èŠ‚ç‚¹ä½•æ—¶æ›´æ–°å˜å¾—æ›´å®¹æ˜“ï¼Œå‡å°‘äº†å¯¹çº¯ç»„ä»¶çš„éœ€è¦ã€‚")])]),e._v(" "),a("li",[a("p",[e._v("æœ€åï¼Œ"),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-reference.html#usereducer",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("useReducer")]),a("OutboundLink")],1),e._v(" Hook å‡å°‘äº†å¯¹æ·±å±‚ä¼ é€’å›è°ƒçš„ä¾èµ–ï¼Œæ­£å¦‚ä¸‹é¢è§£é‡Šçš„é‚£æ ·ã€‚")])])]),e._v(" "),a("h3",{attrs:{id:"å¦‚ä½•é¿å…å‘ä¸‹ä¼ é€’å›è°ƒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¦‚ä½•é¿å…å‘ä¸‹ä¼ é€’å›è°ƒ"}},[e._v("#")]),e._v(" å¦‚ä½•é¿å…å‘ä¸‹ä¼ é€’å›è°ƒï¼Ÿ")]),e._v(" "),a("p",[e._v("æˆ‘ä»¬å·²ç»å‘ç°å¤§éƒ¨åˆ†äººå¹¶ä¸å–œæ¬¢åœ¨ç»„ä»¶æ ‘çš„æ¯ä¸€å±‚æ‰‹åŠ¨ä¼ é€’å›è°ƒã€‚å°½ç®¡è¿™ç§å†™æ³•æ›´æ˜ç¡®ï¼Œä½†è¿™ç»™äººæ„Ÿè§‰åƒé”™ç»¼å¤æ‚çš„ç®¡é“å·¥ç¨‹ä¸€æ ·éº»çƒ¦ã€‚")]),e._v(" "),a("p",[e._v("åœ¨å¤§å‹çš„ç»„ä»¶æ ‘ä¸­ï¼Œæˆ‘ä»¬æ¨èçš„æ›¿ä»£æ–¹æ¡ˆæ˜¯é€šè¿‡ context ç”¨ "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-reference.html#usereducer",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("useReducer")]),a("OutboundLink")],1),e._v(" å¾€ä¸‹ä¼ ä¸€ä¸ª "),a("code",[e._v("dispatch")]),e._v(" å‡½æ•°ï¼š")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("const TodosDispatch = React.createContext(null);\n\nfunction TodosApp() {\n  // æç¤ºï¼š`dispatch` ä¸ä¼šåœ¨é‡æ–°æ¸²æŸ“ä¹‹é—´å˜åŒ–  const [todos, dispatch] = useReducer(todosReducer);\n  return (\n    <TodosDispatch.Provider value={dispatch}>\n      <DeepTree todos={todos} />\n    </TodosDispatch.Provider>\n  );\n}\n")])])]),a("p",[a("code",[e._v("TodosApp")]),e._v(" å†…éƒ¨ç»„ä»¶æ ‘é‡Œçš„ä»»ä½•å­èŠ‚ç‚¹éƒ½å¯ä»¥ä½¿ç”¨ "),a("code",[e._v("dispatch")]),e._v(" å‡½æ•°æ¥å‘ä¸Šä¼ é€’ actions åˆ° "),a("code",[e._v("TodosApp")]),e._v("ï¼š")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("function DeepChild(props) {\n  // å¦‚æœæˆ‘ä»¬æƒ³è¦æ‰§è¡Œä¸€ä¸ª actionï¼Œæˆ‘ä»¬å¯ä»¥ä» context ä¸­è·å– dispatchã€‚  const dispatch = useContext(TodosDispatch);\n  function handleClick() {\n    dispatch({ type: 'add', text: 'hello' });\n  }\n\n  return (\n    <button onClick={handleClick}>Add todo</button>\n  );\n}\n")])])]),a("p",[e._v("æ€»è€Œè¨€ä¹‹ï¼Œä»ç»´æŠ¤çš„è§’åº¦æ¥è¿™æ ·çœ‹æ›´åŠ æ–¹ä¾¿ï¼ˆä¸ç”¨ä¸æ–­è½¬å‘å›è°ƒï¼‰ï¼ŒåŒæ—¶ä¹Ÿé¿å…äº†å›è°ƒçš„é—®é¢˜ã€‚åƒè¿™æ ·å‘ä¸‹ä¼ é€’ "),a("code",[e._v("dispatch")]),e._v(" æ˜¯å¤„ç†æ·±åº¦æ›´æ–°çš„æ¨èæ¨¡å¼ã€‚")]),e._v(" "),a("p",[e._v("æ³¨æ„ï¼Œä½ ä¾ç„¶å¯ä»¥é€‰æ‹©å°†åº”ç”¨çš„ "),a("em",[e._v("state")]),e._v(" ä½œä¸º propsï¼ˆæ›´æ˜¾æ˜ç¡®ï¼‰å‘ä¸‹ä¼ é€’æˆ–è€…ä½¿ç”¨ contextï¼ˆå¯¹å¾ˆæ·±çš„æ›´æ–°è€Œè¨€æ›´åŠ æ–¹ä¾¿ï¼‰å‘ä¸‹ä¼ é€’ã€‚å¦‚æœä½ é€‰æ‹©ä½¿ç”¨ context æ¥å‘ä¸‹ä¼ é€’ stateï¼Œè¯·ä½¿ç”¨ä¸¤ç§ä¸åŒçš„ context ç±»å‹ä¼ é€’ state å’Œ dispatch â€”â€” ç”±äº "),a("code",[e._v("dispatch")]),e._v(" context æ°¸è¿œä¸ä¼šå˜ï¼Œå› æ­¤è¯»å–å®ƒçš„ç»„ä»¶ä¸éœ€è¦é‡æ–°æ¸²æŸ“ï¼Œé™¤éè¿™äº›ç»„ä»¶ä¹Ÿéœ€è¦ç”¨åˆ°åº”ç”¨ç¨‹åºçš„ stateã€‚")]),e._v(" "),a("h3",{attrs:{id:"å¦‚ä½•ä»-usecallback-è¯»å–ä¸€ä¸ªç»å¸¸å˜åŒ–çš„å€¼"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¦‚ä½•ä»-usecallback-è¯»å–ä¸€ä¸ªç»å¸¸å˜åŒ–çš„å€¼"}},[e._v("#")]),e._v(" å¦‚ä½•ä» "),a("code",[e._v("useCallback")]),e._v(" è¯»å–ä¸€ä¸ªç»å¸¸å˜åŒ–çš„å€¼ï¼Ÿ")]),e._v(" "),a("blockquote",[a("p",[e._v("æ³¨æ„")]),e._v(" "),a("p",[e._v("æˆ‘ä»¬æ¨è "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-faq.html#how-to-avoid-passing-callbacks-down",target:"_blank",rel:"noopener noreferrer"}},[e._v("åœ¨ context ä¸­å‘ä¸‹ä¼ é€’ "),a("code",[e._v("dispatch")]),a("OutboundLink")],1),e._v(" è€Œéåœ¨ props ä¸­ä½¿ç”¨ç‹¬ç«‹çš„å›è°ƒã€‚ä¸‹é¢çš„æ–¹æ³•ä»…ä»…å‡ºäºæ–‡æ¡£å®Œæ•´æ€§è€ƒè™‘ï¼Œä»¥åŠä½œä¸ºä¸€æ¡å‡ºè·¯åœ¨æ­¤æåŠã€‚")])]),e._v(" "),a("p",[e._v("åœ¨æŸäº›ç½•è§åœºæ™¯ä¸­ï¼Œä½ å¯èƒ½ä¼šéœ€è¦ç”¨ "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-reference.html#usecallback",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("useCallback")]),a("OutboundLink")],1),e._v(" è®°ä½ä¸€ä¸ªå›è°ƒï¼Œä½†ç”±äºå†…éƒ¨å‡½æ•°å¿…é¡»ç»å¸¸é‡æ–°åˆ›å»ºï¼Œè®°å¿†æ•ˆæœä¸æ˜¯å¾ˆå¥½ã€‚å¦‚æœä½ æƒ³è¦è®°ä½çš„å‡½æ•°æ˜¯ä¸€ä¸ªäº‹ä»¶å¤„ç†å™¨å¹¶ä¸”åœ¨æ¸²æŸ“æœŸé—´æ²¡æœ‰è¢«ç”¨åˆ°ï¼Œä½ å¯ä»¥ "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-faq.html#is-there-something-like-instance-variables",target:"_blank",rel:"noopener noreferrer"}},[e._v("æŠŠ ref å½“åšå®ä¾‹å˜é‡"),a("OutboundLink")],1),e._v(" æ¥ç”¨ï¼Œå¹¶æ‰‹åŠ¨æŠŠæœ€åæäº¤çš„å€¼ä¿å­˜åœ¨å®ƒå½“ä¸­ï¼š")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("function Form() {\n  const [text, updateText] = useState('');\n  const textRef = useRef();\n\n  useEffect(() => {\n    textRef.current = text; // æŠŠå®ƒå†™å…¥ ref  });\n\n  const handleSubmit = useCallback(() => {\n    const currentText = textRef.current; // ä» ref è¯»å–å®ƒ    alert(currentText);\n  }, [textRef]); // ä¸è¦åƒ [text] é‚£æ ·é‡æ–°åˆ›å»º handleSubmit\n\n  return (\n    <>\n      <input value={text} onChange={e => updateText(e.target.value)} />\n      <ExpensiveTree onSubmit={handleSubmit} />\n    </>\n  );\n}\n")])])]),a("p",[e._v("è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒéº»çƒ¦çš„æ¨¡å¼ï¼Œä½†è¿™è¡¨ç¤ºå¦‚æœä½ éœ€è¦çš„è¯ä½ å¯ä»¥ç”¨è¿™æ¡å‡ºè·¯è¿›è¡Œä¼˜åŒ–ã€‚å¦‚æœä½ æŠŠå®ƒæŠ½å–æˆä¸€ä¸ªè‡ªå®šä¹‰ Hook çš„è¯ä¼šæ›´åŠ å¥½å—äº›ï¼š")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("function Form() {\n  const [text, updateText] = useState('');\n  // å³ä¾¿ `text` å˜äº†ä¹Ÿä¼šè¢«è®°ä½:\n  const handleSubmit = useEventCallback(() => {    alert(text);\n  }, [text]);\n\n  return (\n    <>\n      <input value={text} onChange={e => updateText(e.target.value)} />\n      <ExpensiveTree onSubmit={handleSubmit} />\n    </>\n  );\n}\n\nfunction useEventCallback(fn, dependencies) {  const ref = useRef(() => {\n    throw new Error('Cannot call an event handler while rendering.');\n  });\n\n  useEffect(() => {\n    ref.current = fn;\n  }, [fn, ...dependencies]);\n\n  return useCallback(() => {\n    const fn = ref.current;\n    return fn();\n  }, [ref]);\n}\n")])])]),a("p",[e._v("æ— è®ºå¦‚ä½•ï¼Œæˆ‘ä»¬éƒ½ "),a("strong",[e._v("ä¸æ¨èä½¿ç”¨è¿™ç§æ¨¡å¼")]),e._v(" ï¼Œåªæ˜¯ä¸ºäº†æ–‡æ¡£çš„å®Œæ•´æ€§è€ŒæŠŠå®ƒå±•ç¤ºåœ¨è¿™é‡Œã€‚ç›¸åçš„ï¼Œæˆ‘ä»¬æ›´å€¾å‘äº "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-faq.html#how-to-avoid-passing-callbacks-down",target:"_blank",rel:"noopener noreferrer"}},[e._v("é¿å…å‘ä¸‹æ·±å…¥ä¼ é€’å›è°ƒ"),a("OutboundLink")],1),e._v("ã€‚")]),e._v(" "),a("h2",{attrs:{id:"åº•å±‚åŸç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åº•å±‚åŸç†"}},[e._v("#")]),e._v(" åº•å±‚åŸç†")]),e._v(" "),a("h3",{attrs:{id:"react-æ˜¯å¦‚ä½•æŠŠå¯¹-hook-çš„è°ƒç”¨å’Œç»„ä»¶è”ç³»èµ·æ¥çš„"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#react-æ˜¯å¦‚ä½•æŠŠå¯¹-hook-çš„è°ƒç”¨å’Œç»„ä»¶è”ç³»èµ·æ¥çš„"}},[e._v("#")]),e._v(" React æ˜¯å¦‚ä½•æŠŠå¯¹ Hook çš„è°ƒç”¨å’Œç»„ä»¶è”ç³»èµ·æ¥çš„ï¼Ÿ")]),e._v(" "),a("p",[e._v("React ä¿æŒå¯¹å½“å‰æ¸²æŸ“ä¸­çš„ç»„ä»¶çš„è¿½è¸ªã€‚å¤šäºäº† "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-rules.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Hook è§„èŒƒ"),a("OutboundLink")],1),e._v("ï¼Œæˆ‘ä»¬å¾—çŸ¥ Hook åªä¼šåœ¨ React ç»„ä»¶ä¸­è¢«è°ƒç”¨ï¼ˆæˆ–è‡ªå®šä¹‰ Hook â€”â€” åŒæ ·åªä¼šåœ¨ React ç»„ä»¶ä¸­è¢«è°ƒç”¨ï¼‰ã€‚")]),e._v(" "),a("p",[e._v("æ¯ä¸ªç»„ä»¶å†…éƒ¨éƒ½æœ‰ä¸€ä¸ªã€Œè®°å¿†å•å…ƒæ ¼ã€åˆ—è¡¨ã€‚å®ƒä»¬åªä¸è¿‡æ˜¯æˆ‘ä»¬ç”¨æ¥å­˜å‚¨ä¸€äº›æ•°æ®çš„ JavaScript å¯¹è±¡ã€‚å½“ä½ ç”¨ "),a("code",[e._v("useState()")]),e._v(" è°ƒç”¨ä¸€ä¸ª Hook çš„æ—¶å€™ï¼Œå®ƒä¼šè¯»å–å½“å‰çš„å•å…ƒæ ¼ï¼ˆæˆ–åœ¨é¦–æ¬¡æ¸²æŸ“æ—¶å°†å…¶åˆå§‹åŒ–ï¼‰ï¼Œç„¶åæŠŠæŒ‡é’ˆç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªã€‚è¿™å°±æ˜¯å¤šä¸ª "),a("code",[e._v("useState()")]),e._v(" è°ƒç”¨ä¼šå¾—åˆ°å„è‡ªç‹¬ç«‹çš„æœ¬åœ° state çš„åŸå› ã€‚")])])}),[],!1,null,null,null);t.default=s.exports}}]);