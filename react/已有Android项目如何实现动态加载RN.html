<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>小白学习：已有 Android 项目如何实现动态加载 RN bundle | 高小哥漫谈前端</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/icons/icon.png">
    <script src="/jquery/jquery.slim.min.js"></script>
    <script src="/card-link/index.js"></script>
    <script src="/readmore/index.js"></script>
    <link rel="stylesheet" type="text/css" href="/jquery/jquery.fancybox.min.css">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?9cfd884fe46fc31072811d47a486a552";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?9b661d4664669986af91448c055407cb";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    <script src="/jquery/jquery.fancybox.min.js"></script>
    <meta name="description" content="旨在分享对技术的了解">
    <meta name="google-site-verification" content="Wb79TZlc0Jau32a2Iph43MkdTZTvx75ZdHEOvRmxuoo">
    <meta name="baidu-site-verification" content="code-V304SBt3wm">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.10be55ec.css" as="style"><link rel="preload" href="/assets/js/app.4d95cff4.js" as="script"><link rel="preload" href="/assets/js/6.998d065f.js" as="script"><link rel="preload" href="/assets/js/4.ef7f550c.js" as="script"><link rel="preload" href="/assets/js/235.89d1c10d.js" as="script"><link rel="prefetch" href="/assets/js/1.de94f3a9.js"><link rel="prefetch" href="/assets/js/10.df8a388a.js"><link rel="prefetch" href="/assets/js/100.b959dd4a.js"><link rel="prefetch" href="/assets/js/101.e56b8d9b.js"><link rel="prefetch" href="/assets/js/102.5f0a3510.js"><link rel="prefetch" href="/assets/js/103.5c5d99bd.js"><link rel="prefetch" href="/assets/js/104.50b49eff.js"><link rel="prefetch" href="/assets/js/105.d649d305.js"><link rel="prefetch" href="/assets/js/106.ba105091.js"><link rel="prefetch" href="/assets/js/107.ec5b8ff9.js"><link rel="prefetch" href="/assets/js/108.08bfaa32.js"><link rel="prefetch" href="/assets/js/109.83c7e5b0.js"><link rel="prefetch" href="/assets/js/11.4386e5f9.js"><link rel="prefetch" href="/assets/js/110.6a8e58d4.js"><link rel="prefetch" href="/assets/js/111.736579c7.js"><link rel="prefetch" href="/assets/js/112.c3cd3791.js"><link rel="prefetch" href="/assets/js/113.15d4a153.js"><link rel="prefetch" href="/assets/js/114.64300cb6.js"><link rel="prefetch" href="/assets/js/115.640ae4eb.js"><link rel="prefetch" href="/assets/js/116.3aed287e.js"><link rel="prefetch" href="/assets/js/117.34b8cf7f.js"><link rel="prefetch" href="/assets/js/118.c27dc0f7.js"><link rel="prefetch" href="/assets/js/119.9443ef56.js"><link rel="prefetch" href="/assets/js/12.5948dde1.js"><link rel="prefetch" href="/assets/js/120.3427443a.js"><link rel="prefetch" href="/assets/js/121.23e032c5.js"><link rel="prefetch" href="/assets/js/122.8bc359fd.js"><link rel="prefetch" href="/assets/js/123.cddea1d7.js"><link rel="prefetch" href="/assets/js/124.993e27b5.js"><link rel="prefetch" href="/assets/js/125.808a7777.js"><link rel="prefetch" href="/assets/js/126.5c6af246.js"><link rel="prefetch" href="/assets/js/127.fc8e0b76.js"><link rel="prefetch" href="/assets/js/128.6a9d89cc.js"><link rel="prefetch" href="/assets/js/129.6857fa05.js"><link rel="prefetch" href="/assets/js/13.7711c791.js"><link rel="prefetch" href="/assets/js/130.b43d626e.js"><link rel="prefetch" href="/assets/js/131.0a1ce825.js"><link rel="prefetch" href="/assets/js/132.73f1e3e2.js"><link rel="prefetch" href="/assets/js/133.00064200.js"><link rel="prefetch" href="/assets/js/134.8e400635.js"><link rel="prefetch" href="/assets/js/135.664b93eb.js"><link rel="prefetch" href="/assets/js/136.824ffafb.js"><link rel="prefetch" href="/assets/js/137.c6f1891d.js"><link rel="prefetch" href="/assets/js/138.3350ee92.js"><link rel="prefetch" href="/assets/js/139.eec62651.js"><link rel="prefetch" href="/assets/js/14.19b7f5c0.js"><link rel="prefetch" href="/assets/js/140.86485697.js"><link rel="prefetch" href="/assets/js/141.d4e6dd1a.js"><link rel="prefetch" href="/assets/js/142.4ffdd7c7.js"><link rel="prefetch" href="/assets/js/143.4fa0bc5e.js"><link rel="prefetch" href="/assets/js/144.efd188a1.js"><link rel="prefetch" href="/assets/js/145.732b37a5.js"><link rel="prefetch" href="/assets/js/146.6fbc9496.js"><link rel="prefetch" href="/assets/js/147.6272170d.js"><link rel="prefetch" href="/assets/js/148.1c9188d5.js"><link rel="prefetch" href="/assets/js/149.2c5aea26.js"><link rel="prefetch" href="/assets/js/15.f77a0342.js"><link rel="prefetch" href="/assets/js/150.ce31d42f.js"><link rel="prefetch" href="/assets/js/151.e3ae83b7.js"><link rel="prefetch" href="/assets/js/152.54cf4d00.js"><link rel="prefetch" href="/assets/js/153.13dbbaab.js"><link rel="prefetch" href="/assets/js/154.45bc2b02.js"><link rel="prefetch" href="/assets/js/155.f02e244e.js"><link rel="prefetch" href="/assets/js/156.c9e0676e.js"><link rel="prefetch" href="/assets/js/157.4b2ad9ba.js"><link rel="prefetch" href="/assets/js/158.0fd365d3.js"><link rel="prefetch" href="/assets/js/159.5bd54c3d.js"><link rel="prefetch" href="/assets/js/16.e29bf183.js"><link rel="prefetch" href="/assets/js/160.09363dcd.js"><link rel="prefetch" href="/assets/js/161.f670ee6c.js"><link rel="prefetch" href="/assets/js/162.f86c6140.js"><link rel="prefetch" href="/assets/js/163.3e445d41.js"><link rel="prefetch" href="/assets/js/164.951de923.js"><link rel="prefetch" href="/assets/js/165.c3c7fcbb.js"><link rel="prefetch" href="/assets/js/166.033f7a73.js"><link rel="prefetch" href="/assets/js/167.b5a87ee9.js"><link rel="prefetch" href="/assets/js/168.c9897e83.js"><link rel="prefetch" href="/assets/js/169.19522ce0.js"><link rel="prefetch" href="/assets/js/17.b1f3ba64.js"><link rel="prefetch" href="/assets/js/170.4e3b82c7.js"><link rel="prefetch" href="/assets/js/171.f008751e.js"><link rel="prefetch" href="/assets/js/172.2c4802ed.js"><link rel="prefetch" href="/assets/js/173.16432568.js"><link rel="prefetch" href="/assets/js/174.dcebbef9.js"><link rel="prefetch" href="/assets/js/175.8c44db93.js"><link rel="prefetch" href="/assets/js/176.776c3c27.js"><link rel="prefetch" href="/assets/js/177.9ca23670.js"><link rel="prefetch" href="/assets/js/178.22104a3d.js"><link rel="prefetch" href="/assets/js/179.353eb9a6.js"><link rel="prefetch" href="/assets/js/18.5adb16cc.js"><link rel="prefetch" href="/assets/js/180.d8577b39.js"><link rel="prefetch" href="/assets/js/181.7debb4a4.js"><link rel="prefetch" href="/assets/js/182.f6deee92.js"><link rel="prefetch" href="/assets/js/183.535a4b21.js"><link rel="prefetch" href="/assets/js/184.1f881772.js"><link rel="prefetch" href="/assets/js/185.811a3874.js"><link rel="prefetch" href="/assets/js/186.710cb605.js"><link rel="prefetch" href="/assets/js/187.adf3d05f.js"><link rel="prefetch" href="/assets/js/188.c17bbc1c.js"><link rel="prefetch" href="/assets/js/189.a7ee1c93.js"><link rel="prefetch" href="/assets/js/19.4c53235e.js"><link rel="prefetch" href="/assets/js/190.5f8ba9ed.js"><link rel="prefetch" href="/assets/js/191.a957c1d2.js"><link rel="prefetch" href="/assets/js/192.c81eafc2.js"><link rel="prefetch" href="/assets/js/193.e99f793b.js"><link rel="prefetch" href="/assets/js/194.685cac0c.js"><link rel="prefetch" href="/assets/js/195.10e577cc.js"><link rel="prefetch" href="/assets/js/196.cec0b1fb.js"><link rel="prefetch" href="/assets/js/197.47b88fbd.js"><link rel="prefetch" href="/assets/js/198.9c1cb559.js"><link rel="prefetch" href="/assets/js/199.245ee904.js"><link rel="prefetch" href="/assets/js/2.c244ca95.js"><link rel="prefetch" href="/assets/js/20.7919eb58.js"><link rel="prefetch" href="/assets/js/200.43fc59c7.js"><link rel="prefetch" href="/assets/js/201.389f6f10.js"><link rel="prefetch" href="/assets/js/202.4de39fac.js"><link rel="prefetch" href="/assets/js/203.fbe38395.js"><link rel="prefetch" href="/assets/js/204.b0875ad3.js"><link rel="prefetch" href="/assets/js/205.60dd2b9b.js"><link rel="prefetch" href="/assets/js/206.27b591dd.js"><link rel="prefetch" href="/assets/js/207.c7719fca.js"><link rel="prefetch" href="/assets/js/208.690de1f3.js"><link rel="prefetch" href="/assets/js/209.29a5fe97.js"><link rel="prefetch" href="/assets/js/21.5cdb8d1a.js"><link rel="prefetch" href="/assets/js/210.31661aa1.js"><link rel="prefetch" href="/assets/js/211.101ecfde.js"><link rel="prefetch" href="/assets/js/212.8253cdc0.js"><link rel="prefetch" href="/assets/js/213.7d5b033c.js"><link rel="prefetch" href="/assets/js/214.0e3b471a.js"><link rel="prefetch" href="/assets/js/215.833f0d37.js"><link rel="prefetch" href="/assets/js/216.dcc30b1d.js"><link rel="prefetch" href="/assets/js/217.9bb804ea.js"><link rel="prefetch" href="/assets/js/218.65a048b1.js"><link rel="prefetch" href="/assets/js/219.77a4eb8c.js"><link rel="prefetch" href="/assets/js/22.0ac898ac.js"><link rel="prefetch" href="/assets/js/220.aa2f91bc.js"><link rel="prefetch" href="/assets/js/221.45dbc30c.js"><link rel="prefetch" href="/assets/js/222.93092a7e.js"><link rel="prefetch" href="/assets/js/223.b3730661.js"><link rel="prefetch" href="/assets/js/224.369b4d22.js"><link rel="prefetch" href="/assets/js/225.0968cc2c.js"><link rel="prefetch" href="/assets/js/226.0f124032.js"><link rel="prefetch" href="/assets/js/227.579428ea.js"><link rel="prefetch" href="/assets/js/228.e24ca2d6.js"><link rel="prefetch" href="/assets/js/229.f59a7ff0.js"><link rel="prefetch" href="/assets/js/23.9e6827e8.js"><link rel="prefetch" href="/assets/js/230.fd341e47.js"><link rel="prefetch" href="/assets/js/231.07f75c78.js"><link rel="prefetch" href="/assets/js/232.f4870cfe.js"><link rel="prefetch" href="/assets/js/233.d760073a.js"><link rel="prefetch" href="/assets/js/234.d05370b6.js"><link rel="prefetch" href="/assets/js/236.a2aec3c4.js"><link rel="prefetch" href="/assets/js/237.a9e3a444.js"><link rel="prefetch" href="/assets/js/238.2283d291.js"><link rel="prefetch" href="/assets/js/239.23a78ab0.js"><link rel="prefetch" href="/assets/js/24.8517131c.js"><link rel="prefetch" href="/assets/js/240.a8b685a4.js"><link rel="prefetch" href="/assets/js/241.d4b10542.js"><link rel="prefetch" href="/assets/js/242.628b3b8b.js"><link rel="prefetch" href="/assets/js/243.ba4db13f.js"><link rel="prefetch" href="/assets/js/244.e24abc1a.js"><link rel="prefetch" href="/assets/js/245.69963a13.js"><link rel="prefetch" href="/assets/js/246.211e26ed.js"><link rel="prefetch" href="/assets/js/247.24394d6e.js"><link rel="prefetch" href="/assets/js/248.01860d10.js"><link rel="prefetch" href="/assets/js/249.c56dc04c.js"><link rel="prefetch" href="/assets/js/25.9a16ba55.js"><link rel="prefetch" href="/assets/js/250.9c93fcc4.js"><link rel="prefetch" href="/assets/js/251.184a0627.js"><link rel="prefetch" href="/assets/js/252.74e6054b.js"><link rel="prefetch" href="/assets/js/253.0d92cd63.js"><link rel="prefetch" href="/assets/js/254.6e5e85a3.js"><link rel="prefetch" href="/assets/js/255.e0bc7641.js"><link rel="prefetch" href="/assets/js/256.c0efe423.js"><link rel="prefetch" href="/assets/js/257.c26ce970.js"><link rel="prefetch" href="/assets/js/258.5c2a38f6.js"><link rel="prefetch" href="/assets/js/26.7c861740.js"><link rel="prefetch" href="/assets/js/27.50d4cb2e.js"><link rel="prefetch" href="/assets/js/28.070d2936.js"><link rel="prefetch" href="/assets/js/29.ba3d00e2.js"><link rel="prefetch" href="/assets/js/3.781e1664.js"><link rel="prefetch" href="/assets/js/30.5f31de44.js"><link rel="prefetch" href="/assets/js/31.0ca3681d.js"><link rel="prefetch" href="/assets/js/32.575a53a4.js"><link rel="prefetch" href="/assets/js/33.87e38398.js"><link rel="prefetch" href="/assets/js/34.c3b1ed0c.js"><link rel="prefetch" href="/assets/js/35.5f6f939e.js"><link rel="prefetch" href="/assets/js/36.051ab020.js"><link rel="prefetch" href="/assets/js/37.3898aba1.js"><link rel="prefetch" href="/assets/js/38.ec4e7273.js"><link rel="prefetch" href="/assets/js/39.e965c7b1.js"><link rel="prefetch" href="/assets/js/40.dd9d463b.js"><link rel="prefetch" href="/assets/js/41.834ca794.js"><link rel="prefetch" href="/assets/js/42.9a926356.js"><link rel="prefetch" href="/assets/js/43.a110f26a.js"><link rel="prefetch" href="/assets/js/44.517b6453.js"><link rel="prefetch" href="/assets/js/45.2e3ffad8.js"><link rel="prefetch" href="/assets/js/46.64ca853b.js"><link rel="prefetch" href="/assets/js/47.1d99e6fd.js"><link rel="prefetch" href="/assets/js/48.c0a4388c.js"><link rel="prefetch" href="/assets/js/49.0934e7b8.js"><link rel="prefetch" href="/assets/js/50.1f5d0020.js"><link rel="prefetch" href="/assets/js/51.97381699.js"><link rel="prefetch" href="/assets/js/52.0cac5e38.js"><link rel="prefetch" href="/assets/js/53.1a20a280.js"><link rel="prefetch" href="/assets/js/54.2b113e4f.js"><link rel="prefetch" href="/assets/js/55.7a6907de.js"><link rel="prefetch" href="/assets/js/56.87587279.js"><link rel="prefetch" href="/assets/js/57.f5a89a97.js"><link rel="prefetch" href="/assets/js/58.e4e47d5b.js"><link rel="prefetch" href="/assets/js/59.8d8ed7d0.js"><link rel="prefetch" href="/assets/js/60.18fde9f9.js"><link rel="prefetch" href="/assets/js/61.935e5d9b.js"><link rel="prefetch" href="/assets/js/62.52cca68f.js"><link rel="prefetch" href="/assets/js/63.3dcff674.js"><link rel="prefetch" href="/assets/js/64.3247a580.js"><link rel="prefetch" href="/assets/js/65.d7176d1f.js"><link rel="prefetch" href="/assets/js/66.707ef46b.js"><link rel="prefetch" href="/assets/js/67.c08547e7.js"><link rel="prefetch" href="/assets/js/68.57a50abc.js"><link rel="prefetch" href="/assets/js/69.1ba2c3b1.js"><link rel="prefetch" href="/assets/js/7.40d236cb.js"><link rel="prefetch" href="/assets/js/70.719d3a16.js"><link rel="prefetch" href="/assets/js/71.3e76d2ba.js"><link rel="prefetch" href="/assets/js/72.b9f80a03.js"><link rel="prefetch" href="/assets/js/73.1a3cbf43.js"><link rel="prefetch" href="/assets/js/74.6e4ad547.js"><link rel="prefetch" href="/assets/js/75.a41fe85a.js"><link rel="prefetch" href="/assets/js/76.9bdcfde3.js"><link rel="prefetch" href="/assets/js/77.cc32eaae.js"><link rel="prefetch" href="/assets/js/78.eccaba22.js"><link rel="prefetch" href="/assets/js/79.10e2c5d9.js"><link rel="prefetch" href="/assets/js/8.5226ea30.js"><link rel="prefetch" href="/assets/js/80.5804ee96.js"><link rel="prefetch" href="/assets/js/81.2d3b336f.js"><link rel="prefetch" href="/assets/js/82.cb9a43fd.js"><link rel="prefetch" href="/assets/js/83.a5cdc51d.js"><link rel="prefetch" href="/assets/js/84.9b131c0f.js"><link rel="prefetch" href="/assets/js/85.edde6e37.js"><link rel="prefetch" href="/assets/js/86.abd8ea74.js"><link rel="prefetch" href="/assets/js/87.d3f57ff7.js"><link rel="prefetch" href="/assets/js/88.98a93ecd.js"><link rel="prefetch" href="/assets/js/89.15fb0d44.js"><link rel="prefetch" href="/assets/js/9.f81d7648.js"><link rel="prefetch" href="/assets/js/90.52bf69ec.js"><link rel="prefetch" href="/assets/js/91.365e19c1.js"><link rel="prefetch" href="/assets/js/92.67ea10fa.js"><link rel="prefetch" href="/assets/js/93.1ba88a03.js"><link rel="prefetch" href="/assets/js/94.c27277e0.js"><link rel="prefetch" href="/assets/js/95.6e3d4d9e.js"><link rel="prefetch" href="/assets/js/96.93079f62.js"><link rel="prefetch" href="/assets/js/97.a160f77c.js"><link rel="prefetch" href="/assets/js/98.fbc80c8c.js"><link rel="prefetch" href="/assets/js/99.e15a687d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.10be55ec.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/header.png" alt="高小哥漫谈前端" class="logo"> <span class="site-name can-hide">高小哥漫谈前端</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/javascript/index.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="http://ai.metaatem.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ChatGPT
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/achievement/index.html" class="nav-link">
  方案及成果
</a></div><div class="nav-item"><a href="/react/index.html" class="nav-link">
  React/RN
</a></div><div class="nav-item"><a href="/vue/index.html" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/lowcode/index.html" class="nav-link">
  低代码
</a></div><div class="nav-item"><a href="/ios/index.html" class="nav-link">
  iOS
</a></div><div class="nav-item"><a href="/iot/index.html" class="nav-link">
  物联网
</a></div><div class="nav-item"><a href="/nodejs/index.html" class="nav-link">
  AI/Node
</a></div><div class="nav-item"><a href="/architecture/index.html" class="nav-link">
  思考/设计模式/UML
</a></div><div class="nav-item"><a href="/other/index.html" class="nav-link">
  Docker/SQL/Git/Nginx
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="提效工具推荐" class="dropdown-title"><span class="title">提效工具推荐</span> <span class="arrow down"></span></button> <button type="button" aria-label="提效工具推荐" class="mobile-dropdown-title"><span class="title">提效工具推荐</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://diffusionbee.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Stable Diffusion 客户端（文本生成图片）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/orgs/nextcloud/repositories" target="_blank" rel="noopener noreferrer" class="nav-link external">
  免费开源的云盘 nextcloud
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/upscayl/upscayl" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AI 将模糊图片变清晰 upscayl
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/yichengchen/clashX" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MAC 翻墙工具 clashX
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/emqx/emqx" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MQTX 协议开源docker emqx
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/wechaty/wechaty" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微信hack工具wechaty
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://app.quicktype.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  将json序列化为代码
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开源" class="dropdown-title"><span class="title">开源</span> <span class="arrow down"></span></button> <button type="button" aria-label="开源" class="mobile-dropdown-title"><span class="title">开源</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/article/oview/index.html" class="nav-link">
  图表库oView
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/luckly_recyclerview" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lucky_recyclerview
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/luckly_popup_window" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lucky_popup_window
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/lucky_tools/blob/master/packages/mendix-cli/README.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue开发Mendix组件脚手架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/cocos-webpack-web" target="_blank" rel="noopener noreferrer" class="nav-link external">
  cocos web端开发
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/ui-designer" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ui 构建器
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/KotlinGank" target="_blank" rel="noopener noreferrer" class="nav-link external">
  kotlin App
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/tensorflow_object_detection" target="_blank" rel="noopener noreferrer" class="nav-link external">
  tensorflow object detection
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/react-native-file-hash-plugin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react-native-file-hash-plugin
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/MrGaoGang/mrgaogang.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/javascript/index.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="http://ai.metaatem.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ChatGPT
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/achievement/index.html" class="nav-link">
  方案及成果
</a></div><div class="nav-item"><a href="/react/index.html" class="nav-link">
  React/RN
</a></div><div class="nav-item"><a href="/vue/index.html" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/lowcode/index.html" class="nav-link">
  低代码
</a></div><div class="nav-item"><a href="/ios/index.html" class="nav-link">
  iOS
</a></div><div class="nav-item"><a href="/iot/index.html" class="nav-link">
  物联网
</a></div><div class="nav-item"><a href="/nodejs/index.html" class="nav-link">
  AI/Node
</a></div><div class="nav-item"><a href="/architecture/index.html" class="nav-link">
  思考/设计模式/UML
</a></div><div class="nav-item"><a href="/other/index.html" class="nav-link">
  Docker/SQL/Git/Nginx
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="提效工具推荐" class="dropdown-title"><span class="title">提效工具推荐</span> <span class="arrow down"></span></button> <button type="button" aria-label="提效工具推荐" class="mobile-dropdown-title"><span class="title">提效工具推荐</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://diffusionbee.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Stable Diffusion 客户端（文本生成图片）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/orgs/nextcloud/repositories" target="_blank" rel="noopener noreferrer" class="nav-link external">
  免费开源的云盘 nextcloud
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/upscayl/upscayl" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AI 将模糊图片变清晰 upscayl
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/yichengchen/clashX" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MAC 翻墙工具 clashX
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/emqx/emqx" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MQTX 协议开源docker emqx
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/wechaty/wechaty" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微信hack工具wechaty
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://app.quicktype.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  将json序列化为代码
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开源" class="dropdown-title"><span class="title">开源</span> <span class="arrow down"></span></button> <button type="button" aria-label="开源" class="mobile-dropdown-title"><span class="title">开源</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/article/oview/index.html" class="nav-link">
  图表库oView
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/luckly_recyclerview" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lucky_recyclerview
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/luckly_popup_window" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lucky_popup_window
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/lucky_tools/blob/master/packages/mendix-cli/README.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue开发Mendix组件脚手架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/cocos-webpack-web" target="_blank" rel="noopener noreferrer" class="nav-link external">
  cocos web端开发
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/ui-designer" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ui 构建器
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/KotlinGank" target="_blank" rel="noopener noreferrer" class="nav-link external">
  kotlin App
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/tensorflow_object_detection" target="_blank" rel="noopener noreferrer" class="nav-link external">
  tensorflow object detection
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/MrGaoGang/react-native-file-hash-plugin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react-native-file-hash-plugin
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/MrGaoGang/mrgaogang.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>小白学习：已有 Android 项目如何实现动态加载 RN bundle</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/react/%E5%B7%B2%E6%9C%89Android%E9%A1%B9%E7%9B%AE%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BDRN.html#一、rn-加载流程简析" class="sidebar-link">一、RN 加载流程简析</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/react/%E5%B7%B2%E6%9C%89Android%E9%A1%B9%E7%9B%AE%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BDRN.html#二、动态加载工程实现" class="sidebar-link">二、动态加载工程实现</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/react/%E5%B7%B2%E6%9C%89Android%E9%A1%B9%E7%9B%AE%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BDRN.html#_1、工程搭建" class="sidebar-link">1、工程搭建</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/react/%E5%B7%B2%E6%9C%89Android%E9%A1%B9%E7%9B%AE%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BDRN.html#_2、后端服务编写" class="sidebar-link">2、后端服务编写</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/react/%E5%B7%B2%E6%9C%89Android%E9%A1%B9%E7%9B%AE%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BDRN.html#_3、android-工程改造" class="sidebar-link">3、Android 工程改造</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/react/%E5%B7%B2%E6%9C%89Android%E9%A1%B9%E7%9B%AE%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BDRN.html#三、可能会遇到的问题及疑问" class="sidebar-link">三、可能会遇到的问题及疑问</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/react/%E5%B7%B2%E6%9C%89Android%E9%A1%B9%E7%9B%AE%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BDRN.html#四、源码" class="sidebar-link">四、源码</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="ads-main"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAgVBMVEUAAABvb29wcHBwcHBwcHBzc3NwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBvb29vb29ubm5wcHBwcHBwcHBwcHBwcHBubm5wcHBwcHBwcHBvb29wcHBwcHBiYmJvb29qampwcHBwcHDt3O1jAAAAKnRSTlMAVL/WqSr05MZizEAz+97CuFhL77GAd0QuEbyNhHNwPJsl6J5sXQQcDKLHDJAOAAABp0lEQVRYw+2U2ZKCMBBFA4QdHRHZBBR3p///A6csEloTghHfpjhPQFefQLgdMjMzI2PEX/YD+Hh3jStqWo5jmbSKS83+3lD6dAHPrLJIqx/AeLRnLkgsqsO4gEJHfm0SGCSpSy0DvrtLmzBuWs8BRrB+b0DSkBduVS+tRw0bQMzwuRJ5wNhoGqhYOgHjR8tA5VL6mcGQS7/AqEYNq2eDQSE48XSGuL2ahoJdblnFBI5PBrAN0bAExrIr7DAgQ6G0AA0iWbcEyD8JyQAWPGdbEMnZGj07InB3YcwQ95uAX4XgFjsqw04UQCEISng1mEMCDxBpG2tmyNEgrbfEByYRuQds6LnhBxCre+Tg6bJXnUiyAYN9Ef6rat4SPsge9mM+Rmb6cGTlo2iI2StyEsUBewaVwX/9pAtR0PRZ53sUQMeZkFSdQsRXGrIUtI5Fw1EYkJaMkrs87NGwoSZviALR4AFCC/Key1Y24KRosaZdgCMhkzHRZt+6D0MhGHzyAbbfWr3BxDx8hm0LhoZMAw3plwbLniy4mtg/jdLD/mncsH8iNpmZ+bf8ATswhv7fNYeiAAAAAElFTkSuQmCC" class="btn-control"> <div style="display:;"><img src="/assets/img/weixin-blog.311ae013.png" class="my-wechat-m"> <div class="coor-tips">
      技术咨询、项目合作、广告投放、简历咨询、技术文档下载
      <a href="https://mp.weixin.qq.com/s?__biz=MzIyMTY4ODMxMg==&mid=2247485385&idx=1&sn=8341f3d51961d47d895fca4d5dddf9da&chksm=e839bf5edf4e364824e70597af29ade5cf33bb628abe64006379e0b955f39f1c5dcd33793ab2#rd" target="__blank">点击这里</a> 联系博主
    </div> </div></div> <div class="theme-default-content content__default"><h1 id="小白学习-已有-android-项目如何实现动态加载-rn-bundle"><a href="#小白学习-已有-android-项目如何实现动态加载-rn-bundle" class="header-anchor">#</a> 小白学习：已有 Android 项目如何实现动态加载 RN bundle</h1> <p>作为小白的我学习 RNWeb 的过程中，在 Now 上看到调试 RN 时只需要输入 Bundle 名称和 module name 就可以打开 RN 页面进行调试，让我滋生了学习动态加载 bundle 展示 rn 页面的想法。在了解如何做动态加载之前，先简单了解一下 RN 加载流程。</p> <h2 id="一、rn-加载流程简析"><a href="#一、rn-加载流程简析" class="header-anchor">#</a> 一、RN 加载流程简析</h2> <p>在使用 RN cli 生成一个项目之后，程序的入口对应用进行注册</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> AppRegistry <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-native&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&quot;./App&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> name <span class="token keyword">as</span> appName <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./app.json&quot;</span><span class="token punctuation">;</span>

AppRegistry<span class="token punctuation">.</span><span class="token function">registerComponent</span><span class="token punctuation">(</span>appName<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> App<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>在<a href="https://github.com/facebook/react-native/blob/master/Libraries/ReactNative/AppRegistry.js" target="_blank" rel="noopener noreferrer">https://github.com/facebook/react-native/blob/master/Libraries/ReactNative/AppRegistry.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中查看<code>registerComponent</code>源码得知，如果要注册多个 RN 应用需要确保<code>appName</code>的唯一性。</p> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token function">registerComponent</span><span class="token punctuation">(</span>
        <span class="token literal-property property">appKey</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
        <span class="token literal-property property">componentProvider</span><span class="token operator">:</span> ComponentProvider<span class="token punctuation">,</span>
        section<span class="token operator">?</span><span class="token operator">:</span> boolean<span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span>
        <span class="token keyword">let</span> scopedPerformanceLogger <span class="token operator">=</span> <span class="token function">createPerformanceLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token comment">//注册过的应用</span>
        runnables<span class="token punctuation">[</span>appKey<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
          componentProvider<span class="token punctuation">,</span>
          <span class="token function-variable function">run</span><span class="token operator">:</span> <span class="token parameter">appParameters</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">renderApplication</span><span class="token punctuation">(</span>
              <span class="token function">componentProviderInstrumentationHook</span><span class="token punctuation">(</span>
                componentProvider<span class="token punctuation">,</span>
                scopedPerformanceLogger<span class="token punctuation">,</span>
              <span class="token punctuation">)</span><span class="token punctuation">,</span>
              appParameters<span class="token punctuation">.</span>initialProps<span class="token punctuation">,</span>
              appParameters<span class="token punctuation">.</span>rootTag<span class="token punctuation">,</span>
              wrapperComponentProvider <span class="token operator">&amp;&amp;</span> <span class="token function">wrapperComponentProvider</span><span class="token punctuation">(</span>appParameters<span class="token punctuation">)</span><span class="token punctuation">,</span>
              appParameters<span class="token punctuation">.</span>fabric<span class="token punctuation">,</span>
              showArchitectureIndicator<span class="token punctuation">,</span>
              scopedPerformanceLogger<span class="token punctuation">,</span>
              appKey <span class="token operator">===</span> <span class="token string">'LogBox'</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>section<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          sections<span class="token punctuation">[</span>appKey<span class="token punctuation">]</span> <span class="token operator">=</span> runnables<span class="token punctuation">[</span>appKey<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> appKey<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>上面已经简单知道了注册 RN 应用，需要传入一个<code>appName</code>和具体渲染的根组件，那么就<code>Android</code>而言，应用是如何启动的呢？打开 Android java 目录可以看到存在两个文件，一个是<code>MainActivity</code>和<code>MainApplication</code> ，熟悉 Android 开发的同学应该都知道<code>MainApplication</code>是一个应用启动类，而<code>MainActivity</code>是应用启动入口（在 AndroidManifast.xml 中注册过）；</p> <p>在<code>MainActivity</code>中需要<strong>返回应用的模块名称也就是在上面 RN 中注册的模块名称</strong>。</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainActivity</span> <span class="token keyword">extends</span> <span class="token class-name">ReactActivity</span> <span class="token punctuation">{</span>

      <span class="token comment">/**
       * Returns the name of the main component registered from JavaScript. This is used to schedule
       * rendering of the component.
       */</span>
      <span class="token annotation punctuation">@Override</span>
      <span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">getMainComponentName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;AwesomeProject&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>而<code>MainApplication</code>继承了<code>ReactApplication</code>，并实现了<code>getReactNativeHost</code>方法。</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainApplication</span> <span class="token keyword">extends</span> <span class="token class-name">Application</span> <span class="token keyword">implements</span> <span class="token class-name">ReactApplication</span> <span class="token punctuation">{</span>

      <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ReactNativeHost</span> mReactNativeHost <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReactNativeHost</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>

      <span class="token annotation punctuation">@Override</span>
      <span class="token keyword">public</span> <span class="token class-name">ReactNativeHost</span> <span class="token function">getReactNativeHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> mReactNativeHost<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token annotation punctuation">@Override</span>
      <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token comment">//官方描述为：自动检查和加载多个有依赖关系的so库文件；SoLoader的主要作用就是作为Java和Javascript两种程序语言之间的通信桥梁</span>
        <span class="token class-name">SoLoader</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token comment">/* native exopackage */</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><p><code>ReactNativeHost</code>是干嘛的？观看源码得知其本身就是一个抽象类，并且具有一系列的抽象方法<code>getJSMainModuleName</code>，<code>getPackages</code>，<code>getJSBundleFile</code>，<code>getBundleAssetName</code>；这似乎和我们想要实现动态加载 js bundle 有点契合，如果我们<strong>手动实现一个<code>ReactNativeHost</code>的类，复写<code>getJSMainModuleName</code>，<code>getBundleAssetName</code>，<code>getJSBundleFile</code>将具体的值改造成远程加载的 js bundle 名称，也许就可实现远程加载</strong>。</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">ReactNativeHost</span> <span class="token punctuation">{</span>
    	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
      <span class="token keyword">protected</span> <span class="token annotation punctuation">@Nullable</span>
      <span class="token class-name">JSIModulePackage</span> <span class="token function">getJSIModulePackage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>


      <span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">getJSMainModuleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;index.android&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">protected</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> <span class="token function">getJSBundleFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>


      <span class="token keyword">protected</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> <span class="token function">getBundleAssetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;index.android.bundle&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

    	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>由于我们是在已有 Android 基础上使用 RN 页面，当点击某个按钮/某个功能的情况下才会加载对应的 js 文件，这似乎在<code>MainApplication</code>处写<code>ReactNativeHost</code>不大合适，那么有没有可能在在一个<code>Activity</code>里面返回自定义的<code>ReactNativeHost</code>的呢？</p> <p>答案是有的。</p> <p>让我们再来看一下啊<code>MainActivity</code>，他继承了 <code>ReactActivity</code>，打开<code>ReactActivity</code>一看，卧槽，就是一个抽象类。</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token comment">/**
     * Base Activity for React Native applications.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">ReactActivity</span> <span class="token keyword">extends</span> <span class="token class-name">Activity</span>
        <span class="token keyword">implements</span> <span class="token class-name">DefaultHardwareBackBtnHandler</span><span class="token punctuation">,</span> <span class="token class-name">PermissionAwareActivity</span> <span class="token punctuation">{</span>

      <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ReactActivityDelegate</span> mDelegate<span class="token punctuation">;</span>

      <span class="token keyword">protected</span> <span class="token class-name">ReactActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mDelegate <span class="token operator">=</span> <span class="token function">createReactActivityDelegate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">protected</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> <span class="token function">getMainComponentName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">protected</span> <span class="token class-name">ReactActivityDelegate</span> <span class="token function">createReactActivityDelegate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ReactActivityDelegate</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token function">getMainComponentName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token annotation punctuation">@Override</span>
      <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mDelegate<span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token comment">//此处省略一些生命周期函数</span>
      <span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">loadApp</span><span class="token punctuation">(</span><span class="token class-name">String</span> appKey<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mDelegate<span class="token punctuation">.</span><span class="token function">loadApp</span><span class="token punctuation">(</span>appKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>其主要作用：</p> <ol><li>提供  <code>getMainComponentName</code>  方法的声明</li> <li>创建  <code>ReactActivityDelegate</code>  实例，便于把具体的功能全<strong>委托</strong>给  <code>ReactActivityDelegate</code>  类来处理</li></ol> <p>既然他把所以的工作都委托给了<code>ReactActivityDelegate</code>那么我们可以在<code>ReactActivityDelegate</code>中找到<code>ReactNativeHost</code>的实例吗？</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token comment">//ReactActivityDelegate源码</span>

    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReactActivityDelegate</span> <span class="token punctuation">{</span>
    	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token comment">//省略一些初始化</span>
      <span class="token keyword">protected</span> <span class="token class-name">ReactRootView</span> <span class="token function">createRootView</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ReactRootView</span><span class="token punctuation">(</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token comment">//正是我们要找的ReactNativeHost</span>
      <span class="token keyword">protected</span> <span class="token class-name">ReactNativeHost</span> <span class="token function">getReactNativeHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ReactApplication</span><span class="token punctuation">)</span> <span class="token function">getPlainActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getApplication</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getReactNativeHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">public</span> <span class="token class-name">ReactInstanceManager</span> <span class="token function">getReactInstanceManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">getReactNativeHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getReactInstanceManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mMainComponentName <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">loadApp</span><span class="token punctuation">(</span>mMainComponentName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        mDoubleTapReloadRecognizer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DoubleTapReloadRecognizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">loadApp</span><span class="token punctuation">(</span><span class="token class-name">String</span> appKey<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mReactRootView <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">&quot;Cannot loadApp while app is already running.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        mReactRootView <span class="token operator">=</span> <span class="token function">createRootView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mReactRootView<span class="token punctuation">.</span><span class="token function">startReactApplication</span><span class="token punctuation">(</span>
          <span class="token function">getReactNativeHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getReactInstanceManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          appKey<span class="token punctuation">,</span>
          <span class="token function">getLaunchOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">getPlainActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setContentView</span><span class="token punctuation">(</span>mReactRootView<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token comment">//省略一些生命周期函数执行</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>在查看<code>ReactActivityDelegate</code>的源码中我们发现了<code>getReactNativeHost</code>方法，那么是不是意味着我们可以在 Activity 中重写<code>ReactNativeHost</code>。</p> <p>在<code>ReactActivityDelegate</code>中我们可以看到 RN 应用加载的核心逻辑其实就两句话:<strong>创建视图并加载对应 Bundle 文件。</strong></p> <div class="language-java extra-class"><pre class="language-java"><code>     mReactRootView <span class="token operator">=</span> <span class="token function">createRootView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ReactRootView是一个自定义View，且继承自FrameLayout</span>
     mReactRootView<span class="token punctuation">.</span><span class="token function">startReactApplication</span><span class="token punctuation">(</span>
          <span class="token function">getReactNativeHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getReactInstanceManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          appKey<span class="token punctuation">,</span>
          <span class="token function">getLaunchOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>问题来了<code>ReactNativeHost</code>到时是干什么的？<code>ReactInstanceManager</code>又是干什么的？查看源码得知，核心在于<code>ReactInstanceManager</code>，这个类<strong>管理 <code>CatalystInstance</code> 的实例。他通过 ReactPackage 对外暴露一种设置 catalyst 实例的方式，并且跟踪实例的生命周期。</strong></p> <p>看了源码发现动态加载的核心在如何创建一个<code>**CatalystInstance**</code>实例，其中主要包括设置 js 模块的路径，应用上下文信息等</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">ReactNativeHost</span> <span class="token punctuation">{</span>

      <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Application</span> mApplication<span class="token punctuation">;</span>
      <span class="token keyword">private</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">ReactInstanceManager</span> mReactInstanceManager<span class="token punctuation">;</span>

    	 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token comment">//此处省略</span>

      <span class="token keyword">protected</span> <span class="token class-name">ReactInstanceManager</span> <span class="token function">createReactInstanceManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ReactMarker</span><span class="token punctuation">.</span><span class="token function">logMarker</span><span class="token punctuation">(</span><span class="token class-name">ReactMarkerConstants</span><span class="token punctuation">.</span>BUILD_REACT_INSTANCE_MANAGER_START<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ReactInstanceManagerBuilder</span> builder <span class="token operator">=</span>
            <span class="token class-name">ReactInstanceManager</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setApplication</span><span class="token punctuation">(</span>mApplication<span class="token punctuation">)</span><span class="token comment">//设置应用上下文</span>
                <span class="token punctuation">.</span><span class="token function">setJSMainModulePath</span><span class="token punctuation">(</span><span class="token function">getJSMainModuleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//设置需要加载的js bundle路径</span>
                <span class="token punctuation">.</span><span class="token function">setUseDeveloperSupport</span><span class="token punctuation">(</span><span class="token function">getUseDeveloperSupport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//是否开启dev模式</span>
                <span class="token punctuation">.</span><span class="token function">setRedBoxHandler</span><span class="token punctuation">(</span><span class="token function">getRedBoxHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//设置红盒回调，dev模式才会有红屏展示</span>
                <span class="token punctuation">.</span><span class="token function">setJavaScriptExecutorFactory</span><span class="token punctuation">(</span><span class="token function">getJavaScriptExecutorFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">// 设置 js 的执行器工厂实例，为后续加载和解析 js bundle 作准备</span>
                <span class="token punctuation">.</span><span class="token function">setUIImplementationProvider</span><span class="token punctuation">(</span><span class="token function">getUIImplementationProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 设置UI实现机制的Provider</span>
                <span class="token punctuation">.</span><span class="token function">setJSIModulesPackage</span><span class="token punctuation">(</span><span class="token function">getJSIModulePackage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//设置js模块到jsbridge中</span>
                <span class="token punctuation">.</span><span class="token function">setInitialLifecycleState</span><span class="token punctuation">(</span><span class="token class-name">LifecycleState</span><span class="token punctuation">.</span>BEFORE_CREATE<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//初始化生命周期</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ReactPackage</span> reactPackage <span class="token operator">:</span> <span class="token function">getPackages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          builder<span class="token punctuation">.</span><span class="token function">addPackage</span><span class="token punctuation">(</span>reactPackage<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">String</span> jsBundleFile <span class="token operator">=</span> <span class="token function">getJSBundleFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>jsBundleFile <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          builder<span class="token punctuation">.</span><span class="token function">setJSBundleFile</span><span class="token punctuation">(</span>jsBundleFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          builder<span class="token punctuation">.</span><span class="token function">setBundleAssetName</span><span class="token punctuation">(</span><span class="token class-name">Assertions</span><span class="token punctuation">.</span><span class="token function">assertNotNull</span><span class="token punctuation">(</span><span class="token function">getBundleAssetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">ReactInstanceManager</span> reactInstanceManager <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ReactMarker</span><span class="token punctuation">.</span><span class="token function">logMarker</span><span class="token punctuation">(</span><span class="token class-name">ReactMarkerConstants</span><span class="token punctuation">.</span>BUILD_REACT_INSTANCE_MANAGER_END<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> reactInstanceManager<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">protected</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">JSIModulePackage</span> <span class="token function">getJSIModulePackage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">getJSMainModuleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;index.android&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">protected</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> <span class="token function">getJSBundleFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>


      <span class="token keyword">protected</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> <span class="token function">getBundleAssetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;index.android.bundle&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
</code></pre></div><p>好啦，基础部分暂时就到这里啦，再往下写就得偏题啦。</p> <h2 id="二、动态加载工程实现"><a href="#二、动态加载工程实现" class="header-anchor">#</a> 二、动态加载工程实现</h2> <p>有了上面的解决办法，那我们开始整理一下这个工程实现的思路。</p> <ol><li><strong>工程搭建</strong> <ul><li>搭建 2 个 RN 工程，并打离线包作为 app 动态加载 RN 的资源文件；</li> <li>搭建一个<code>Android</code>工程，用于编写加载逻辑（为了方便，就直接使用<code>react-native</code>创建一个 rn 工程，我们只使用其中的<code>android</code>部分）</li> <li>使用 express 或者 koa 搭建一个后端服务返回模块信息和对应的离线包；</li></ul></li> <li><strong>编写 app 端主逻辑</strong> <ul><li>使用 RecyclerView 呈现出一个列表（其中包括 adapter 编写，使用 okhttp 请求服务端数据）</li> <li>点击列表中每一项向后端服务请求对应的 RN 离线包</li> <li>下载完成离线包解压缩，并跳转到 RN 对应的 Activity</li></ul></li> <li><strong>编写 RN 加载的 Activity</strong> <ul><li>复写 createReactActivityDelegate 返回自定义 ReacActivity 的委托</li> <li>自定义 ReactNativeHost 修改 js bundle 对应加载逻辑；</li></ul></li></ol> <p>其主要流程如下：</p> <p><img src="/images/react/rn-dynamic/RN.png" alt=""></p> <h2 id="_1、工程搭建"><a href="#_1、工程搭建" class="header-anchor">#</a> 1、工程搭建</h2> <p>首先让我们建立两个 rn 工程：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>    react-native init module_1 <span class="token comment">#第一个RN工程</span>
    react-native init module_2 <span class="token comment">#第二个RN工程</span>

    react-native init app <span class="token comment"># 主工程（为了省去自建Android项目的过程及rn相关依赖）</span>

    express mock_server <span class="token comment"># 创建一个后端服务</span>
</code></pre></div><p><strong>打离线包</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>    <span class="token comment"># model_1工程，打离线包并且压缩成zip (zip -q -r -o module_1.zip ./module_1 非Mac的同学可以删掉这句话)</span>
    react-native bundle --entry-file index.js --bundle-output ./module_1/module_1.bundle --platform android --assets-dest ./module_1 --dev <span class="token boolean">false</span>  <span class="token function">zip</span> -q -r -o module_1.zip ./module_1
    <span class="token comment"># model_2工程</span>
    react-native bundle --entry-file index.js --bundle-output ./module_2/module_2.bundle --platform android --assets-dest ./module_2 --dev <span class="token boolean">false</span>  <span class="token function">zip</span> -q -r -o module_2.zip ./module_2
</code></pre></div><p>如何打离线包？离线包的命令都是些啥？输入<code>react-native bundle —help</code>就知道咯</p> <div class="language-bash extra-class"><pre class="language-bash"><code>    react-native bundle <span class="token punctuation">[</span>参数<span class="token punctuation">]</span>
      构建 js 离线包

      Options:

        -h, --help                   输出如何使用的信息
        --entry-file <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span>          RN入口文件的路径, 绝对路径或相对路径
        --platform <span class="token punctuation">[</span>string<span class="token punctuation">]</span>          ios 或 andorid
        --transformer <span class="token punctuation">[</span>string<span class="token punctuation">]</span>       Specify a custom transformer to be used
        --dev <span class="token punctuation">[</span>boolean<span class="token punctuation">]</span>              如果为false, 警告会不显示并且打出的包的大小会变小
        --prepack                    当通过时, 打包输出将使用Prepack格式化
        --bridge-config <span class="token punctuation">[</span>string<span class="token punctuation">]</span>     使用Prepack的一个json格式的文件__fbBatchedBridgeConfig 例如: ./bridgeconfig.json
        --bundle-output <span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>     打包后的文件输出目录, 例: /tmp/groups.bundle,tmp目录没有需要手动创建哦
        --bundle-encoding <span class="token punctuation">[</span>string<span class="token punctuation">]</span>   打离线包的格式 可参考链接https://nodejs.org/api/buffer.html<span class="token comment">#buffer_buffer.</span>
        --sourcemap-output <span class="token punctuation">[</span>string<span class="token punctuation">]</span>  生成Source Map，但0.14之后不再自动生成source map，需要手动指定这个参数。例: /tmp/groups.map
        --assets-dest <span class="token punctuation">[</span>string<span class="token punctuation">]</span>       打包时图片资源的存储路径
        --verbose                    显示打包过程
        --reset-cache                移除缓存文件
        --config <span class="token punctuation">[</span>string<span class="token punctuation">]</span>            命令行的配置文件路径
</code></pre></div><p><strong>运行完成之后可以在对应工程下面查看 module_n 目录下有对应的 bundle 文件，</strong></p> <p>可能会出现的错误：<strong>解决办法（在 model_1/model_2 工程下新建一个 module_n 目录）</strong></p> <div class="language- extra-class"><pre class="language-text"><code>    Loading dependency graph...info Writing bundle output to:, ./bundle/module_1.bundle
    error ENOENT: no such file or directory, open './module_1/module_1.bundle'. Run CLI with --verbose flag for more details.
</code></pre></div><h2 id="_2、后端服务编写"><a href="#_2、后端服务编写" class="header-anchor">#</a> 2、后端服务编写</h2> <p>我们使用<code>express</code>创建一个 Mock 服务，主要包括模块信息的返回和对应模块 zip 文件的下载。那么我们需要将打包之后的<code>module_1/module_2</code>目录压缩成 zip 各式。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 返回对应module信息
 */</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/modules&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;module_1&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;module_2&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 根据名称返回对应module的zip文件
 */</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/download/:name&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> name <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">download</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">static/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.zip</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>
</code></pre></div><h2 id="_3、android-工程改造"><a href="#_3、android-工程改造" class="header-anchor">#</a> 3、Android 工程改造</h2> <p>前面提到我们直接使用 rn 创建的一个 Android 工程，那么现在我们就对这个 Android 工程进行改造吧。</p> <p><strong>Step1</strong>：改造<code>MainApplication.java</code>其他部分的代码干掉，值保留<code>SoLoader</code>加载器，前面提到 SoLoader 的作用是加载 so 文件，作为 js 和 Java 通信的桥梁。</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainApplication</span> <span class="token keyword">extends</span> <span class="token class-name">Application</span> <span class="token keyword">implements</span> <span class="token class-name">ReactApplication</span> <span class="token punctuation">{</span>


      <span class="token annotation punctuation">@Override</span>
      <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SoLoader</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token comment">/* native exopackage */</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
</code></pre></div><p><strong>Step2</strong>: 新增<code>okhttp</code>等依赖。由于需要向后端服务请求对应 zip 包，所以需要 http 请求。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>    //在android的app目录下的build.gradle文件新增如下依赖
    implementation <span class="token string">'com.liulishuo.filedownloader:library:1.7.4'</span> // 文件下载
    implementation <span class="token string">&quot;com.squareup.okhttp3:okhttp:3.12.0&quot;</span> // 网络请求
    implementation <span class="token string">'com.google.code.gson:gson:2.8.5'</span> // json转换
    implementation <span class="token string">'com.android.support:recyclerview-v7:28.0.0'</span> //列表展示
</code></pre></div><p><strong>Step3</strong>: 编写主逻辑</p> <ul><li>我们设想在 App 首页请求后端服务，查看到当前所有 RN 的 module</li> <li>点击列表中的每一个，跳转到对应的 RN 页面。</li></ul> <p><strong>Step4</strong>: 使用 okhttp 获取模块列表，点击下载对应 Bundle 文件</p> <p>由于需要调用服务，需要在 AndroidManifest.xml 文件中声明网络获取权限，详情代码请见文末【源码】</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainActivity</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span> <span class="token punctuation">{</span>
        <span class="token class-name">RecyclerView</span> recyclerView<span class="token punctuation">;</span>
        <span class="token class-name">ListModuleAdapter</span> adapter<span class="token punctuation">;</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>main<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">initView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">featchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/**
         * 初始化布局视图，默认数据为空
         */</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initView</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            recyclerView <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
            recyclerView<span class="token punctuation">.</span><span class="token function">setLayoutManager</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LinearLayoutManager</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            adapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListModuleAdapter</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ModuleItem<span class="token punctuation">.</span>Bundle</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            recyclerView<span class="token punctuation">.</span><span class="token function">setAdapter</span><span class="token punctuation">(</span>adapter<span class="token punctuation">)</span><span class="token punctuation">;</span>
            adapter<span class="token punctuation">.</span><span class="token function">setOnItemClickListener</span><span class="token punctuation">(</span>bundle <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token comment">// 检查是否下载过，如果已经下载过则直接打开，暂不考虑各种版本问题</span>
                <span class="token class-name">String</span> f <span class="token operator">=</span> <span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getFilesDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">+</span> bundle<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">+</span> bundle<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">&quot;.bundle&quot;</span><span class="token punctuation">;</span>
                <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">goToRNActivity</span><span class="token punctuation">(</span>bundle<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token function">download</span><span class="token punctuation">(</span>bundle<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/**
         * 跳转到RN的展示页面
         * @param bundleName
         */</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">goToRNActivity</span><span class="token punctuation">(</span><span class="token class-name">String</span> bundleName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Intent</span> starter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token class-name">RNDynamicActivity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">RNDynamicActivity</span><span class="token punctuation">.</span>bundleName <span class="token operator">=</span> bundleName<span class="token punctuation">;</span>
            <span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">startActivity</span><span class="token punctuation">(</span>starter<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/**
         * 调用服务获取数据
         */</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">featchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">OkHttpClient</span> okHttpClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OkHttpClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Request</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span>API<span class="token punctuation">.</span>MODULES<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">(</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Call</span> call <span class="token operator">=</span> okHttpClient<span class="token punctuation">.</span><span class="token function">newCall</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
            call<span class="token punctuation">.</span><span class="token function">enqueue</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onFailure</span><span class="token punctuation">(</span><span class="token class-name">Call</span> call<span class="token punctuation">,</span> <span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;数据获取失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onResponse</span><span class="token punctuation">(</span><span class="token class-name">Call</span> call<span class="token punctuation">,</span> <span class="token class-name">Response</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
                    <span class="token class-name">String</span> data <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token class-name">ModuleItem</span> moduleItem <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Gson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token class-name">ModuleItem</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">runOnUiThread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                        <span class="token annotation punctuation">@Override</span>
                        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    												<span class="token comment">//刷新列表</span>
                            adapter<span class="token punctuation">.</span><span class="token function">clearModules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            adapter<span class="token punctuation">.</span><span class="token function">addModules</span><span class="token punctuation">(</span>moduleItem<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/**
         * 下载对应的bundle
         *
         * @param bundleName
         */</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">download</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">String</span> bundleName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>API<span class="token punctuation">.</span>DOWNLOAD <span class="token operator">+</span> bundleName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">FileDownloader</span><span class="token punctuation">.</span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">FileDownloader</span><span class="token punctuation">.</span><span class="token function">getImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>API<span class="token punctuation">.</span>DOWNLOAD <span class="token operator">+</span> bundleName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getFilesDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>

                    <span class="token punctuation">.</span><span class="token function">setListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileDownloadListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token annotation punctuation">@Override</span>
                        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">started</span><span class="token punctuation">(</span><span class="token class-name">BaseDownloadTask</span> task<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">started</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>

                        <span class="token annotation punctuation">@Override</span>
                        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">pending</span><span class="token punctuation">(</span><span class="token class-name">BaseDownloadTask</span> task<span class="token punctuation">,</span> <span class="token keyword">int</span> soFarBytes<span class="token punctuation">,</span> <span class="token keyword">int</span> totalBytes<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                        <span class="token punctuation">}</span>

                        <span class="token annotation punctuation">@Override</span>
                        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">progress</span><span class="token punctuation">(</span><span class="token class-name">BaseDownloadTask</span> task<span class="token punctuation">,</span> <span class="token keyword">int</span> soFarBytes<span class="token punctuation">,</span> <span class="token keyword">int</span> totalBytes<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                        <span class="token punctuation">}</span>

                        <span class="token annotation punctuation">@Override</span>
                        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">completed</span><span class="token punctuation">(</span><span class="token class-name">BaseDownloadTask</span> task<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                                <span class="token comment">//下载之后解压，然后打开</span>
                                <span class="token class-name">ZipUtils</span><span class="token punctuation">.</span><span class="token function">unzip</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getFilesDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">+</span> bundleName <span class="token operator">+</span> <span class="token string">&quot;.zip&quot;</span><span class="token punctuation">,</span> <span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getFilesDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                               <span class="token function">goToRNActivity</span><span class="token punctuation">(</span>bundleName<span class="token punctuation">)</span><span class="token punctuation">;</span>

                            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>

                        <span class="token punctuation">}</span>

                        <span class="token annotation punctuation">@Override</span>
                        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">paused</span><span class="token punctuation">(</span><span class="token class-name">BaseDownloadTask</span> task<span class="token punctuation">,</span> <span class="token keyword">int</span> soFarBytes<span class="token punctuation">,</span> <span class="token keyword">int</span> totalBytes<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                        <span class="token punctuation">}</span>

                        <span class="token annotation punctuation">@Override</span>
                        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token class-name">BaseDownloadTask</span> task<span class="token punctuation">,</span> <span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token punctuation">}</span>

                        <span class="token annotation punctuation">@Override</span>
                        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">warn</span><span class="token punctuation">(</span><span class="token class-name">BaseDownloadTask</span> task<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>**Step5：**自定义 RN 加载页面（记得在<code>AndroidManifest</code>.xml 文件中声明）并创建<code>ReacActivity</code>委托对象<code>DispatchDelegate</code></p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token comment">//RNDynamicActivity</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RNDynamicActivity</span> <span class="token keyword">extends</span> <span class="token class-name">ReactActivity</span> <span class="token punctuation">{</span>
    		<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> bundleName<span class="token punctuation">;</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">protected</span> <span class="token class-name">ReactActivityDelegate</span> <span class="token function">createReactActivityDelegate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token class-name">DispatchDelegate</span> delegate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DispatchDelegate</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> bundleName<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">return</span> delegate<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//DispatchDelegate</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DispatchDelegate</span> <span class="token keyword">extends</span> <span class="token class-name">ReactActivityDelegate</span> <span class="token punctuation">{</span>

        <span class="token keyword">private</span> <span class="token class-name">Activity</span> activity<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> bundleName<span class="token punctuation">;</span>


        <span class="token keyword">public</span> <span class="token class-name">DispatchDelegate</span><span class="token punctuation">(</span><span class="token class-name">Activity</span> activity<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> bundleName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span>activity<span class="token punctuation">,</span> bundleName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>activity <span class="token operator">=</span> activity<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>bundleName <span class="token operator">=</span> bundleName<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">protected</span> <span class="token class-name">ReactNativeHost</span> <span class="token function">getReactNativeHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token class-name">ReactNativeHost</span> mReactNativeHost <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReactNativeHost</span><span class="token punctuation">(</span>activity<span class="token punctuation">.</span><span class="token function">getApplication</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">getUseDeveloperSupport</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token class-name">BuildConfig</span><span class="token punctuation">.</span>DEBUG<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
    						<span class="token comment">//注册原生模块，这样</span>
                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">protected</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ReactPackage</span><span class="token punctuation">&gt;</span></span> <span class="token function">getPackages</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ReactPackage</span><span class="token punctuation">&gt;</span></span><span class="token function">asList</span><span class="token punctuation">(</span>
                            <span class="token keyword">new</span> <span class="token class-name">MainReactPackage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token annotation punctuation">@Nullable</span>
                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">getJSBundleFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    								<span class="token comment">// 读取已经解压的bundle文件</span>
                    <span class="token class-name">String</span> file <span class="token operator">=</span> activity<span class="token punctuation">.</span><span class="token function">getFilesDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">+</span> bundleName <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">+</span> bundleName <span class="token operator">+</span> <span class="token string">&quot;.bundle&quot;</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> file<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token annotation punctuation">@Nullable</span>
                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">getBundleAssetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> bundleName <span class="token operator">+</span> <span class="token string">&quot;.bundle&quot;</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">getJSMainModuleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token string">&quot;index&quot;</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> mReactNativeHost<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>其余详细代码请见：</p> <p><a href="https://github.com/MrGaoGang/luckly_learn/tree/master/packages/rn-dynamic" target="_blank" rel="noopener noreferrer">MrGaoGang/luckly_learn<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>最后效果图如下：</p> <p><img src="/images/react/rn-dynamic/preview.gif" alt=""></p> <p>其实真实的加载远不止如此简单，还有很多方面需要我我们考虑。比如：</p> <ul><li>离线包版本管理</li> <li>离线包加载时机，比如用户在什么时间下载离线包，加载离线包，已经打开了当前离线包，下次打开是否更新？等</li> <li>离线包缓存机制</li> <li>权限管理</li> <li>降级策略</li> <li>等待</li></ul> <h2 id="三、可能会遇到的问题及疑问"><a href="#三、可能会遇到的问题及疑问" class="header-anchor">#</a> 三、可能会遇到的问题及疑问</h2> <p><strong>1、为什么页面跳转到 RNDynamicActivity 没有使用 Intent 传递数据</strong></p> <p>这就要看 Activity 中<code>createReactActivityDelegate</code>和<code>onCreate</code>执行顺序了，查看 ReactActivity 源码得知<code>createReactActivityDelegate</code>是在 RectActivity 初始化的时候执行，所以<strong>优先于<code>onCreate</code>执行</strong>。</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">ReactActivity</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span>
        <span class="token keyword">implements</span> <span class="token class-name">DefaultHardwareBackBtnHandler</span><span class="token punctuation">,</span> <span class="token class-name">PermissionAwareActivity</span> <span class="token punctuation">{</span>

      <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ReactActivityDelegate</span> mDelegate<span class="token punctuation">;</span>

      <span class="token keyword">protected</span> <span class="token class-name">ReactActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mDelegate <span class="token operator">=</span> <span class="token function">createReactActivityDelegate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>


      <span class="token keyword">protected</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> <span class="token function">getMainComponentName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token comment">/** Called at construction time, override if you have a custom delegate implementation. */</span>
      <span class="token keyword">protected</span> <span class="token class-name">ReactActivityDelegate</span> <span class="token function">createReactActivityDelegate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ReactActivityDelegate</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token function">getMainComponentName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token annotation punctuation">@Override</span>
      <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mDelegate<span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
</code></pre></div><p><strong>2、出现模块没有注册的报错</strong></p> <p><img src="/images/react/rn-dynamic/error.png" alt=""></p> <p>请检查工程的名称是否和打包的名称相同</p> <p>3、报错：错误: 需要 class, interface 或 enum</p> <h2 id="四、源码"><a href="#四、源码" class="header-anchor">#</a> 四、源码</h2> <p><a href="https://github.com/MrGaoGang/luckly_learn/tree/master/packages/rn-dynamic" target="_blank" rel="noopener noreferrer">MrGaoGang/luckly_learn<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/images/react/rn-dynamic/rn-1.png" alt=""></p> <p><img src="/images/react/rn-dynamic/rn-2.png" alt=""></p> <p><img src="/images/react/rn-dynamic/rn-3.png" alt=""></p></div> <div class="post-copyright-container"><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>
      mrgaogang.github.io
    </li> <li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://mrgaogang.github.io/react/%E5%B7%B2%E6%9C%89Android%E9%A1%B9%E7%9B%AE%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BDRN.html" title="声明博客的许可协议">https://mrgaogang.github.io/react/%E5%B7%B2%E6%9C%89Android%E9%A1%B9%E7%9B%AE%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BDRN.html</a></li> <li class="post-copyright-license"><strong>版权声明： </strong>
      本博客所有文章除特别声明外，均采用
      <a href="https://creativecommons.org/licenses/by-sa/4.0/" rel="external nofollow" target="_blank">CC BY-SA 4.0</a>
      许可协议。转载请注明出处！
    </li></ul></div> <div data-v-b4bf293e><div class="encourage" data-v-b4bf293e><button data-v-b4bf293e><span class="button-content" data-v-b4bf293e><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-b4bf293e><path d="M0 0H24V24H0z" fill="none" data-v-b4bf293e></path> <path d="M12.001 4.529c2.349-2.109 5.979-2.039 8.242.228 2.262 2.268 2.34 5.88.236 8.236l-8.48 8.492-8.478-8.492c-2.104-2.356-2.025-5.974.236-8.236 2.265-2.264 5.888-2.34 8.244-.228z" fill="currentColor" data-v-b4bf293e></path></svg>
        鼓励一下
      </span></button></div> <!----></div> <div class="divider-comment"></div> <div class="comments-wrapper"><!----></div> <footer class="page-edit"><!----> <div class="edit-link"><a target="_blank" href="https://github.com/MrGaoGang/lucky_docs/edit/master/docs/react/已有Android项目如何实现动态加载RN.md">Edit This Page</a></div> <div class="last-updated"><span class="prefix">【未经作者允许禁止转载】 Last Updated: </span> <span class="time">1/22/2025, 9:16:24 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/react/如何使用React创建一个弹窗组件.html" class="prev">
          如何使用React创建一个弹窗组件
        </a></span> <span class="next"><a href="/threejs/">
          学习材料
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.4d95cff4.js" defer></script><script src="/assets/js/6.998d065f.js" defer></script><script src="/assets/js/4.ef7f550c.js" defer></script><script src="/assets/js/235.89d1c10d.js" defer></script>
  </body>
</html>
